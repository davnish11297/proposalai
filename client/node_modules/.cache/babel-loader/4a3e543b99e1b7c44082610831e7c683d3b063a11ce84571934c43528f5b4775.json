{"ast":null,"code":"import React,{useState,useEffect}from'react';import{toast}from'react-hot-toast';import{getOpenRouterChatCompletion}from'../services/api';import ReactMarkdown from'react-markdown';import remarkGfm from'remark-gfm';import'../ProposalMarkdown.css';import{proposalsAPI}from'../services/api';import SuggestionButton from'../components/SuggestionButton';// Utility to convert HTML tags to markdown\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function htmlToMarkdown(input){return input.replace(/<strong>(.*?)<\\/strong>/gi,'**$1**').replace(/<b>(.*?)<\\/b>/gi,'**$1**').replace(/<em>(.*?)<\\/em>/gi,'*$1*').replace(/<i>(.*?)<\\/i>/gi,'*$1*').replace(/<br\\s*\\/?>(\\s*)/gi,'\\n').replace(/<[^>]+>/g,'')// Remove any other HTML tags\n.replace(/\\n{3,}/g,'\\n\\n');// Collapse excessive newlines\n}const Dashboard=()=>{const[proposalText,setProposalText]=useState('');const[generating,setGenerating]=useState(false);const[showContent,setShowContent]=useState(false);const[generatedContent,setGeneratedContent]=useState({executiveSummary:'',approach:'',budgetDetails:'',timeline:'',fullContent:''// Added for react-markdown\n});const[savingDraft,setSavingDraft]=useState(false);const[sendingEmail,setSendingEmail]=useState(false);const[downloadingPdf,setDownloadingPdf]=useState(false);const[showEmailModal,setShowEmailModal]=useState(false);const[email,setEmail]=useState('');const[proposalId,setProposalId]=useState(null);const[selectedSuggestions,setSelectedSuggestions]=useState([]);const[loadingSuggestions,setLoadingSuggestions]=useState(false);const[loadingRefinementSuggestions,setLoadingRefinementSuggestions]=useState(false);const[uploadingPdf,setUploadingPdf]=useState(false);const[uploadedPdfContent,setUploadedPdfContent]=useState('');// Predefined suggestions with icons and colors\nconst predefinedSuggestions=[{text:\"Add Executive Summary\",icon:/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"})}),color:'blue'},{text:\"Include Budget Details\",icon:/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1\"})}),color:'green'},{text:\"Add Timeline Section\",icon:/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\"})}),color:'purple'},{text:\"Include Case Studies\",icon:/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10\"})}),color:'orange'},{text:\"Add Team Profiles\",icon:/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z\"})}),color:'blue'},{text:\"Include Testimonials\",icon:/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\"})}),color:'purple'},{text:\"Add Risk Assessment\",icon:/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\"})}),color:'red'},{text:\"Include Next Steps\",icon:/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M13 7l5 5m0 0l-5 5m5-5H6\"})}),color:'green'}];// Refinement suggestions with icons and colors\nconst refinementSuggestions=[{text:\"Enhance Executive Summary\",icon:/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\"})}),color:'blue'},{text:\"Add More Details\",icon:/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M12 6v6m0 0v6m0-6h6m-6 0H6\"})}),color:'green'},{text:\"Improve Clarity\",icon:/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z\"})}),color:'purple'},{text:\"Add Examples\",icon:/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10\"})}),color:'orange'},{text:\"Strengthen Value Props\",icon:/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M13 10V3L4 14h7v7l9-11h-7z\"})}),color:'yellow'},{text:\"Add Call to Action\",icon:/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M13 7l5 5m0 0l-5 5m5-5H6\"})}),color:'green'}];// Handle PDF file upload and extraction\nconst handlePdfUpload=async event=>{var _event$target$files;const file=(_event$target$files=event.target.files)===null||_event$target$files===void 0?void 0:_event$target$files[0];if(!file)return;if(file.type!=='application/pdf'){toast.error('Please upload a PDF file');return;}setUploadingPdf(true);try{const formData=new FormData();formData.append('pdf',file);// Call backend API to extract text from PDF\nconst response=await fetch('/api/proposals/extract-pdf',{method:'POST',body:formData,headers:{'Authorization':`Bearer ${localStorage.getItem('token')}`}});if(!response.ok){throw new Error('Failed to extract PDF content');}const data=await response.json();const extractedText=data.content||data.text||'';if(extractedText.trim()){setUploadedPdfContent(extractedText);toast.success('PDF uploaded successfully! You can now generate a refined proposal.');}else{toast.error('No readable text found in the PDF');}}catch(error){console.error('PDF extraction error:',error);toast.error('Failed to extract PDF content. Please try again.');}finally{setUploadingPdf(false);// Reset the file input\nevent.target.value='';}};// Handle suggestion bubble click (select/unselect up to 5)\nconst handleSuggestionClick=suggestion=>{setSelectedSuggestions(prev=>prev.includes(suggestion)?prev.filter(s=>s!==suggestion):prev.length<5?[...prev,suggestion]:prev);};// Handle regeneration of suggestions\nconst handleRegenerateSuggestions=async()=>{setLoadingSuggestions(true);setSelectedSuggestions([]);try{// For now, we'll just shuffle the existing predefined suggestions\n// In a real implementation, you would call AI to generate new suggestions\nconsole.log('Regenerating suggestions...');}catch(error){console.error('Error regenerating suggestions:',error);}finally{setLoadingSuggestions(false);}};// Handle regeneration of refinement suggestions\nconst handleRegenerateRefinementSuggestions=async()=>{if(!proposalText.trim()&&!uploadedPdfContent.trim())return;setLoadingRefinementSuggestions(true);setSelectedSuggestions([]);try{// For now, we'll just shuffle the existing refinement suggestions\n// In a real implementation, you would call AI to generate new suggestions\nconsole.log('Regenerating refinement suggestions...');}catch(error){console.error('Error regenerating refinement suggestions:',error);}finally{setLoadingRefinementSuggestions(false);}};const handleGenerateWithAI=async()=>{// Check if we have either user input or uploaded PDF content\nif(!proposalText.trim()&&!uploadedPdfContent.trim()){toast.error('Please enter a proposal description or upload a PDF before generating content');return;}try{var _response$choices$,_response$choices$$me,_execMatch$,_approachMatch$,_budgetMatch$,_timelineMatch$;setGenerating(true);// Combine user input and uploaded PDF content\nconst combinedContent=uploadedPdfContent.trim()?`${proposalText.trim()?proposalText.trim()+'\\n\\n':''}PDF Content:\\n${uploadedPdfContent.trim()}`:proposalText.trim();// If there are selected suggestions, use them to refine the proposal\nlet systemPrompt=`You are an expert proposal writer. Generate a professional proposal with these sections: Executive Summary, Approach, Budget Details, Timeline. Use clear, persuasive language.`;let userPrompt=`Content: ${combinedContent}\\n\\nGenerate a professional proposal with: 1. Executive Summary 2. Approach 3. Budget Details 4. Timeline`;// If there are selected suggestions, modify the prompt to include them\nif(selectedSuggestions.length>0){systemPrompt=`You are an expert proposal writer. Generate a professional proposal incorporating these refinements: ${selectedSuggestions.map(s=>`\"${s}\"`).join(', ')}. Include: Executive Summary, Approach, Budget Details, Timeline.`;userPrompt=`Content: ${combinedContent}\\n\\nRefinements: ${selectedSuggestions.join(', ')}\\n\\nGenerate proposal with: 1. Executive Summary 2. Approach 3. Budget Details 4. Timeline`;}// Compose prompt for OpenRouter\nconst messages=[{role:'system',content:systemPrompt},{role:'user',content:userPrompt}];const response=await getOpenRouterChatCompletion(messages);const aiContent=((_response$choices$=response.choices[0])===null||_response$choices$===void 0?void 0:(_response$choices$$me=_response$choices$.message)===null||_response$choices$$me===void 0?void 0:_response$choices$$me.content)||'';let executiveSummary='',approach='',budgetDetails='',timeline='';const execMatch=aiContent.match(/(?:Executive Summary|EXECUTIVE SUMMARY)[:\\s\\n]*([\\s\\S]*?)(?=\\n\\s*(?:Approach|APPROACH|Budget|BUDGET|Timeline|TIMELINE|Next Steps|NEXT STEPS)[:\\s\\n]|$)/i);const approachMatch=aiContent.match(/(?:Approach|APPROACH|Methodology|METHODOLOGY)[:\\s\\n]*([\\s\\S]*?)(?=\\n\\s*(?:Budget|BUDGET|Timeline|TIMELINE|Next Steps|NEXT STEPS)[:\\s\\n]|$)/i);const budgetMatch=aiContent.match(/(?:Budget Details?|BUDGET DETAILS?|Pricing|PRICING)[:\\s\\n]*([\\s\\S]*?)(?=\\n\\s*(?:Timeline|TIMELINE|Next Steps|NEXT STEPS)[:\\s\\n]|$)/i);const timelineMatch=aiContent.match(/(?:Timeline|TIMELINE|Schedule|SCHEDULE)[:\\s\\n]*([\\s\\S]*?)(?=\\n\\s*(?:Next Steps|NEXT STEPS|Conclusion|CONCLUSION)[:\\s\\n]|$)/i);executiveSummary=(execMatch===null||execMatch===void 0?void 0:(_execMatch$=execMatch[1])===null||_execMatch$===void 0?void 0:_execMatch$.trim())||'';approach=(approachMatch===null||approachMatch===void 0?void 0:(_approachMatch$=approachMatch[1])===null||_approachMatch$===void 0?void 0:_approachMatch$.trim())||'';budgetDetails=(budgetMatch===null||budgetMatch===void 0?void 0:(_budgetMatch$=budgetMatch[1])===null||_budgetMatch$===void 0?void 0:_budgetMatch$.trim())||'';timeline=(timelineMatch===null||timelineMatch===void 0?void 0:(_timelineMatch$=timelineMatch[1])===null||_timelineMatch$===void 0?void 0:_timelineMatch$.trim())||'';const cleanContent=text=>{return text.replace(/\\n{3,}/g,'\\n\\n').replace(/^\\s+|\\s+$/g,'').replace(/\\*\\*(.*?)\\*\\*/g,'<strong>$1</strong>').replace(/\\*(.*?)\\*/g,'<em>$1</em>');};setGeneratedContent({executiveSummary:htmlToMarkdown(cleanContent(executiveSummary)),approach:htmlToMarkdown(cleanContent(approach)),budgetDetails:htmlToMarkdown(cleanContent(budgetDetails)),timeline:htmlToMarkdown(cleanContent(timeline)),fullContent:[htmlToMarkdown(cleanContent(executiveSummary)),htmlToMarkdown(cleanContent(approach)),htmlToMarkdown(cleanContent(budgetDetails)),htmlToMarkdown(cleanContent(timeline))].filter(Boolean).join('\\n\\n')});setTimeout(()=>{setShowContent(true);},500);toast.success('Proposal generated successfully!');// Generate refinement suggestions for the new proposal\n// generateRefinementSuggestions(aiContent); // This line was removed\n}catch(error){console.error('Error generating proposal:',error);// Handle specific OpenRouter credit limit error\nif(error instanceof Error&&error.message.includes('OpenRouter credits exhausted')){toast.error('AI service credits exhausted. Please visit OpenRouter to add more credits or try again later.');}else{toast.error('Failed to generate proposal content. Please try again.');}}finally{setGenerating(false);}};// Save as Draft handler\nconst handleSaveDraft=async()=>{setSavingDraft(true);try{const payload={title:proposalText.slice(0,60)||'Untitled Proposal',description:proposalText,clientName:'Client',// Optionally make this dynamic\ntype:'PROPOSAL',status:'DRAFT',content:generatedContent.fullContent};let response;if(proposalId){response=await proposalsAPI.update(proposalId,payload);}else{response=await proposalsAPI.create(payload);setProposalId(response.data.data.id);}toast.success('Proposal saved as draft!');}catch(error){toast.error('Failed to save draft.');}finally{setSavingDraft(false);}};// Send as Email handler\nconst handleSendEmail=async()=>{if(!email){toast.error('Please enter a valid email address.');return;}if(!proposalId){toast.error('Please save the proposal as draft first.');return;}setSendingEmail(true);try{await proposalsAPI.sendEmail(proposalId,{recipientEmail:email});toast.success('Proposal sent via email!');setShowEmailModal(false);setEmail('');}catch(error){toast.error('Failed to send email.');}finally{setSendingEmail(false);}};// Download as PDF handler\nconst handleDownloadPdf=async()=>{if(!proposalId){toast.error('Please save the proposal as draft first.');return;}setDownloadingPdf(true);try{var _link$parentNode;const response=await proposalsAPI.downloadPDF(proposalId);const url=window.URL.createObjectURL(new Blob([response.data],{type:'application/pdf'}));const link=document.createElement('a');link.href=url;link.setAttribute('download','proposal.pdf');document.body.appendChild(link);link.click();(_link$parentNode=link.parentNode)===null||_link$parentNode===void 0?void 0:_link$parentNode.removeChild(link);window.URL.revokeObjectURL(url);toast.success('PDF downloaded!');}catch(error){toast.error('Failed to download PDF.');}finally{setDownloadingPdf(false);}};const handleLogout=()=>{localStorage.removeItem('token');localStorage.removeItem('user');window.location.href='/login';};// After proposal is generated, generate suggestions\nuseEffect(()=>{// We're now using predefined suggestions, so no need for AI generation here\n// The suggestions are already defined in the component\n},[showContent]);// REMOVED: Auto-generation useEffect that was causing unwanted generation when typing\n// Now generation only happens when user explicitly clicks Generate/Refine button\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gray-50 flex flex-col\",children:[/*#__PURE__*/_jsx(\"nav\",{className:\"bg-gradient-to-r from-blue-600 to-blue-400 shadow-lg w-full z-10\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center h-16\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center\",children:/*#__PURE__*/_jsx(\"h1\",{className:\"text-xl font-extrabold text-white tracking-wider drop-shadow\",children:\"ProposalAI\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-8\",children:[/*#__PURE__*/_jsx(\"a\",{href:\"/dashboard\",className:\"text-white font-semibold border-b-2 border-white/80 pb-1 transition-colors\",children:\"Dashboard\"}),/*#__PURE__*/_jsx(\"a\",{href:\"/drafts\",className:\"text-white/80 hover:text-white transition-colors\",children:\"Drafts\"}),/*#__PURE__*/_jsx(\"a\",{href:\"/sent-proposals\",className:\"text-white/80 hover:text-white transition-colors\",children:\"Sent Proposals\"}),/*#__PURE__*/_jsx(\"a\",{href:\"/profile\",className:\"text-white/80 hover:text-white transition-colors\",children:\"Profile\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,className:\"text-white/80 hover:text-white transition-colors\",children:\"Logout\"})]})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto py-8 px-4 sm:px-8\",children:[!showContent?/*#__PURE__*/// Single centered card when no content is generated\n_jsx(\"div\",{className:\"flex flex-col items-center justify-center min-h-[80vh]\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-full max-w-4xl bg-white/90 rounded-2xl shadow-xl border border-gray-100 p-10 flex flex-col items-center justify-center min-h-[480px] mx-auto\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-extrabold text-gray-900 mb-4 text-center\",children:\"AI Proposal Generator\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-full relative mb-4\",children:[uploadedPdfContent&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 text-sm text-green-600 bg-green-50 px-3 py-2 rounded-lg mb-2\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"})}),\"PDF uploaded successfully\"]}),/*#__PURE__*/_jsx(\"textarea\",{className:\"w-full h-[180px] rounded-lg border border-gray-200 px-4 py-3 text-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition bg-gray-50 resize-none\",placeholder:uploadedPdfContent?\"Add additional context or requirements (optional)...\":\"Describe your client or project... or upload a PDF to generate a refined proposal\",value:proposalText,onChange:e=>setProposalText(e.target.value),disabled:generating}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-3 right-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\".pdf\",onChange:handlePdfUpload,className:\"hidden\",id:\"pdf-upload\",disabled:uploadingPdf}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"pdf-upload\",className:`inline-flex items-center justify-center w-8 h-8 rounded-full transition cursor-pointer ${uploadingPdf?'bg-gray-100 opacity-50 cursor-not-allowed':uploadedPdfContent?'bg-green-100 hover:bg-green-200':'bg-gray-100 hover:bg-gray-200'}`,title:uploadedPdfContent?\"PDF uploaded - Click to replace\":\"Upload PDF\",children:uploadingPdf?/*#__PURE__*/_jsx(\"div\",{className:\"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin\"}):uploadedPdfContent?/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4 text-green-600\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"})}):/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4 text-gray-600\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12\"})})})]})]}),!showContent&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-3\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900\",children:\"Suggestions to get started:\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleRegenerateSuggestions,disabled:loadingSuggestions,className:\"text-sm text-blue-600 hover:text-blue-700 font-medium disabled:opacity-50 disabled:cursor-not-allowed\",children:loadingSuggestions?'Regenerating...':'Regenerate Suggestions'})]}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3\",children:predefinedSuggestions.map((suggestion,i)=>{const isSelected=selectedSuggestions.includes(suggestion.text);const isDisabled=!isSelected&&selectedSuggestions.length>=5;return/*#__PURE__*/_jsx(SuggestionButton,{icon:suggestion.icon,text:suggestion.text,color:suggestion.color,isSelected:isSelected,isDisabled:isDisabled,onClick:()=>handleSuggestionClick(suggestion.text)},i);})})]}),showContent&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-3\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900\",children:\"Refine your proposal:\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleRegenerateRefinementSuggestions// This button should regenerate refinement suggestions\n,disabled:loadingRefinementSuggestions,className:\"text-sm text-blue-600 hover:text-blue-700 font-medium disabled:opacity-50 disabled:cursor-not-allowed\",children:loadingRefinementSuggestions?'Regenerating...':'Regenerate Suggestions'})]}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3\",children:refinementSuggestions.map((suggestion,i)=>{const isSelected=selectedSuggestions.includes(suggestion.text);const isDisabled=!isSelected&&selectedSuggestions.length>=5;return/*#__PURE__*/_jsx(SuggestionButton,{icon:suggestion.icon,text:suggestion.text,color:suggestion.color,isSelected:isSelected,isDisabled:isDisabled,onClick:()=>handleSuggestionClick(suggestion.text)},i);})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full flex justify-center mb-4\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:handleRegenerateRefinementSuggestions,disabled:loadingRefinementSuggestions,className:\"inline-flex items-center gap-2 px-4 py-2 text-sm text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed\",title:\"Generate new refinement suggestions\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"})}),loadingRefinementSuggestions?'Generating...':'Regenerate Suggestions']})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-4 mt-2 w-full justify-center\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"px-6 py-2 rounded-lg bg-blue-600 text-white font-bold shadow-md hover:bg-blue-700 transition disabled:opacity-60\",onClick:handleGenerateWithAI,disabled:generating||!proposalText.trim(),children:generating?'Generating...':'Generate'}),/*#__PURE__*/_jsx(\"button\",{className:\"px-6 py-2 rounded-lg bg-gray-200 text-gray-700 font-bold shadow-md hover:bg-gray-300 transition\",onClick:()=>{setProposalText('');setSelectedSuggestions([]);setUploadedPdfContent('');// Clear PDF content\n},disabled:generating,children:\"Clear\"})]})]})}):/*#__PURE__*/// Side-by-side layout when content is generated\n_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-2 gap-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white/90 rounded-2xl shadow-xl border border-gray-100 p-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-extrabold text-gray-900 mb-4\",children:\"Refine Proposal\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-full relative mb-4\",children:[uploadedPdfContent&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 text-sm text-green-600 bg-green-50 px-3 py-2 rounded-lg mb-2\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"})}),\"PDF uploaded successfully\"]}),/*#__PURE__*/_jsx(\"textarea\",{className:\"w-full h-[180px] rounded-lg border border-gray-200 px-4 py-3 text-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition bg-gray-50 resize-none\",placeholder:uploadedPdfContent?\"Add additional context or requirements (optional)...\":\"Describe your client or project...\",value:proposalText,onChange:e=>setProposalText(e.target.value),disabled:generating}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-3 right-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\".pdf\",onChange:handlePdfUpload,className:\"hidden\",id:\"pdf-upload-refine\",disabled:uploadingPdf}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"pdf-upload-refine\",className:`inline-flex items-center justify-center w-8 h-8 rounded-full transition cursor-pointer ${uploadingPdf?'bg-gray-100 opacity-50 cursor-not-allowed':uploadedPdfContent?'bg-green-100 hover:bg-green-200':'bg-gray-100 hover:bg-gray-200'}`,title:uploadedPdfContent?\"PDF uploaded - Click to replace\":\"Upload PDF\",children:uploadingPdf?/*#__PURE__*/_jsx(\"div\",{className:\"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin\"}):uploadedPdfContent?/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4 text-green-600\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"})}):/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4 text-gray-600\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12\"})})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full flex flex-wrap gap-2 mb-4 min-h-[40px]\",children:loadingRefinementSuggestions?// Show placeholder suggestion bubbles during loading to maintain layout\nArray.from({length:6}).map((_,i)=>/*#__PURE__*/_jsx(\"div\",{className:\"px-3 py-1.5 rounded-full border border-gray-200 bg-gray-100 animate-pulse\",style:{width:'140px',height:'32px'},children:/*#__PURE__*/_jsx(\"div\",{className:\"h-3 bg-gray-200 rounded animate-pulse\"})},i)):refinementSuggestions.map((s,i)=>{const isSelected=selectedSuggestions.includes(s.text);const isDisabled=!isSelected&&selectedSuggestions.length>=5;return/*#__PURE__*/_jsx(SuggestionButton,{icon:s.icon,text:s.text,color:s.color,isSelected:isSelected,isDisabled:isDisabled,onClick:()=>handleSuggestionClick(s.text)},i);})}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full flex justify-center mb-4\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:handleRegenerateRefinementSuggestions,disabled:loadingRefinementSuggestions,className:\"inline-flex items-center gap-2 px-3 py-1.5 text-xs text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed\",title:\"Generate new refinement suggestions\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-3 h-3\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"})}),loadingRefinementSuggestions?'Generating...':'Regenerate Suggestions']})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"px-4 py-2 rounded-lg bg-blue-600 text-white font-bold shadow-md hover:bg-blue-700 transition disabled:opacity-60 flex-1\",onClick:async()=>{setGenerating(true);// Regenerate proposal with selected suggestions\nawait handleGenerateWithAI();},disabled:generating,children:generating?'Generating...':'Refine'}),/*#__PURE__*/_jsx(\"button\",{className:\"px-4 py-2 rounded-lg bg-gray-200 text-gray-700 font-bold shadow-md hover:bg-gray-300 transition\",onClick:()=>{setProposalText('');setSelectedSuggestions([]);setUploadedPdfContent('');setShowContent(false);setGeneratedContent({executiveSummary:'',approach:'',budgetDetails:'',timeline:'',fullContent:''});},disabled:generating,children:\"New\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-xl border border-gray-100 p-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-extrabold text-gray-900\",children:\"Generated Proposal\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-3 h-3 bg-green-500 rounded-full animate-pulse\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-green-600 font-medium\",children:\"Ready\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-50 rounded-xl p-6 max-h-[500px] overflow-y-auto custom-scrollbar\",children:/*#__PURE__*/_jsx(\"div\",{className:\"prose prose-gray max-w-none\",children:/*#__PURE__*/_jsx(ReactMarkdown,{remarkPlugins:[remarkGfm],components:{h1:_ref=>{let{children}=_ref;return/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900 mb-4 mt-0\",children:children});},h2:_ref2=>{let{children}=_ref2;return/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-900 mb-3 mt-6\",children:children});},h3:_ref3=>{let{children}=_ref3;return/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-2 mt-4\",children:children});},p:_ref4=>{let{children}=_ref4;return/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-700 leading-7 mb-3\",children:children});},ul:_ref5=>{let{children}=_ref5;return/*#__PURE__*/_jsx(\"ul\",{className:\"list-disc list-inside text-gray-700 leading-7 mb-3 space-y-1\",children:children});},ol:_ref6=>{let{children}=_ref6;return/*#__PURE__*/_jsx(\"ol\",{className:\"list-decimal list-inside text-gray-700 leading-7 mb-3 space-y-1\",children:children});},li:_ref7=>{let{children}=_ref7;return/*#__PURE__*/_jsx(\"li\",{className:\"text-gray-700\",children:children});},strong:_ref8=>{let{children}=_ref8;return/*#__PURE__*/_jsx(\"strong\",{className:\"font-semibold text-gray-900\",children:children});},em:_ref9=>{let{children}=_ref9;return/*#__PURE__*/_jsx(\"em\",{className:\"italic text-gray-700\",children:children});}},children:generatedContent.fullContent})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 mt-6\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleSaveDraft,disabled:savingDraft,className:\"px-4 py-2 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700 transition disabled:opacity-60 flex-1\",children:savingDraft?'Saving...':'Save Draft'}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowEmailModal(true),className:\"px-4 py-2 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition\",children:\"Send Email\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleDownloadPdf,disabled:downloadingPdf,className:\"px-4 py-2 bg-purple-600 text-white rounded-lg font-semibold hover:bg-purple-700 transition disabled:opacity-60\",children:downloadingPdf?'Downloading...':'Download PDF'})]})]})]}),generating&&!showContent&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center justify-center py-12 w-full\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 animate-ping\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 bg-gradient-to-r from-blue-400 to-purple-500 rounded-full opacity-20\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 animate-ping\",style:{animationDelay:'0.5s'},children:/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 bg-gradient-to-r from-purple-400 to-pink-500 rounded-full opacity-20\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 bg-white rounded-full\"})})]}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-900 mt-6 mb-2\",children:\"Generating Your Proposal\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 text-center max-w-md\",children:\"Our AI is crafting a professional proposal tailored to your requirements. This may take a few moments...\"})]}),generating&&showContent&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl p-8 max-w-md mx-4 text-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative mb-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 animate-ping\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 bg-gradient-to-r from-blue-400 to-purple-500 rounded-full opacity-20\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 animate-ping\",style:{animationDelay:'0.5s'},children:/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 bg-gradient-to-r from-purple-400 to-pink-500 rounded-full opacity-20\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center mx-auto\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 bg-white rounded-full\"})})]}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-900 mb-2\",children:\"Refining Your Proposal\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Our AI is refining your proposal with the selected improvements. This may take a few moments...\"})]})}),showEmailModal&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl shadow-lg p-8 w-full max-w-md\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold mb-4\",children:\"Send Proposal via Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",className:\"w-full border border-gray-300 rounded-lg px-3 py-2 mb-4 focus:outline-none focus:ring-2 focus:ring-blue-400\",placeholder:\"Recipient's email address\",value:email,onChange:e=>setEmail(e.target.value),disabled:sendingEmail}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 justify-end\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowEmailModal(false),className:\"px-4 py-2 rounded-lg bg-gray-200 text-gray-700 font-semibold hover:bg-gray-300 transition\",disabled:sendingEmail,children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSendEmail,className:\"px-4 py-2 rounded-lg bg-blue-600 text-white font-semibold shadow hover:bg-blue-700 transition disabled:opacity-60\",disabled:sendingEmail,children:sendingEmail?'Sending...':'Send'})]})]})})]}),/*#__PURE__*/_jsx(\"style\",{children:`\n        .custom-scrollbar::-webkit-scrollbar {\n          width: 6px;\n        }\n        .custom-scrollbar::-webkit-scrollbar-track {\n          background: #f1f5f9;\n          border-radius: 3px;\n        }\n        .custom-scrollbar::-webkit-scrollbar-thumb {\n          background: #cbd5e1;\n          border-radius: 3px;\n        }\n        .custom-scrollbar::-webkit-scrollbar-thumb:hover {\n          background: #94a3b8;\n        }\n      `})]});};export default Dashboard;","map":{"version":3,"names":["React","useState","useEffect","toast","getOpenRouterChatCompletion","ReactMarkdown","remarkGfm","proposalsAPI","SuggestionButton","jsx","_jsx","jsxs","_jsxs","htmlToMarkdown","input","replace","Dashboard","proposalText","setProposalText","generating","setGenerating","showContent","setShowContent","generatedContent","setGeneratedContent","executiveSummary","approach","budgetDetails","timeline","fullContent","savingDraft","setSavingDraft","sendingEmail","setSendingEmail","downloadingPdf","setDownloadingPdf","showEmailModal","setShowEmailModal","email","setEmail","proposalId","setProposalId","selectedSuggestions","setSelectedSuggestions","loadingSuggestions","setLoadingSuggestions","loadingRefinementSuggestions","setLoadingRefinementSuggestions","uploadingPdf","setUploadingPdf","uploadedPdfContent","setUploadedPdfContent","predefinedSuggestions","text","icon","className","fill","stroke","viewBox","children","strokeLinecap","strokeLinejoin","strokeWidth","d","color","refinementSuggestions","handlePdfUpload","event","_event$target$files","file","target","files","type","error","formData","FormData","append","response","fetch","method","body","headers","localStorage","getItem","ok","Error","data","json","extractedText","content","trim","success","console","value","handleSuggestionClick","suggestion","prev","includes","filter","s","length","handleRegenerateSuggestions","log","handleRegenerateRefinementSuggestions","handleGenerateWithAI","_response$choices$","_response$choices$$me","_execMatch$","_approachMatch$","_budgetMatch$","_timelineMatch$","combinedContent","systemPrompt","userPrompt","map","join","messages","role","aiContent","choices","message","execMatch","match","approachMatch","budgetMatch","timelineMatch","cleanContent","Boolean","setTimeout","handleSaveDraft","payload","title","slice","description","clientName","status","update","create","id","handleSendEmail","sendEmail","recipientEmail","handleDownloadPdf","_link$parentNode","downloadPDF","url","window","URL","createObjectURL","Blob","link","document","createElement","href","setAttribute","appendChild","click","parentNode","removeChild","revokeObjectURL","handleLogout","removeItem","location","onClick","placeholder","onChange","e","disabled","accept","htmlFor","i","isSelected","isDisabled","Array","from","_","style","width","height","remarkPlugins","components","h1","_ref","h2","_ref2","h3","_ref3","p","_ref4","ul","_ref5","ol","_ref6","li","_ref7","strong","_ref8","em","_ref9","animationDelay"],"sources":["/Users/davnishsingh/Documents/proposalai-main/client/src/pages/Dashboard.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { toast } from 'react-hot-toast';\nimport { getOpenRouterChatCompletion } from '../services/api';\nimport ReactMarkdown from 'react-markdown';\nimport remarkGfm from 'remark-gfm';\nimport '../ProposalMarkdown.css';\nimport { proposalsAPI } from '../services/api';\nimport SuggestionButton from '../components/SuggestionButton';\n\n// Utility to convert HTML tags to markdown\nfunction htmlToMarkdown(input: string): string {\n  return input\n    .replace(/<strong>(.*?)<\\/strong>/gi, '**$1**')\n    .replace(/<b>(.*?)<\\/b>/gi, '**$1**')\n    .replace(/<em>(.*?)<\\/em>/gi, '*$1*')\n    .replace(/<i>(.*?)<\\/i>/gi, '*$1*')\n    .replace(/<br\\s*\\/?>(\\s*)/gi, '\\n')\n    .replace(/<[^>]+>/g, '') // Remove any other HTML tags\n    .replace(/\\n{3,}/g, '\\n\\n'); // Collapse excessive newlines\n}\n\nconst Dashboard: React.FC = () => {\n  const [proposalText, setProposalText] = useState('');\n  const [generating, setGenerating] = useState(false);\n  const [showContent, setShowContent] = useState(false);\n  const [generatedContent, setGeneratedContent] = useState({\n    executiveSummary: '',\n    approach: '',\n    budgetDetails: '',\n    timeline: '',\n    fullContent: '' // Added for react-markdown\n  });\n  const [savingDraft, setSavingDraft] = useState(false);\n  const [sendingEmail, setSendingEmail] = useState(false);\n  const [downloadingPdf, setDownloadingPdf] = useState(false);\n  const [showEmailModal, setShowEmailModal] = useState(false);\n  const [email, setEmail] = useState('');\n  const [proposalId, setProposalId] = useState<string | null>(null);\n  const [selectedSuggestions, setSelectedSuggestions] = useState<string[]>([]);\n  const [loadingSuggestions, setLoadingSuggestions] = useState(false);\n  const [loadingRefinementSuggestions, setLoadingRefinementSuggestions] = useState(false);\n  const [uploadingPdf, setUploadingPdf] = useState(false);\n  const [uploadedPdfContent, setUploadedPdfContent] = useState<string>('');\n\n  // Predefined suggestions with icons and colors\n  const predefinedSuggestions = [\n    {\n      text: \"Add Executive Summary\",\n      icon: (\n        <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n        </svg>\n      ),\n      color: 'blue' as const\n    },\n    {\n      text: \"Include Budget Details\",\n      icon: (\n        <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1\" />\n        </svg>\n      ),\n      color: 'green' as const\n    },\n    {\n      text: \"Add Timeline Section\",\n      icon: (\n        <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\" />\n        </svg>\n      ),\n      color: 'purple' as const\n    },\n    {\n      text: \"Include Case Studies\",\n      icon: (\n        <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10\" />\n        </svg>\n      ),\n      color: 'orange' as const\n    },\n    {\n      text: \"Add Team Profiles\",\n      icon: (\n        <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z\" />\n        </svg>\n      ),\n      color: 'blue' as const\n    },\n    {\n      text: \"Include Testimonials\",\n      icon: (\n        <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\" />\n        </svg>\n      ),\n      color: 'purple' as const\n    },\n    {\n      text: \"Add Risk Assessment\",\n      icon: (\n        <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\" />\n        </svg>\n      ),\n      color: 'red' as const\n    },\n    {\n      text: \"Include Next Steps\",\n      icon: (\n        <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 7l5 5m0 0l-5 5m5-5H6\" />\n        </svg>\n      ),\n      color: 'green' as const\n    }\n  ];\n\n  // Refinement suggestions with icons and colors\n  const refinementSuggestions = [\n    {\n      text: \"Enhance Executive Summary\",\n      icon: (\n        <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\" />\n        </svg>\n      ),\n      color: 'blue' as const\n    },\n    {\n      text: \"Add More Details\",\n      icon: (\n        <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\" />\n        </svg>\n      ),\n      color: 'green' as const\n    },\n    {\n      text: \"Improve Clarity\",\n      icon: (\n        <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z\" />\n        </svg>\n      ),\n      color: 'purple' as const\n    },\n    {\n      text: \"Add Examples\",\n      icon: (\n        <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10\" />\n        </svg>\n      ),\n      color: 'orange' as const\n    },\n    {\n      text: \"Strengthen Value Props\",\n      icon: (\n        <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 10V3L4 14h7v7l9-11h-7z\" />\n        </svg>\n      ),\n      color: 'yellow' as const\n    },\n    {\n      text: \"Add Call to Action\",\n      icon: (\n        <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 7l5 5m0 0l-5 5m5-5H6\" />\n        </svg>\n      ),\n      color: 'green' as const\n    }\n  ];\n\n  // Handle PDF file upload and extraction\n  const handlePdfUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file) return;\n\n    if (file.type !== 'application/pdf') {\n      toast.error('Please upload a PDF file');\n      return;\n    }\n\n    setUploadingPdf(true);\n    try {\n      const formData = new FormData();\n      formData.append('pdf', file);\n\n      // Call backend API to extract text from PDF\n      const response = await fetch('/api/proposals/extract-pdf', {\n        method: 'POST',\n        body: formData,\n        headers: {\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\n        }\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to extract PDF content');\n      }\n\n      const data = await response.json();\n      const extractedText = data.content || data.text || '';\n      \n      if (extractedText.trim()) {\n        setUploadedPdfContent(extractedText);\n        toast.success('PDF uploaded successfully! You can now generate a refined proposal.');\n      } else {\n        toast.error('No readable text found in the PDF');\n      }\n    } catch (error) {\n      console.error('PDF extraction error:', error);\n      toast.error('Failed to extract PDF content. Please try again.');\n    } finally {\n      setUploadingPdf(false);\n      // Reset the file input\n      event.target.value = '';\n    }\n  };\n\n  // Handle suggestion bubble click (select/unselect up to 5)\n  const handleSuggestionClick = (suggestion: string) => {\n    setSelectedSuggestions(prev => \n      prev.includes(suggestion) \n        ? prev.filter(s => s !== suggestion)\n        : prev.length < 5 \n          ? [...prev, suggestion]\n          : prev\n    );\n  };\n\n  // Handle regeneration of suggestions\n  const handleRegenerateSuggestions = async () => {\n    setLoadingSuggestions(true);\n    setSelectedSuggestions([]);\n    \n    try {\n      // For now, we'll just shuffle the existing predefined suggestions\n      // In a real implementation, you would call AI to generate new suggestions\n      console.log('Regenerating suggestions...');\n    } catch (error) {\n      console.error('Error regenerating suggestions:', error);\n    } finally {\n      setLoadingSuggestions(false);\n    }\n  };\n\n  // Handle regeneration of refinement suggestions\n  const handleRegenerateRefinementSuggestions = async () => {\n    if (!proposalText.trim() && !uploadedPdfContent.trim()) return;\n    \n    setLoadingRefinementSuggestions(true);\n    setSelectedSuggestions([]);\n    \n    try {\n      // For now, we'll just shuffle the existing refinement suggestions\n      // In a real implementation, you would call AI to generate new suggestions\n      console.log('Regenerating refinement suggestions...');\n    } catch (error) {\n      console.error('Error regenerating refinement suggestions:', error);\n    } finally {\n      setLoadingRefinementSuggestions(false);\n    }\n  };\n\n  const handleGenerateWithAI = async () => {\n    // Check if we have either user input or uploaded PDF content\n    if (!proposalText.trim() && !uploadedPdfContent.trim()) {\n      toast.error('Please enter a proposal description or upload a PDF before generating content');\n      return;\n    }\n    \n    try {\n      setGenerating(true);\n      \n      // Combine user input and uploaded PDF content\n      const combinedContent = uploadedPdfContent.trim() \n        ? `${proposalText.trim() ? proposalText.trim() + '\\n\\n' : ''}PDF Content:\\n${uploadedPdfContent.trim()}`\n        : proposalText.trim();\n      \n      // If there are selected suggestions, use them to refine the proposal\n      let systemPrompt = `You are an expert proposal writer. Generate a professional proposal with these sections: Executive Summary, Approach, Budget Details, Timeline. Use clear, persuasive language.`;\n      \n      let userPrompt = `Content: ${combinedContent}\\n\\nGenerate a professional proposal with: 1. Executive Summary 2. Approach 3. Budget Details 4. Timeline`;\n      \n      // If there are selected suggestions, modify the prompt to include them\n      if (selectedSuggestions.length > 0) {\n        systemPrompt = `You are an expert proposal writer. Generate a professional proposal incorporating these refinements: ${selectedSuggestions.map(s => `\"${s}\"`).join(', ')}. Include: Executive Summary, Approach, Budget Details, Timeline.`;\n        userPrompt = `Content: ${combinedContent}\\n\\nRefinements: ${selectedSuggestions.join(', ')}\\n\\nGenerate proposal with: 1. Executive Summary 2. Approach 3. Budget Details 4. Timeline`;\n      }\n      \n      // Compose prompt for OpenRouter\n      const messages = [\n        {\n          role: 'system',\n          content: systemPrompt,\n        },\n        {\n          role: 'user',\n          content: userPrompt,\n        },\n      ];\n      const response = await getOpenRouterChatCompletion(messages);\n      const aiContent = response.choices[0]?.message?.content || '';\n      let executiveSummary = '', approach = '', budgetDetails = '', timeline = '';\n      const execMatch = aiContent.match(/(?:Executive Summary|EXECUTIVE SUMMARY)[:\\s\\n]*([\\s\\S]*?)(?=\\n\\s*(?:Approach|APPROACH|Budget|BUDGET|Timeline|TIMELINE|Next Steps|NEXT STEPS)[:\\s\\n]|$)/i);\n      const approachMatch = aiContent.match(/(?:Approach|APPROACH|Methodology|METHODOLOGY)[:\\s\\n]*([\\s\\S]*?)(?=\\n\\s*(?:Budget|BUDGET|Timeline|TIMELINE|Next Steps|NEXT STEPS)[:\\s\\n]|$)/i);\n      const budgetMatch = aiContent.match(/(?:Budget Details?|BUDGET DETAILS?|Pricing|PRICING)[:\\s\\n]*([\\s\\S]*?)(?=\\n\\s*(?:Timeline|TIMELINE|Next Steps|NEXT STEPS)[:\\s\\n]|$)/i);\n      const timelineMatch = aiContent.match(/(?:Timeline|TIMELINE|Schedule|SCHEDULE)[:\\s\\n]*([\\s\\S]*?)(?=\\n\\s*(?:Next Steps|NEXT STEPS|Conclusion|CONCLUSION)[:\\s\\n]|$)/i);\n      executiveSummary = execMatch?.[1]?.trim() || '';\n      approach = approachMatch?.[1]?.trim() || '';\n      budgetDetails = budgetMatch?.[1]?.trim() || '';\n      timeline = timelineMatch?.[1]?.trim() || '';\n      const cleanContent = (text: string) => {\n        return text\n          .replace(/\\n{3,}/g, '\\n\\n')\n          .replace(/^\\s+|\\s+$/g, '')\n          .replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>')\n          .replace(/\\*(.*?)\\*/g, '<em>$1</em>');\n      };\n      setGeneratedContent({\n        executiveSummary: htmlToMarkdown(cleanContent(executiveSummary)),\n        approach: htmlToMarkdown(cleanContent(approach)),\n        budgetDetails: htmlToMarkdown(cleanContent(budgetDetails)),\n        timeline: htmlToMarkdown(cleanContent(timeline)),\n        fullContent: [\n          htmlToMarkdown(cleanContent(executiveSummary)),\n          htmlToMarkdown(cleanContent(approach)),\n          htmlToMarkdown(cleanContent(budgetDetails)),\n          htmlToMarkdown(cleanContent(timeline))\n        ].filter(Boolean).join('\\n\\n')\n      });\n      setTimeout(() => {\n        setShowContent(true);\n      }, 500);\n      toast.success('Proposal generated successfully!');\n      // Generate refinement suggestions for the new proposal\n      // generateRefinementSuggestions(aiContent); // This line was removed\n    } catch (error) {\n      console.error('Error generating proposal:', error);\n      \n      // Handle specific OpenRouter credit limit error\n      if (error instanceof Error && error.message.includes('OpenRouter credits exhausted')) {\n        toast.error('AI service credits exhausted. Please visit OpenRouter to add more credits or try again later.');\n      } else {\n        toast.error('Failed to generate proposal content. Please try again.');\n      }\n    } finally {\n      setGenerating(false);\n    }\n  };\n\n  // Save as Draft handler\n  const handleSaveDraft = async () => {\n    setSavingDraft(true);\n    try {\n      const payload = {\n        title: proposalText.slice(0, 60) || 'Untitled Proposal',\n        description: proposalText,\n        clientName: 'Client', // Optionally make this dynamic\n        type: 'PROPOSAL',\n        status: 'DRAFT',\n        content: generatedContent.fullContent,\n      };\n      let response;\n      if (proposalId) {\n        response = await proposalsAPI.update(proposalId, payload);\n      } else {\n        response = await proposalsAPI.create(payload);\n        setProposalId(response.data.data.id);\n      }\n      toast.success('Proposal saved as draft!');\n    } catch (error) {\n      toast.error('Failed to save draft.');\n    } finally {\n      setSavingDraft(false);\n    }\n  };\n\n  // Send as Email handler\n  const handleSendEmail = async () => {\n    if (!email) {\n      toast.error('Please enter a valid email address.');\n      return;\n    }\n    if (!proposalId) {\n      toast.error('Please save the proposal as draft first.');\n      return;\n    }\n    setSendingEmail(true);\n    try {\n      await proposalsAPI.sendEmail(proposalId, { recipientEmail: email });\n      toast.success('Proposal sent via email!');\n      setShowEmailModal(false);\n      setEmail('');\n    } catch (error) {\n      toast.error('Failed to send email.');\n    } finally {\n      setSendingEmail(false);\n    }\n  };\n\n  // Download as PDF handler\n  const handleDownloadPdf = async () => {\n    if (!proposalId) {\n      toast.error('Please save the proposal as draft first.');\n      return;\n    }\n    setDownloadingPdf(true);\n    try {\n      const response = await proposalsAPI.downloadPDF(proposalId);\n      const url = window.URL.createObjectURL(new Blob([response.data], { type: 'application/pdf' }));\n      const link = document.createElement('a');\n      link.href = url;\n      link.setAttribute('download', 'proposal.pdf');\n      document.body.appendChild(link);\n      link.click();\n      link.parentNode?.removeChild(link);\n      window.URL.revokeObjectURL(url);\n      toast.success('PDF downloaded!');\n    } catch (error) {\n      toast.error('Failed to download PDF.');\n    } finally {\n      setDownloadingPdf(false);\n    }\n  };\n\n  const handleLogout = () => {\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n    window.location.href = '/login';\n  };\n\n  // After proposal is generated, generate suggestions\n  useEffect(() => {\n    // We're now using predefined suggestions, so no need for AI generation here\n    // The suggestions are already defined in the component\n  }, [showContent]);\n\n  // REMOVED: Auto-generation useEffect that was causing unwanted generation when typing\n  // Now generation only happens when user explicitly clicks Generate/Refine button\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 flex flex-col\">\n      {/* Top Navigation Bar */}\n      <nav className=\"bg-gradient-to-r from-blue-600 to-blue-400 shadow-lg w-full z-10\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"flex justify-between items-center h-16\">\n            <div className=\"flex items-center\">\n              <h1 className=\"text-xl font-extrabold text-white tracking-wider drop-shadow\">ProposalAI</h1>\n            </div>\n            <div className=\"flex items-center space-x-8\">\n              <a href=\"/dashboard\" className=\"text-white font-semibold border-b-2 border-white/80 pb-1 transition-colors\">Dashboard</a>\n              <a href=\"/drafts\" className=\"text-white/80 hover:text-white transition-colors\">Drafts</a>\n              <a href=\"/sent-proposals\" className=\"text-white/80 hover:text-white transition-colors\">Sent Proposals</a>\n              <a href=\"/profile\" className=\"text-white/80 hover:text-white transition-colors\">Profile</a>\n              <button \n                onClick={handleLogout}\n                className=\"text-white/80 hover:text-white transition-colors\"\n              >\n                Logout\n              </button>\n            </div>\n          </div>\n        </div>\n      </nav>\n      {/* Main Content */}\n      <div className=\"max-w-7xl mx-auto py-8 px-4 sm:px-8\">\n        {!showContent ? (\n          // Single centered card when no content is generated\n          <div className=\"flex flex-col items-center justify-center min-h-[80vh]\">\n            <div className=\"w-full max-w-4xl bg-white/90 rounded-2xl shadow-xl border border-gray-100 p-10 flex flex-col items-center justify-center min-h-[480px] mx-auto\">\n              <h2 className=\"text-2xl font-extrabold text-gray-900 mb-4 text-center\">AI Proposal Generator</h2>\n              \n              {/* Text box with integrated PDF upload */}\n              <div className=\"w-full relative mb-4\">\n                {/* PDF Upload Status - moved above text box */}\n                {uploadedPdfContent && (\n                  <div className=\"flex items-center gap-2 text-sm text-green-600 bg-green-50 px-3 py-2 rounded-lg mb-2\">\n                    <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                    </svg>\n                    PDF uploaded successfully\n                  </div>\n                )}\n                \n                <textarea\n                  className=\"w-full h-[180px] rounded-lg border border-gray-200 px-4 py-3 text-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition bg-gray-50 resize-none\"\n                  placeholder={uploadedPdfContent ? \"Add additional context or requirements (optional)...\" : \"Describe your client or project... or upload a PDF to generate a refined proposal\"}\n                  value={proposalText}\n                  onChange={e => setProposalText(e.target.value)}\n                  disabled={generating}\n                />\n                \n                {/* PDF Upload Button inside text box */}\n                <div className=\"absolute bottom-3 right-3\">\n                  <input\n                    type=\"file\"\n                    accept=\".pdf\"\n                    onChange={handlePdfUpload}\n                    className=\"hidden\"\n                    id=\"pdf-upload\"\n                    disabled={uploadingPdf}\n                  />\n                  <label\n                    htmlFor=\"pdf-upload\"\n                    className={`inline-flex items-center justify-center w-8 h-8 rounded-full transition cursor-pointer ${\n                      uploadingPdf \n                        ? 'bg-gray-100 opacity-50 cursor-not-allowed' \n                        : uploadedPdfContent \n                        ? 'bg-green-100 hover:bg-green-200' \n                        : 'bg-gray-100 hover:bg-gray-200'\n                    }`}\n                    title={uploadedPdfContent ? \"PDF uploaded - Click to replace\" : \"Upload PDF\"}\n                  >\n                    {uploadingPdf ? (\n                      <div className=\"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin\"></div>\n                    ) : uploadedPdfContent ? (\n                      <svg className=\"w-4 h-4 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                      </svg>\n                    ) : (\n                      <svg className=\"w-4 h-4 text-gray-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12\" />\n                      </svg>\n                    )}\n                  </label>\n                </div>\n              </div>\n\n              {/* Initial Suggestions */}\n              {!showContent && (\n                <div className=\"mb-6\">\n                  <div className=\"flex items-center justify-between mb-3\">\n                    <h3 className=\"text-lg font-semibold text-gray-900\">Suggestions to get started:</h3>\n                    <button\n                      onClick={handleRegenerateSuggestions}\n                      disabled={loadingSuggestions}\n                      className=\"text-sm text-blue-600 hover:text-blue-700 font-medium disabled:opacity-50 disabled:cursor-not-allowed\"\n                    >\n                      {loadingSuggestions ? 'Regenerating...' : 'Regenerate Suggestions'}\n                    </button>\n                  </div>\n                  <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3\">\n                    {predefinedSuggestions.map((suggestion, i) => {\n                      const isSelected = selectedSuggestions.includes(suggestion.text);\n                      const isDisabled = !isSelected && selectedSuggestions.length >= 5;\n                      return (\n                        <SuggestionButton\n                          key={i}\n                          icon={suggestion.icon}\n                          text={suggestion.text}\n                          color={suggestion.color}\n                          isSelected={isSelected}\n                          isDisabled={isDisabled}\n                          onClick={() => handleSuggestionClick(suggestion.text)}\n                        />\n                      );\n                    })}\n                  </div>\n                </div>\n              )}\n\n              {/* Refinement Suggestions */}\n              {showContent && (\n                <div className=\"mb-6\">\n                  <div className=\"flex items-center justify-between mb-3\">\n                    <h3 className=\"text-lg font-semibold text-gray-900\">Refine your proposal:</h3>\n                    <button\n                      onClick={handleRegenerateRefinementSuggestions} // This button should regenerate refinement suggestions\n                      disabled={loadingRefinementSuggestions}\n                      className=\"text-sm text-blue-600 hover:text-blue-700 font-medium disabled:opacity-50 disabled:cursor-not-allowed\"\n                    >\n                      {loadingRefinementSuggestions ? 'Regenerating...' : 'Regenerate Suggestions'}\n                    </button>\n                  </div>\n                  <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3\">\n                    {refinementSuggestions.map((suggestion, i) => {\n                      const isSelected = selectedSuggestions.includes(suggestion.text);\n                      const isDisabled = !isSelected && selectedSuggestions.length >= 5;\n                      return (\n                        <SuggestionButton\n                          key={i}\n                          icon={suggestion.icon}\n                          text={suggestion.text}\n                          color={suggestion.color}\n                          isSelected={isSelected}\n                          isDisabled={isDisabled}\n                          onClick={() => handleSuggestionClick(suggestion.text)}\n                        />\n                      );\n                    })}\n                  </div>\n                </div>\n              )}\n              \n              {/* Regenerate Suggestions button */}\n              <div className=\"w-full flex justify-center mb-4\">\n                <button\n                  onClick={handleRegenerateRefinementSuggestions}\n                  disabled={loadingRefinementSuggestions}\n                  className=\"inline-flex items-center gap-2 px-4 py-2 text-sm text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title=\"Generate new refinement suggestions\"\n                >\n                  <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\" />\n                  </svg>\n                  {loadingRefinementSuggestions ? 'Generating...' : 'Regenerate Suggestions'}\n                </button>\n              </div>\n              {/* Generate and Clear buttons */}\n              <div className=\"flex gap-4 mt-2 w-full justify-center\">\n                <button\n                  className=\"px-6 py-2 rounded-lg bg-blue-600 text-white font-bold shadow-md hover:bg-blue-700 transition disabled:opacity-60\"\n                  onClick={handleGenerateWithAI}\n                  disabled={generating || !proposalText.trim()}\n                >\n                  {generating ? 'Generating...' : 'Generate'}\n                </button>\n                <button\n                  className=\"px-6 py-2 rounded-lg bg-gray-200 text-gray-700 font-bold shadow-md hover:bg-gray-300 transition\"\n                  onClick={() => {\n                    setProposalText('');\n                    setSelectedSuggestions([]);\n                    setUploadedPdfContent(''); // Clear PDF content\n                  }}\n                  disabled={generating}\n                >\n                  Clear\n                </button>\n              </div>\n            </div>\n          </div>\n        ) : (\n          // Side-by-side layout when content is generated\n          <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\n            {/* Left side - Input and Refinement */}\n            <div className=\"bg-white/90 rounded-2xl shadow-xl border border-gray-100 p-8\">\n              <h2 className=\"text-xl font-extrabold text-gray-900 mb-4\">Refine Proposal</h2>\n              \n              {/* Text box with integrated PDF upload */}\n              <div className=\"w-full relative mb-4\">\n                {/* PDF Upload Status - moved above text box */}\n                {uploadedPdfContent && (\n                  <div className=\"flex items-center gap-2 text-sm text-green-600 bg-green-50 px-3 py-2 rounded-lg mb-2\">\n                    <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                    </svg>\n                    PDF uploaded successfully\n                  </div>\n                )}\n                \n                <textarea\n                  className=\"w-full h-[180px] rounded-lg border border-gray-200 px-4 py-3 text-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition bg-gray-50 resize-none\"\n                  placeholder={uploadedPdfContent ? \"Add additional context or requirements (optional)...\" : \"Describe your client or project...\"}\n                  value={proposalText}\n                  onChange={e => setProposalText(e.target.value)}\n                  disabled={generating}\n                />\n                \n                {/* PDF Upload Button inside text box */}\n                <div className=\"absolute bottom-3 right-3\">\n                  <input\n                    type=\"file\"\n                    accept=\".pdf\"\n                    onChange={handlePdfUpload}\n                    className=\"hidden\"\n                    id=\"pdf-upload-refine\"\n                    disabled={uploadingPdf}\n                  />\n                  <label\n                    htmlFor=\"pdf-upload-refine\"\n                    className={`inline-flex items-center justify-center w-8 h-8 rounded-full transition cursor-pointer ${\n                      uploadingPdf \n                        ? 'bg-gray-100 opacity-50 cursor-not-allowed' \n                        : uploadedPdfContent \n                        ? 'bg-green-100 hover:bg-green-200' \n                        : 'bg-gray-100 hover:bg-gray-200'\n                    }`}\n                    title={uploadedPdfContent ? \"PDF uploaded - Click to replace\" : \"Upload PDF\"}\n                  >\n                    {uploadingPdf ? (\n                      <div className=\"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin\"></div>\n                    ) : uploadedPdfContent ? (\n                      <svg className=\"w-4 h-4 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                      </svg>\n                    ) : (\n                      <svg className=\"w-4 h-4 text-gray-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12\" />\n                      </svg>\n                    )}\n                  </label>\n                </div>\n              </div>\n\n              {/* Suggestions */}\n              <div className=\"w-full flex flex-wrap gap-2 mb-4 min-h-[40px]\">\n                {loadingRefinementSuggestions ? (\n                  // Show placeholder suggestion bubbles during loading to maintain layout\n                  Array.from({ length: 6 }).map((_, i) => (\n                    <div\n                      key={i}\n                      className=\"px-3 py-1.5 rounded-full border border-gray-200 bg-gray-100 animate-pulse\"\n                      style={{ width: '140px', height: '32px' }}\n                    >\n                      <div className=\"h-3 bg-gray-200 rounded animate-pulse\"></div>\n                    </div>\n                  ))\n                ) : (\n                  refinementSuggestions.map((s, i) => {\n                    const isSelected = selectedSuggestions.includes(s.text);\n                    const isDisabled = !isSelected && selectedSuggestions.length >= 5;\n                    return (\n                      <SuggestionButton\n                        key={i}\n                        icon={s.icon}\n                        text={s.text}\n                        color={s.color}\n                        isSelected={isSelected}\n                        isDisabled={isDisabled}\n                        onClick={() => handleSuggestionClick(s.text)}\n                      />\n                    );\n                  })\n                )}\n              </div>\n              \n              {/* Regenerate Suggestions button */}\n              <div className=\"w-full flex justify-center mb-4\">\n                <button\n                  onClick={handleRegenerateRefinementSuggestions}\n                  disabled={loadingRefinementSuggestions}\n                  className=\"inline-flex items-center gap-2 px-3 py-1.5 text-xs text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title=\"Generate new refinement suggestions\"\n                >\n                  <svg className=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\" />\n                  </svg>\n                  {loadingRefinementSuggestions ? 'Generating...' : 'Regenerate Suggestions'}\n                </button>\n              </div>\n              {/* Refine and Clear buttons */}\n              <div className=\"flex gap-3\">\n                <button\n                  className=\"px-4 py-2 rounded-lg bg-blue-600 text-white font-bold shadow-md hover:bg-blue-700 transition disabled:opacity-60 flex-1\"\n                  onClick={async () => {\n                    setGenerating(true);\n                    // Regenerate proposal with selected suggestions\n                    await handleGenerateWithAI();\n                  }}\n                  disabled={generating}\n                >\n                  {generating ? 'Generating...' : 'Refine'}\n                </button>\n                <button\n                  className=\"px-4 py-2 rounded-lg bg-gray-200 text-gray-700 font-bold shadow-md hover:bg-gray-300 transition\"\n                  onClick={() => {\n                    setProposalText('');\n                    setSelectedSuggestions([]);\n                    setUploadedPdfContent('');\n                    setShowContent(false);\n                    setGeneratedContent({\n                      executiveSummary: '',\n                      approach: '',\n                      budgetDetails: '',\n                      timeline: '',\n                      fullContent: ''\n                    });\n                  }}\n                  disabled={generating}\n                >\n                  New\n                </button>\n              </div>\n            </div>\n\n            {/* Right side - Generated Proposal */}\n            <div className=\"bg-white rounded-2xl shadow-xl border border-gray-100 p-8\">\n              <div className=\"flex items-center justify-between mb-6\">\n                <h2 className=\"text-xl font-extrabold text-gray-900\">Generated Proposal</h2>\n                <div className=\"flex items-center gap-2\">\n                  <div className=\"w-3 h-3 bg-green-500 rounded-full animate-pulse\"></div>\n                  <span className=\"text-sm text-green-600 font-medium\">Ready</span>\n                </div>\n              </div>\n              \n              <div className=\"bg-gray-50 rounded-xl p-6 max-h-[500px] overflow-y-auto custom-scrollbar\">\n                <div className=\"prose prose-gray max-w-none\">\n                  <ReactMarkdown\n                    remarkPlugins={[remarkGfm]}\n                    components={{\n                      h1: ({ children }) => <h1 className=\"text-2xl font-bold text-gray-900 mb-4 mt-0\">{children}</h1>,\n                      h2: ({ children }) => <h2 className=\"text-xl font-bold text-gray-900 mb-3 mt-6\">{children}</h2>,\n                      h3: ({ children }) => <h3 className=\"text-lg font-semibold text-gray-900 mb-2 mt-4\">{children}</h3>,\n                      p: ({ children }) => <p className=\"text-gray-700 leading-7 mb-3\">{children}</p>,\n                      ul: ({ children }) => <ul className=\"list-disc list-inside text-gray-700 leading-7 mb-3 space-y-1\">{children}</ul>,\n                      ol: ({ children }) => <ol className=\"list-decimal list-inside text-gray-700 leading-7 mb-3 space-y-1\">{children}</ol>,\n                      li: ({ children }) => <li className=\"text-gray-700\">{children}</li>,\n                      strong: ({ children }) => <strong className=\"font-semibold text-gray-900\">{children}</strong>,\n                      em: ({ children }) => <em className=\"italic text-gray-700\">{children}</em>,\n                    }}\n                  >\n                    {generatedContent.fullContent}\n                  </ReactMarkdown>\n                </div>\n              </div>\n\n              {/* Action buttons */}\n              <div className=\"flex gap-3 mt-6\">\n                <button\n                  onClick={handleSaveDraft}\n                  disabled={savingDraft}\n                  className=\"px-4 py-2 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700 transition disabled:opacity-60 flex-1\"\n                >\n                  {savingDraft ? 'Saving...' : 'Save Draft'}\n                </button>\n                <button\n                  onClick={() => setShowEmailModal(true)}\n                  className=\"px-4 py-2 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition\"\n                >\n                  Send Email\n                </button>\n                <button\n                  onClick={handleDownloadPdf}\n                  disabled={downloadingPdf}\n                  className=\"px-4 py-2 bg-purple-600 text-white rounded-lg font-semibold hover:bg-purple-700 transition disabled:opacity-60\"\n                >\n                  {downloadingPdf ? 'Downloading...' : 'Download PDF'}\n                </button>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Loading screen below the box when generating */}\n        {generating && !showContent && (\n          <div className=\"flex flex-col items-center justify-center py-12 w-full\">\n            <div className=\"relative\">\n              {/* Animated circles */}\n              <div className=\"absolute inset-0 animate-ping\">\n                <div className=\"w-16 h-16 bg-gradient-to-r from-blue-400 to-purple-500 rounded-full opacity-20\"></div>\n              </div>\n              <div className=\"absolute inset-0 animate-ping\" style={{ animationDelay: '0.5s' }}>\n                <div className=\"w-16 h-16 bg-gradient-to-r from-purple-400 to-pink-500 rounded-full opacity-20\"></div>\n              </div>\n              <div className=\"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center\">\n                <div className=\"w-8 h-8 bg-white rounded-full\"></div>\n              </div>\n            </div>\n            <h3 className=\"text-xl font-bold text-gray-900 mt-6 mb-2\">Generating Your Proposal</h3>\n            <p className=\"text-gray-600 text-center max-w-md\">\n              Our AI is crafting a professional proposal tailored to your requirements. This may take a few moments...\n            </p>\n          </div>\n        )}\n\n        {/* Loading screen for refinement state */}\n        {generating && showContent && (\n          <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n            <div className=\"bg-white rounded-2xl p-8 max-w-md mx-4 text-center\">\n              <div className=\"relative mb-6\">\n                {/* Animated circles */}\n                <div className=\"absolute inset-0 animate-ping\">\n                  <div className=\"w-16 h-16 bg-gradient-to-r from-blue-400 to-purple-500 rounded-full opacity-20\"></div>\n                </div>\n                <div className=\"absolute inset-0 animate-ping\" style={{ animationDelay: '0.5s' }}>\n                  <div className=\"w-16 h-16 bg-gradient-to-r from-purple-400 to-pink-500 rounded-full opacity-20\"></div>\n                </div>\n                <div className=\"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center mx-auto\">\n                  <div className=\"w-8 h-8 bg-white rounded-full\"></div>\n                </div>\n              </div>\n              <h3 className=\"text-xl font-bold text-gray-900 mb-2\">Refining Your Proposal</h3>\n              <p className=\"text-gray-600\">\n                Our AI is refining your proposal with the selected improvements. This may take a few moments...\n              </p>\n            </div>\n          </div>\n        )}\n        {/* Email Modal (if needed) */}\n        {showEmailModal && (\n          <div className=\"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50\">\n            <div className=\"bg-white rounded-xl shadow-lg p-8 w-full max-w-md\">\n              <h2 className=\"text-lg font-semibold mb-4\">Send Proposal via Email</h2>\n              <input\n                type=\"email\"\n                className=\"w-full border border-gray-300 rounded-lg px-3 py-2 mb-4 focus:outline-none focus:ring-2 focus:ring-blue-400\"\n                placeholder=\"Recipient's email address\"\n                value={email}\n                onChange={e => setEmail(e.target.value)}\n                disabled={sendingEmail}\n              />\n              <div className=\"flex gap-3 justify-end\">\n                <button\n                  onClick={() => setShowEmailModal(false)}\n                  className=\"px-4 py-2 rounded-lg bg-gray-200 text-gray-700 font-semibold hover:bg-gray-300 transition\"\n                  disabled={sendingEmail}\n                >Cancel</button>\n                <button\n                  onClick={handleSendEmail}\n                  className=\"px-4 py-2 rounded-lg bg-blue-600 text-white font-semibold shadow hover:bg-blue-700 transition disabled:opacity-60\"\n                  disabled={sendingEmail}\n                >{sendingEmail ? 'Sending...' : 'Send'}</button>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n      <style>{`\n        .custom-scrollbar::-webkit-scrollbar {\n          width: 6px;\n        }\n        .custom-scrollbar::-webkit-scrollbar-track {\n          background: #f1f5f9;\n          border-radius: 3px;\n        }\n        .custom-scrollbar::-webkit-scrollbar-thumb {\n          background: #cbd5e1;\n          border-radius: 3px;\n        }\n        .custom-scrollbar::-webkit-scrollbar-thumb:hover {\n          background: #94a3b8;\n        }\n      `}</style>\n    </div>\n  );\n};\n\nexport default Dashboard; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}