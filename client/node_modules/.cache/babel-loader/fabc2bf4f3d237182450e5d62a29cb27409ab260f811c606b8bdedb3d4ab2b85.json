{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useParams,useNavigate}from'react-router-dom';import{toast}from'react-hot-toast';import ReactMarkdown from'react-markdown';import{proposalsAPI,getOpenRouterChatCompletion}from'../services/api';import ClientSelectionModal from'../components/ClientSelectionModal';import{DocumentTextIcon,UserIcon,SparklesIcon,CogIcon,CheckCircleIcon,ClockIcon,CurrencyDollarIcon,ArrowPathIcon,EyeIcon,PencilIcon}from'@heroicons/react/24/outline';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProposalEditor=()=>{var _proposal$content7,_proposal$content8,_proposal$content9,_proposal$content0,_proposal$content1,_proposal$content1$fu,_proposal$content10,_proposal$content10$f,_proposal$content11;const{id}=useParams();const navigate=useNavigate();const[loading,setLoading]=useState(false);const[generating,setGenerating]=useState(false);const[showClientModal,setShowClientModal]=useState(false);const[selectedClientId,setSelectedClientId]=useState(undefined);const[proposal,setProposal]=useState({title:'',description:'',clientName:'',clientEmail:'',type:'PROPOSAL',content:{executiveSummary:'',approach:'',budgetDetails:'',timeline:'',budget:'',fullProposal:''// Added for unified editing\n},metadata:{industry:'',companySize:'',projectScope:''}});const[accessRequests,setAccessRequests]=useState([]);const[grantingRequestId,setGrantingRequestId]=useState(null);const[previewMode,setPreviewMode]=useState(false);const isNewProposal=!id;// Debug log to verify access requests\nconsole.log('ðŸ” Access requests state:',accessRequests);useEffect(()=>{const fetchProposal=async()=>{try{const{data}=await proposalsAPI.getById(id);// Ensure metadata exists with default values\nconst proposalData={...data.data,metadata:{industry:'',companySize:'',projectScope:'',...data.data.metadata},content:{executiveSummary:'',approach:'',budgetDetails:'',timeline:'',budget:'',fullProposal:'',...data.data.content}};setProposal(proposalData);setSelectedClientId(data.data.clientId);}catch(error){console.error('Failed to fetch proposal:',error);toast.error('Failed to load proposal');}};if(id){fetchProposal();}},[id]);useEffect(()=>{if(id){proposalsAPI.getAccessRequests(id).then(_ref=>{let{data}=_ref;return setAccessRequests(data.data);}).catch(()=>setAccessRequests([]));}},[id]);const handleGenerateWithAI=async()=>{console.log('ðŸš€ handleGenerateWithAI function called!');console.log('ðŸ” Environment check:',{NODE_ENV:process.env.NODE_ENV,REACT_APP_OPENROUTER_API_KEY:process.env.REACT_APP_OPENROUTER_API_KEY?'SET':'NOT SET'});// Simple test to see if the function is working\nconsole.log('ðŸ§ª Simple test - function is working!');// Test with a simple prompt first to see if the AI is working\nconsole.log('ðŸ§ª Testing AI with simple prompt...');try{const testMessages=[{role:'system',content:'You are a helpful assistant that writes detailed, specific content.'},{role:'user',content:'Write a short paragraph about web development services. Be specific and detailed, not generic.'}];const testResponse=await getOpenRouterChatCompletion(testMessages);console.log('ðŸ§ª Test response:',testResponse);}catch(error){console.error('ðŸ§ª Test failed:',error);}// Validate required fields\n// Validate required fields\nconsole.log('ðŸ” Current proposal state:',{clientName:proposal.clientName,description:proposal.description,hasClientName:!!proposal.clientName,hasDescription:!!proposal.description});if(!proposal.clientName||!proposal.description){const missingFields=[];if(!proposal.clientName)missingFields.push('Client Name');if(!proposal.description)missingFields.push('Description');toast.error(`Please fill in: ${missingFields.join(' and ')} before generating content`);return;}setGenerating(true);try{const messages=[{role:'system',content:'You are an expert business proposal writer. Write detailed, specific content based on the project information provided. Never use generic placeholder text like \"Feature 1\" or \"Benefit 1\". Always provide concrete, actionable content.'},{role:'user',content:`Write a professional business proposal for this project:\n\nClient: ${proposal.clientName}\nProject: ${proposal.description}\nBudget: ${proposal.budget||'To be determined'}\nTimeline: ${proposal.timeline||'To be determined'}\n\nCreate a detailed proposal with these sections:\n\n# Executive Summary\n[Write a compelling overview of the project and its value]\n\n# Project Overview  \n[Detailed analysis of requirements and objectives]\n\n# Our Approach\n[Step-by-step methodology and processes]\n\n# Project Deliverables\nCreate a detailed list of specific deliverables with descriptions and timelines. Format as:\n- **Deliverable Name**: Brief description. Timeline: X weeks/days\n\n# Project Timeline\nCreate a detailed timeline with specific phases, dates, and milestones. Format exactly as:\n1. **Phase Name** (YYYY-MM-DD)\n   Description of what will be completed in this phase.\n\n2. **Phase Name** (YYYY-MM-DD)\n   Description of what will be completed in this phase.\n\n3. **Phase Name** (YYYY-MM-DD)\n   Description of what will be completed in this phase.\n\nIMPORTANT: Each timeline item must be on a new line with the number, then the phase name in bold, then the date in parentheses, then the description on the next line.\n\n# Investment\n[Pricing and payment terms]\n\n# Why Choose Us\n[Experience and competitive advantages]\n\n# Next Steps\n[Clear action items and contact info]\n\nIMPORTANT: \n- Write specific, detailed content for each section based on the project description\n- Do not use generic text like \"Feature 1\"\n- Make it professional and compelling\n- Include realistic timelines and deliverables based on the project scope\n- Use specific dates and milestones for the timeline section`}];console.log('ðŸš€ Sending AI generation request with messages:',messages);console.log('ðŸ”— About to call getOpenRouterChatCompletion...');const response=await getOpenRouterChatCompletion(messages);console.log('âœ… AI response received:',response);if(response&&response.choices&&response.choices[0]&&response.choices[0].message){const aiContent=response.choices[0].message.content;console.log('ðŸ“ AI generated content:',aiContent);const cleanContent=content=>{// Remove any markdown formatting that might interfere\nreturn content.replace(/```markdown/g,'').replace(/```/g,'').trim();};const cleanedContent=cleanContent(aiContent);console.log('ðŸ§¹ Cleaned content:',cleanedContent);setProposal(prev=>({...prev,content:{...prev.content,fullProposal:cleanedContent}}));toast.success('Proposal content generated successfully!');}else{console.error('âŒ Invalid response structure:',response);toast.error('Invalid response from AI service');}}catch(error){console.error('Error generating content:',error);toast.error('Failed to generate content. Please try again.');}finally{setGenerating(false);}};const handleSave=async()=>{if(!proposal.title||!proposal.clientName||!proposal.description){toast.error('Please fill in all required fields');return;}setLoading(true);try{if(isNewProposal){await proposalsAPI.create(proposal);toast.success('Proposal saved as draft!');navigate('/drafts');}else{await proposalsAPI.update(id,proposal);toast.success('Proposal updated successfully!');}}catch(error){console.error('Error saving proposal:',error);toast.error('Failed to save proposal');}finally{setLoading(false);}};const handleSubmit=async()=>{if(!proposal.title||!proposal.clientName||!proposal.description){toast.error('Please fill in all required fields');return;}setLoading(true);try{const updatedProposal={...proposal,status:'SENT'};if(isNewProposal){await proposalsAPI.create(updatedProposal);}else{await proposalsAPI.update(id,updatedProposal);}toast.success('Proposal submitted successfully!');navigate('/sent-proposals');}catch(error){console.error('Error submitting proposal:',error);toast.error('Failed to submit proposal');}finally{setLoading(false);}};const handleClientSelect=client=>{setProposal(prev=>({...prev,clientName:client.name,clientEmail:client.email}));setSelectedClientId(client.id);setShowClientModal(false);};const handleClearClient=()=>{setProposal(prev=>({...prev,clientName:'',clientEmail:''}));setSelectedClientId(undefined);};const handleGrantAccess=async requestId=>{setGrantingRequestId(requestId);try{await proposalsAPI.grantAccessRequest(id,requestId);toast.success('Access granted and email sent!');// Refresh access requests\nconst{data}=await proposalsAPI.getAccessRequests(id);setAccessRequests(data.data);}catch(error){toast.error('Failed to grant access');}finally{setGrantingRequestId(null);}};const handleRefineEntireProposal=async()=>{var _proposal$content;if(!(proposal!==null&&proposal!==void 0&&(_proposal$content=proposal.content)!==null&&_proposal$content!==void 0&&_proposal$content.fullProposal)){toast.error('No content to refine. Please generate or add content first.');return;}setGenerating(true);try{const messages=[{role:'system',content:`You are an expert proposal writer with 15+ years of experience in refining and improving business proposals. Your expertise includes:\n\n- Enhancing clarity and professional tone\n- Strengthening value propositions and benefits\n- Improving persuasive language and calls-to-action\n- Adding specific details and concrete examples\n- Ensuring industry-specific terminology and best practices\n- Maintaining professional structure while improving content quality\n\nWhen refining proposals, you focus on making the content more compelling, specific, and actionable while preserving the existing structure and key information.`},{role:'user',content:`Please refine and improve the following proposal content. Make it more compelling, professional, and persuasive while maintaining the same structure and sections.\n\nCURRENT PROPOSAL CONTENT:\n${proposal.content.fullProposal}\n\nPlease enhance the following aspects:\n1. Clarity and readability - Make the content easier to understand\n2. Professional tone - Ensure it sounds authoritative and trustworthy\n3. Persuasive language - Strengthen the value proposition and benefits\n4. Specific details - Add concrete examples, metrics, and actionable items\n5. Call-to-action - Make the next steps clear and compelling\n\nIMPORTANT GUIDELINES:\n- Maintain the existing structure and sections\n- Keep all key information and client details\n- Add specific, relevant details where appropriate\n- Avoid generic placeholder text\n- Make the content more engaging and professional\n- Ensure each section provides clear value and next steps\n\nReturn the improved version with enhanced content while maintaining the same overall structure.`}];const response=await getOpenRouterChatCompletion(messages);if(response&&response.choices&&response.choices[0]&&response.choices[0].message){setProposal(prev=>({...prev,content:{...prev.content,fullProposal:response.choices[0].message.content.trim()}}));toast.success('Proposal refined successfully!');}}catch(error){console.error('Error refining content:',error);toast.error('Failed to refine content. Please try again.');}finally{setGenerating(false);}};const handleFormatProposal=()=>{var _proposal$content2;if(!(proposal!==null&&proposal!==void 0&&(_proposal$content2=proposal.content)!==null&&_proposal$content2!==void 0&&_proposal$content2.fullProposal)){toast.error('No content to format. Please add content first.');return;}const content=proposal.content.fullProposal;const formattedContent=content.replace(/([A-Z][a-z]+:)/g,'\\n## $1')// Add markdown headers\n.replace(/(\\d+\\.\\s)/g,'\\n$1')// Add line breaks before numbered lists\n.replace(/(â€¢\\s)/g,'\\n$1')// Add line breaks before bullet points\n.trim();setProposal(prev=>({...prev,content:{...prev.content,fullProposal:formattedContent}}));toast.success('Proposal formatted successfully!');};const getCombinedProposalContent=()=>{var _proposal$content3,_proposal$content4,_proposal$content5,_proposal$content6;const sections=[];if(proposal!==null&&proposal!==void 0&&(_proposal$content3=proposal.content)!==null&&_proposal$content3!==void 0&&_proposal$content3.executiveSummary)sections.push(`# Executive Summary\\n${proposal.content.executiveSummary}`);if(proposal!==null&&proposal!==void 0&&(_proposal$content4=proposal.content)!==null&&_proposal$content4!==void 0&&_proposal$content4.approach)sections.push(`# Approach\\n${proposal.content.approach}`);if(proposal!==null&&proposal!==void 0&&(_proposal$content5=proposal.content)!==null&&_proposal$content5!==void 0&&_proposal$content5.budgetDetails)sections.push(`# Budget Details\\n${proposal.content.budgetDetails}`);if(proposal!==null&&proposal!==void 0&&(_proposal$content6=proposal.content)!==null&&_proposal$content6!==void 0&&_proposal$content6.timeline)sections.push(`# Timeline\\n${proposal.content.timeline}`);return sections.join('\\n\\n');};return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-50\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white border-b border-gray-200 px-6 py-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 bg-gradient-to-r from-primary-600 to-primary-700 rounded-xl flex items-center justify-center shadow-lg\",children:/*#__PURE__*/_jsx(DocumentTextIcon,{className:\"w-5 h-5 text-white\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900\",children:isNewProposal?'Create New Proposal':'Edit Proposal'}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:isNewProposal?'Build a compelling proposal from scratch':'Refine and perfect your proposal'})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:handleSave,disabled:loading,className:\"btn-secondary flex items-center gap-2\",children:[/*#__PURE__*/_jsx(PencilIcon,{className:\"w-4 h-4\"}),\"Save Draft\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:handleSubmit,disabled:loading,className:\"btn-primary flex items-center gap-2\",children:[/*#__PURE__*/_jsx(CheckCircleIcon,{className:\"w-4 h-4\"}),\"Submit Proposal\"]})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"max-w-7xl mx-auto px-6 py-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-3 gap-8\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"lg:col-span-1\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-sm border border-gray-200 p-6 sticky top-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 mb-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 bg-gradient-to-r from-blue-100 to-blue-200 rounded-lg flex items-center justify-center\",children:/*#__PURE__*/_jsx(CogIcon,{className:\"w-4 h-4 text-blue-600\"})}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-900\",children:\"Proposal Details\"})]}),/*#__PURE__*/_jsxs(\"form\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-semibold text-gray-700\",children:[\"Proposal Title \",/*#__PURE__*/_jsx(\"span\",{className:\"text-red-500\",children:\"*\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:(proposal===null||proposal===void 0?void 0:proposal.title)||'',onChange:e=>setProposal({...proposal,title:e.target.value}),className:\"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 bg-gray-50 hover:bg-white\",placeholder:\"Enter proposal title\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-semibold text-gray-700\",children:[\"Client \",/*#__PURE__*/_jsx(\"span\",{className:\"text-red-500\",children:\"*\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:(proposal===null||proposal===void 0?void 0:proposal.clientName)||'',onChange:e=>setProposal({...proposal,clientName:e.target.value}),className:\"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 bg-gray-50 hover:bg-white\",placeholder:\"Enter client name\"}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>setShowClientModal(true),className:`px-4 py-3 rounded-xl transition-all duration-200 flex items-center gap-2 whitespace-nowrap font-medium ${selectedClientId?'bg-green-600 text-white hover:bg-green-700 shadow-md':'bg-primary-600 text-white hover:bg-primary-700 shadow-md'}`,children:[/*#__PURE__*/_jsx(UserIcon,{className:\"w-4 h-4\"}),selectedClientId?'Change':'Select']})]}),selectedClientId&&/*#__PURE__*/_jsx(\"div\",{className:\"p-3 bg-green-50 border border-green-200 rounded-xl\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 text-sm text-green-800\",children:[/*#__PURE__*/_jsx(CheckCircleIcon,{className:\"w-4 h-4\"}),\"Client selected from database\"]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleClearClient,className:\"text-red-600 hover:text-red-800 text-sm font-medium\",children:\"Clear\"})]})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-semibold text-gray-700\",children:[\"Project Description \",/*#__PURE__*/_jsx(\"span\",{className:\"text-red-500\",children:\"*\"})]}),/*#__PURE__*/_jsx(\"textarea\",{value:(proposal===null||proposal===void 0?void 0:proposal.description)||'',onChange:e=>setProposal({...proposal,description:e.target.value}),rows:4,className:\"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 bg-gray-50 hover:bg-white resize-none\",placeholder:\"Describe the project, requirements, and objectives...\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700\",children:\"Budget\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(CurrencyDollarIcon,{className:\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:(proposal===null||proposal===void 0?void 0:proposal.budget)||'',onChange:e=>setProposal({...proposal,budget:e.target.value}),className:\"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 bg-gray-50 hover:bg-white\",placeholder:\"e.g. $50,000\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700\",children:\"Timeline\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(ClockIcon,{className:\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:(proposal===null||proposal===void 0?void 0:proposal.timeline)||'',onChange:e=>setProposal({...proposal,timeline:e.target.value}),className:\"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 bg-gray-50 hover:bg-white\",placeholder:\"e.g. 2 months\"})]})]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{console.log('ðŸ”˜ Button clicked!');console.log('ðŸ“Š Current state:',{generating,loading,clientName:proposal===null||proposal===void 0?void 0:proposal.clientName,description:proposal===null||proposal===void 0?void 0:proposal.description,isDisabled:generating||loading||!(proposal!==null&&proposal!==void 0&&proposal.clientName)||!(proposal!==null&&proposal!==void 0&&proposal.description)});handleGenerateWithAI();},disabled:generating||loading||!(proposal!==null&&proposal!==void 0&&proposal.clientName)||!(proposal!==null&&proposal!==void 0&&proposal.description),className:`w-full py-4 px-6 rounded-xl font-semibold text-white transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-offset-2 shadow-lg ${generating||loading||!(proposal!==null&&proposal!==void 0&&proposal.clientName)||!(proposal!==null&&proposal!==void 0&&proposal.description)?'bg-gray-400 cursor-not-allowed':'bg-gradient-to-r from-primary-600 to-purple-600 hover:from-primary-700 hover:to-purple-700 focus:ring-primary-500'}`,children:generating?/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center\",children:[/*#__PURE__*/_jsx(ArrowPathIcon,{className:\"animate-spin -ml-1 mr-3 h-5 w-5 text-white\"}),\"Generating Content...\"]}):/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center\",children:[/*#__PURE__*/_jsx(SparklesIcon,{className:\"w-5 h-5 mr-2\"}),\"Generate AI Content\"]})}),(!(proposal!==null&&proposal!==void 0&&proposal.clientName)||!(proposal!==null&&proposal!==void 0&&proposal.description))&&/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 text-center\",children:\"Enter client name and description to enable AI generation\"})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"lg:col-span-2\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-sm border border-gray-200 p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-900 mb-1\",children:\"Proposal Content\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Review, edit, and refine your proposal content\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setPreviewMode(!previewMode),className:\"btn-secondary flex items-center gap-2\",children:[previewMode?/*#__PURE__*/_jsx(PencilIcon,{className:\"w-4 h-4\"}):/*#__PURE__*/_jsx(EyeIcon,{className:\"w-4 h-4\"}),previewMode?'Edit Mode':'Preview Mode']}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleRefineEntireProposal(),disabled:generating||!(proposal!==null&&proposal!==void 0&&(_proposal$content7=proposal.content)!==null&&_proposal$content7!==void 0&&_proposal$content7.fullProposal),className:\"btn-primary flex items-center gap-2\",children:[/*#__PURE__*/_jsx(SparklesIcon,{className:\"w-4 h-4\"}),\"Refine with AI\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleFormatProposal(),disabled:!(proposal!==null&&proposal!==void 0&&(_proposal$content8=proposal.content)!==null&&_proposal$content8!==void 0&&_proposal$content8.fullProposal),className:\"btn-secondary flex items-center gap-2\",children:[/*#__PURE__*/_jsx(CogIcon,{className:\"w-4 h-4\"}),\"Format\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4 text-sm text-gray-600 p-3 bg-gray-50 rounded-xl\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(EyeIcon,{className:\"w-4 h-4\"}),\"Edit the entire proposal content below\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(SparklesIcon,{className:\"w-4 h-4\"}),\"Use \\\"Refine with AI\\\" to improve the entire document\"]})]}),previewMode?/*#__PURE__*/_jsx(\"div\",{className:\"w-full px-4 py-3 border border-gray-300 rounded-xl bg-white min-h-[600px] overflow-y-auto\",children:/*#__PURE__*/_jsx(\"div\",{className:\"proposal-content\",children:/*#__PURE__*/_jsx(ReactMarkdown,{children:(proposal===null||proposal===void 0?void 0:(_proposal$content9=proposal.content)===null||_proposal$content9===void 0?void 0:_proposal$content9.fullProposal)||getCombinedProposalContent()})})}):/*#__PURE__*/_jsx(\"textarea\",{value:(proposal===null||proposal===void 0?void 0:(_proposal$content0=proposal.content)===null||_proposal$content0===void 0?void 0:_proposal$content0.fullProposal)||getCombinedProposalContent(),onChange:e=>setProposal({...proposal,content:{...(proposal===null||proposal===void 0?void 0:proposal.content),fullProposal:e.target.value}}),rows:25,className:\"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none transition-all duration-200 bg-gray-50 font-mono text-sm leading-relaxed hover:bg-white\",placeholder:\"Enter your complete proposal content here... # Executive Summary\\n[Your executive summary goes here] # Project Overview\\n[Detailed analysis of requirements and objectives] # Our Approach\\n[Step-by-step methodology and processes] # Project Deliverables\\n- **Deliverable Name**: Brief description. Timeline: X weeks/days # Project Timeline\\n1. **Phase Name** (YYYY-MM-DD) Description of what will be completed in this phase. # Investment\\n[Pricing and payment terms] # Why Choose Us\\n[Experience and competitive advantages] # Next Steps\\n[Clear action items and contact info]\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between text-xs text-gray-500 p-3 bg-gray-50 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"Word count: \",(proposal===null||proposal===void 0?void 0:(_proposal$content1=proposal.content)===null||_proposal$content1===void 0?void 0:(_proposal$content1$fu=_proposal$content1.fullProposal)===null||_proposal$content1$fu===void 0?void 0:_proposal$content1$fu.split(/\\s+/).length)||0,\" words\"]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Characters: \",(proposal===null||proposal===void 0?void 0:(_proposal$content10=proposal.content)===null||_proposal$content10===void 0?void 0:(_proposal$content10$f=_proposal$content10.fullProposal)===null||_proposal$content10$f===void 0?void 0:_proposal$content10$f.length)||0]})]})]}),(proposal===null||proposal===void 0?void 0:(_proposal$content11=proposal.content)===null||_proposal$content11===void 0?void 0:_proposal$content11.fullProposal)&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 bg-green-50 border border-green-200 rounded-xl p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 text-green-800\",children:[/*#__PURE__*/_jsx(CheckCircleIcon,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Content Ready!\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-green-700 text-sm mt-1\",children:\"Review and edit the content above. Use \\\"Refine with AI\\\" to improve the entire document or \\\"Format\\\" to structure it properly.\"})]})]})})]})}),/*#__PURE__*/_jsx(ClientSelectionModal,{isOpen:showClientModal,onClose:()=>setShowClientModal(false),onSelectClient:handleClientSelect,selectedClientId:selectedClientId})]});};export default ProposalEditor;","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","toast","ReactMarkdown","proposalsAPI","getOpenRouterChatCompletion","ClientSelectionModal","DocumentTextIcon","UserIcon","SparklesIcon","CogIcon","CheckCircleIcon","ClockIcon","CurrencyDollarIcon","ArrowPathIcon","EyeIcon","PencilIcon","jsx","_jsx","jsxs","_jsxs","ProposalEditor","_proposal$content7","_proposal$content8","_proposal$content9","_proposal$content0","_proposal$content1","_proposal$content1$fu","_proposal$content10","_proposal$content10$f","_proposal$content11","id","navigate","loading","setLoading","generating","setGenerating","showClientModal","setShowClientModal","selectedClientId","setSelectedClientId","undefined","proposal","setProposal","title","description","clientName","clientEmail","type","content","executiveSummary","approach","budgetDetails","timeline","budget","fullProposal","metadata","industry","companySize","projectScope","accessRequests","setAccessRequests","grantingRequestId","setGrantingRequestId","previewMode","setPreviewMode","isNewProposal","console","log","fetchProposal","data","getById","proposalData","clientId","error","getAccessRequests","then","_ref","catch","handleGenerateWithAI","NODE_ENV","process","env","REACT_APP_OPENROUTER_API_KEY","testMessages","role","testResponse","hasClientName","hasDescription","missingFields","push","join","messages","response","choices","message","aiContent","cleanContent","replace","trim","cleanedContent","prev","success","handleSave","create","update","handleSubmit","updatedProposal","status","handleClientSelect","client","name","email","handleClearClient","handleGrantAccess","requestId","grantAccessRequest","handleRefineEntireProposal","_proposal$content","handleFormatProposal","_proposal$content2","formattedContent","getCombinedProposalContent","_proposal$content3","_proposal$content4","_proposal$content5","_proposal$content6","sections","className","children","onClick","disabled","value","onChange","e","target","placeholder","rows","isDisabled","split","length","isOpen","onClose","onSelectClient"],"sources":["/Users/davnishsingh/Documents/proposalai-main/proposalai/client/src/pages/ProposalEditor.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { toast } from 'react-hot-toast';\nimport ReactMarkdown from 'react-markdown';\nimport { proposalsAPI, getOpenRouterChatCompletion } from '../services/api';\nimport ClientSelectionModal from '../components/ClientSelectionModal';\nimport { \n  DocumentTextIcon, \n  UserIcon, \n  SparklesIcon, \n  CogIcon, \n  CheckCircleIcon,\n  ClockIcon,\n  CurrencyDollarIcon,\n  BuildingOfficeIcon,\n  LightBulbIcon,\n  ChartBarIcon,\n  ArrowPathIcon,\n  EyeIcon,\n  PencilIcon,\n  PlusIcon,\n  XMarkIcon\n} from '@heroicons/react/24/outline';\n\nconst ProposalEditor: React.FC = () => {\n  const { id } = useParams<{ id: string }>();\n  const navigate = useNavigate();\n  const [loading, setLoading] = useState(false);\n  const [generating, setGenerating] = useState(false);\n  const [showClientModal, setShowClientModal] = useState(false);\n  const [selectedClientId, setSelectedClientId] = useState<string | undefined>(undefined);\n  const [proposal, setProposal] = useState<any>({\n    title: '',\n    description: '',\n    clientName: '',\n    clientEmail: '',\n    type: 'PROPOSAL',\n    content: {\n      executiveSummary: '',\n      approach: '',\n      budgetDetails: '',\n      timeline: '',\n      budget: '',\n      fullProposal: '' // Added for unified editing\n    },\n    metadata: {\n      industry: '',\n      companySize: '',\n      projectScope: ''\n    }\n  });\n  const [accessRequests, setAccessRequests] = useState<any[]>([]);\n  const [grantingRequestId, setGrantingRequestId] = useState<string | null>(null);\n  const [previewMode, setPreviewMode] = useState(false);\n\n  const isNewProposal = !id;\n\n  // Debug log to verify access requests\n  console.log('ðŸ” Access requests state:', accessRequests);\n\n  useEffect(() => {\n    const fetchProposal = async () => {\n      try {\n        const { data } = await proposalsAPI.getById(id!);\n        // Ensure metadata exists with default values\n        const proposalData = {\n          ...data.data,\n          metadata: {\n            industry: '',\n            companySize: '',\n            projectScope: '',\n            ...data.data.metadata\n          },\n          content: {\n            executiveSummary: '',\n            approach: '',\n            budgetDetails: '',\n            timeline: '',\n            budget: '',\n            fullProposal: '',\n            ...data.data.content\n          }\n        };\n        setProposal(proposalData);\n        setSelectedClientId(data.data.clientId);\n      } catch (error) {\n        console.error('Failed to fetch proposal:', error);\n        toast.error('Failed to load proposal');\n      }\n    };\n\n    if (id) {\n      fetchProposal();\n    }\n  }, [id]);\n\n  useEffect(() => {\n    if (id) {\n      proposalsAPI.getAccessRequests(id)\n        .then(({ data }) => setAccessRequests(data.data))\n        .catch(() => setAccessRequests([]));\n    }\n  }, [id]);\n\n  const handleGenerateWithAI = async () => {\n    console.log('ðŸš€ handleGenerateWithAI function called!');\n    console.log('ðŸ” Environment check:', {\n      NODE_ENV: process.env.NODE_ENV,\n      REACT_APP_OPENROUTER_API_KEY: process.env.REACT_APP_OPENROUTER_API_KEY ? 'SET' : 'NOT SET'\n    });\n    \n    // Simple test to see if the function is working\n    console.log('ðŸ§ª Simple test - function is working!');\n    \n    // Test with a simple prompt first to see if the AI is working\n    console.log('ðŸ§ª Testing AI with simple prompt...');\n    try {\n      const testMessages = [\n        {\n          role: 'system',\n          content: 'You are a helpful assistant that writes detailed, specific content.'\n        },\n        {\n          role: 'user',\n          content: 'Write a short paragraph about web development services. Be specific and detailed, not generic.'\n        }\n      ];\n      \n      const testResponse = await getOpenRouterChatCompletion(testMessages);\n      console.log('ðŸ§ª Test response:', testResponse);\n    } catch (error) {\n      console.error('ðŸ§ª Test failed:', error);\n    }\n\n    // Validate required fields\n    // Validate required fields\n    console.log('ðŸ” Current proposal state:', {\n      clientName: proposal.clientName,\n      description: proposal.description,\n      hasClientName: !!proposal.clientName,\n      hasDescription: !!proposal.description\n    });\n    \n    if (!proposal.clientName || !proposal.description) {\n      const missingFields = [];\n      if (!proposal.clientName) missingFields.push('Client Name');\n      if (!proposal.description) missingFields.push('Description');\n      toast.error(`Please fill in: ${missingFields.join(' and ')} before generating content`);\n      return;\n    }\n\n    setGenerating(true);\n    try {\n      const messages = [\n        {\n          role: 'system',\n          content: 'You are an expert business proposal writer. Write detailed, specific content based on the project information provided. Never use generic placeholder text like \"Feature 1\" or \"Benefit 1\". Always provide concrete, actionable content.'\n        },\n        {\n          role: 'user',\n          content: `Write a professional business proposal for this project:\n\nClient: ${proposal.clientName}\nProject: ${proposal.description}\nBudget: ${proposal.budget || 'To be determined'}\nTimeline: ${proposal.timeline || 'To be determined'}\n\nCreate a detailed proposal with these sections:\n\n# Executive Summary\n[Write a compelling overview of the project and its value]\n\n# Project Overview  \n[Detailed analysis of requirements and objectives]\n\n# Our Approach\n[Step-by-step methodology and processes]\n\n# Project Deliverables\nCreate a detailed list of specific deliverables with descriptions and timelines. Format as:\n- **Deliverable Name**: Brief description. Timeline: X weeks/days\n\n# Project Timeline\nCreate a detailed timeline with specific phases, dates, and milestones. Format exactly as:\n1. **Phase Name** (YYYY-MM-DD)\n   Description of what will be completed in this phase.\n\n2. **Phase Name** (YYYY-MM-DD)\n   Description of what will be completed in this phase.\n\n3. **Phase Name** (YYYY-MM-DD)\n   Description of what will be completed in this phase.\n\nIMPORTANT: Each timeline item must be on a new line with the number, then the phase name in bold, then the date in parentheses, then the description on the next line.\n\n# Investment\n[Pricing and payment terms]\n\n# Why Choose Us\n[Experience and competitive advantages]\n\n# Next Steps\n[Clear action items and contact info]\n\nIMPORTANT: \n- Write specific, detailed content for each section based on the project description\n- Do not use generic text like \"Feature 1\"\n- Make it professional and compelling\n- Include realistic timelines and deliverables based on the project scope\n- Use specific dates and milestones for the timeline section`\n        }\n      ];\n\n      console.log('ðŸš€ Sending AI generation request with messages:', messages);\n      console.log('ðŸ”— About to call getOpenRouterChatCompletion...');\n      \n      const response = await getOpenRouterChatCompletion(messages);\n      \n      console.log('âœ… AI response received:', response);\n      \n      if (response && response.choices && response.choices[0] && response.choices[0].message) {\n        const aiContent = response.choices[0].message.content;\n        console.log('ðŸ“ AI generated content:', aiContent);\n        \n        const cleanContent = (content: string) => {\n          // Remove any markdown formatting that might interfere\n          return content\n            .replace(/```markdown/g, '')\n            .replace(/```/g, '')\n            .trim();\n        };\n\n        const cleanedContent = cleanContent(aiContent);\n        console.log('ðŸ§¹ Cleaned content:', cleanedContent);\n        \n        setProposal((prev: any) => ({\n          ...prev,\n          content: {\n            ...prev.content,\n            fullProposal: cleanedContent\n          }\n        }));\n        \n        toast.success('Proposal content generated successfully!');\n      } else {\n        console.error('âŒ Invalid response structure:', response);\n        toast.error('Invalid response from AI service');\n      }\n    } catch (error) {\n      console.error('Error generating content:', error);\n      toast.error('Failed to generate content. Please try again.');\n    } finally {\n      setGenerating(false);\n    }\n  };\n\n  const handleSave = async () => {\n    if (!proposal.title || !proposal.clientName || !proposal.description) {\n      toast.error('Please fill in all required fields');\n      return;\n    }\n\n    setLoading(true);\n    try {\n      if (isNewProposal) {\n        await proposalsAPI.create(proposal);\n        toast.success('Proposal saved as draft!');\n        navigate('/drafts');\n      } else {\n        await proposalsAPI.update(id, proposal);\n        toast.success('Proposal updated successfully!');\n      }\n    } catch (error) {\n      console.error('Error saving proposal:', error);\n      toast.error('Failed to save proposal');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSubmit = async () => {\n    if (!proposal.title || !proposal.clientName || !proposal.description) {\n      toast.error('Please fill in all required fields');\n      return;\n    }\n\n    setLoading(true);\n    try {\n      const updatedProposal = { ...proposal, status: 'SENT' };\n      if (isNewProposal) {\n        await proposalsAPI.create(updatedProposal);\n      } else {\n        await proposalsAPI.update(id, updatedProposal);\n      }\n      toast.success('Proposal submitted successfully!');\n      navigate('/sent-proposals');\n    } catch (error) {\n      console.error('Error submitting proposal:', error);\n      toast.error('Failed to submit proposal');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleClientSelect = (client: any) => {\n    setProposal((prev: any) => ({\n      ...prev,\n      clientName: client.name,\n      clientEmail: client.email\n    }));\n    setSelectedClientId(client.id);\n    setShowClientModal(false);\n  };\n\n  const handleClearClient = () => {\n    setProposal((prev: any) => ({\n      ...prev,\n      clientName: '',\n      clientEmail: ''\n    }));\n    setSelectedClientId(undefined);\n  };\n\n  const handleGrantAccess = async (requestId: string) => {\n    setGrantingRequestId(requestId);\n    try {\n      await proposalsAPI.grantAccessRequest(id!, requestId);\n      toast.success('Access granted and email sent!');\n      // Refresh access requests\n      const { data } = await proposalsAPI.getAccessRequests(id!);\n      setAccessRequests(data.data);\n    } catch (error) {\n      toast.error('Failed to grant access');\n    } finally {\n      setGrantingRequestId(null);\n    }\n  };\n\n  const handleRefineEntireProposal = async () => {\n    if (!proposal?.content?.fullProposal) {\n      toast.error('No content to refine. Please generate or add content first.');\n      return;\n    }\n\n    setGenerating(true);\n    try {\n      const messages = [\n        {\n          role: 'system',\n          content: `You are an expert proposal writer with 15+ years of experience in refining and improving business proposals. Your expertise includes:\n\n- Enhancing clarity and professional tone\n- Strengthening value propositions and benefits\n- Improving persuasive language and calls-to-action\n- Adding specific details and concrete examples\n- Ensuring industry-specific terminology and best practices\n- Maintaining professional structure while improving content quality\n\nWhen refining proposals, you focus on making the content more compelling, specific, and actionable while preserving the existing structure and key information.`\n        },\n        {\n          role: 'user',\n          content: `Please refine and improve the following proposal content. Make it more compelling, professional, and persuasive while maintaining the same structure and sections.\n\nCURRENT PROPOSAL CONTENT:\n${proposal.content.fullProposal}\n\nPlease enhance the following aspects:\n1. Clarity and readability - Make the content easier to understand\n2. Professional tone - Ensure it sounds authoritative and trustworthy\n3. Persuasive language - Strengthen the value proposition and benefits\n4. Specific details - Add concrete examples, metrics, and actionable items\n5. Call-to-action - Make the next steps clear and compelling\n\nIMPORTANT GUIDELINES:\n- Maintain the existing structure and sections\n- Keep all key information and client details\n- Add specific, relevant details where appropriate\n- Avoid generic placeholder text\n- Make the content more engaging and professional\n- Ensure each section provides clear value and next steps\n\nReturn the improved version with enhanced content while maintaining the same overall structure.`\n        }\n      ];\n\n      const response = await getOpenRouterChatCompletion(messages);\n      \n      if (response && response.choices && response.choices[0] && response.choices[0].message) {\n        setProposal((prev: any) => ({\n          ...prev,\n          content: {\n            ...prev.content,\n            fullProposal: response.choices[0].message.content.trim()\n          }\n        }));\n        \n        toast.success('Proposal refined successfully!');\n      }\n    } catch (error) {\n      console.error('Error refining content:', error);\n      toast.error('Failed to refine content. Please try again.');\n    } finally {\n      setGenerating(false);\n    }\n  };\n\n  const handleFormatProposal = () => {\n    if (!proposal?.content?.fullProposal) {\n      toast.error('No content to format. Please add content first.');\n      return;\n    }\n\n    const content = proposal.content.fullProposal;\n    const formattedContent = content\n      .replace(/([A-Z][a-z]+:)/g, '\\n## $1') // Add markdown headers\n      .replace(/(\\d+\\.\\s)/g, '\\n$1') // Add line breaks before numbered lists\n      .replace(/(â€¢\\s)/g, '\\n$1') // Add line breaks before bullet points\n      .trim();\n\n    setProposal((prev: any) => ({\n      ...prev,\n      content: {\n        ...prev.content,\n        fullProposal: formattedContent\n      }\n    }));\n\n    toast.success('Proposal formatted successfully!');\n  };\n\n  const getCombinedProposalContent = () => {\n    const sections = [];\n    if (proposal?.content?.executiveSummary) sections.push(`# Executive Summary\\n${proposal.content.executiveSummary}`);\n    if (proposal?.content?.approach) sections.push(`# Approach\\n${proposal.content.approach}`);\n    if (proposal?.content?.budgetDetails) sections.push(`# Budget Details\\n${proposal.content.budgetDetails}`);\n    if (proposal?.content?.timeline) sections.push(`# Timeline\\n${proposal.content.timeline}`);\n    return sections.join('\\n\\n');\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-50\">\n      {/* Header */}\n      <div className=\"bg-white border-b border-gray-200 px-6 py-4\">\n        <div className=\"max-w-7xl mx-auto flex items-center justify-between\">\n          <div className=\"flex items-center gap-4\">\n            <div className=\"w-10 h-10 bg-gradient-to-r from-primary-600 to-primary-700 rounded-xl flex items-center justify-center shadow-lg\">\n              <DocumentTextIcon className=\"w-5 h-5 text-white\" />\n            </div>\n            <div>\n              <h1 className=\"text-2xl font-bold text-gray-900\">\n                {isNewProposal ? 'Create New Proposal' : 'Edit Proposal'}\n              </h1>\n              <p className=\"text-sm text-gray-600\">\n                {isNewProposal ? 'Build a compelling proposal from scratch' : 'Refine and perfect your proposal'}\n              </p>\n            </div>\n          </div>\n          <div className=\"flex items-center gap-3\">\n            <button\n              onClick={handleSave}\n              disabled={loading}\n              className=\"btn-secondary flex items-center gap-2\"\n            >\n              <PencilIcon className=\"w-4 h-4\" />\n              Save Draft\n            </button>\n            <button\n              onClick={handleSubmit}\n              disabled={loading}\n              className=\"btn-primary flex items-center gap-2\"\n            >\n              <CheckCircleIcon className=\"w-4 h-4\" />\n              Submit Proposal\n            </button>\n          </div>\n        </div>\n      </div>\n\n      {/* Main Content */}\n      <div className=\"max-w-7xl mx-auto px-6 py-8\">\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n          {/* Left Panel - Form */}\n          <div className=\"lg:col-span-1\">\n            <div className=\"bg-white rounded-2xl shadow-sm border border-gray-200 p-6 sticky top-8\">\n              <div className=\"flex items-center gap-3 mb-6\">\n                <div className=\"w-8 h-8 bg-gradient-to-r from-blue-100 to-blue-200 rounded-lg flex items-center justify-center\">\n                  <CogIcon className=\"w-4 h-4 text-blue-600\" />\n                </div>\n                <h2 className=\"text-xl font-bold text-gray-900\">Proposal Details</h2>\n              </div>\n\n              <form className=\"space-y-6\">\n                {/* Proposal Title */}\n                <div className=\"space-y-2\">\n                  <label className=\"block text-sm font-semibold text-gray-700\">\n                    Proposal Title <span className=\"text-red-500\">*</span>\n                  </label>\n                  <input\n                    type=\"text\"\n                    value={proposal?.title || ''}\n                    onChange={(e) => setProposal({ ...proposal, title: e.target.value })}\n                    className=\"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 bg-gray-50 hover:bg-white\"\n                    placeholder=\"Enter proposal title\"\n                  />\n                </div>\n\n                {/* Client Selection */}\n                <div className=\"space-y-2\">\n                  <label className=\"block text-sm font-semibold text-gray-700\">\n                    Client <span className=\"text-red-500\">*</span>\n                  </label>\n                  <div className=\"space-y-3\">\n                    <div className=\"flex gap-2\">\n                      <input\n                        type=\"text\"\n                        value={proposal?.clientName || ''}\n                        onChange={(e) => setProposal({ ...proposal, clientName: e.target.value })}\n                        className=\"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 bg-gray-50 hover:bg-white\"\n                        placeholder=\"Enter client name\"\n                      />\n                      <button\n                        type=\"button\"\n                        onClick={() => setShowClientModal(true)}\n                        className={`px-4 py-3 rounded-xl transition-all duration-200 flex items-center gap-2 whitespace-nowrap font-medium ${\n                          selectedClientId \n                            ? 'bg-green-600 text-white hover:bg-green-700 shadow-md' \n                            : 'bg-primary-600 text-white hover:bg-primary-700 shadow-md'\n                        }`}\n                      >\n                        <UserIcon className=\"w-4 h-4\" />\n                        {selectedClientId ? 'Change' : 'Select'}\n                      </button>\n                    </div>\n                    \n                    {selectedClientId && (\n                      <div className=\"p-3 bg-green-50 border border-green-200 rounded-xl\">\n                        <div className=\"flex items-center justify-between\">\n                          <div className=\"flex items-center gap-2 text-sm text-green-800\">\n                            <CheckCircleIcon className=\"w-4 h-4\" />\n                            Client selected from database\n                          </div>\n                          <button\n                            type=\"button\"\n                            onClick={handleClearClient}\n                            className=\"text-red-600 hover:text-red-800 text-sm font-medium\"\n                          >\n                            Clear\n                          </button>\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                </div>\n\n                {/* Project Description */}\n                <div className=\"space-y-2\">\n                  <label className=\"block text-sm font-semibold text-gray-700\">\n                    Project Description <span className=\"text-red-500\">*</span>\n                  </label>\n                  <textarea\n                    value={proposal?.description || ''}\n                    onChange={(e) => setProposal({ ...proposal, description: e.target.value })}\n                    rows={4}\n                    className=\"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 bg-gray-50 hover:bg-white resize-none\"\n                    placeholder=\"Describe the project, requirements, and objectives...\"\n                  />\n                </div>\n\n                {/* Budget & Timeline */}\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <label className=\"block text-sm font-semibold text-gray-700\">\n                      Budget\n                    </label>\n                    <div className=\"relative\">\n                      <CurrencyDollarIcon className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\" />\n                      <input\n                        type=\"text\"\n                        value={proposal?.budget || ''}\n                        onChange={(e) => setProposal({ ...proposal, budget: e.target.value })}\n                        className=\"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 bg-gray-50 hover:bg-white\"\n                        placeholder=\"e.g. $50,000\"\n                      />\n                    </div>\n                  </div>\n                  \n                  <div className=\"space-y-2\">\n                    <label className=\"block text-sm font-semibold text-gray-700\">\n                      Timeline\n                    </label>\n                    <div className=\"relative\">\n                      <ClockIcon className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\" />\n                      <input\n                        type=\"text\"\n                        value={proposal?.timeline || ''}\n                        onChange={(e) => setProposal({ ...proposal, timeline: e.target.value })}\n                        className=\"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 bg-gray-50 hover:bg-white\"\n                        placeholder=\"e.g. 2 months\"\n                      />\n                    </div>\n                  </div>\n                </div>\n\n                {/* AI Generation Button */}\n                <button\n                  type=\"button\"\n                  onClick={() => {\n                    console.log('ðŸ”˜ Button clicked!');\n                    console.log('ðŸ“Š Current state:', {\n                      generating,\n                      loading,\n                      clientName: proposal?.clientName,\n                      description: proposal?.description,\n                      isDisabled: generating || loading || !proposal?.clientName || !proposal?.description\n                    });\n                    handleGenerateWithAI();\n                  }}\n                  disabled={generating || loading || !proposal?.clientName || !proposal?.description}\n                  className={`w-full py-4 px-6 rounded-xl font-semibold text-white transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-offset-2 shadow-lg ${\n                    generating || loading || !proposal?.clientName || !proposal?.description\n                      ? 'bg-gray-400 cursor-not-allowed'\n                      : 'bg-gradient-to-r from-primary-600 to-purple-600 hover:from-primary-700 hover:to-purple-700 focus:ring-primary-500'\n                  }`}\n                >\n                  {generating ? (\n                    <div className=\"flex items-center justify-center\">\n                      <ArrowPathIcon className=\"animate-spin -ml-1 mr-3 h-5 w-5 text-white\" />\n                      Generating Content...\n                    </div>\n                  ) : (\n                    <div className=\"flex items-center justify-center\">\n                      <SparklesIcon className=\"w-5 h-5 mr-2\" />\n                      Generate AI Content\n                    </div>\n                  )}\n                </button>\n                \n                {(!proposal?.clientName || !proposal?.description) && (\n                  <p className=\"text-sm text-gray-500 text-center\">\n                    Enter client name and description to enable AI generation\n                  </p>\n                )}\n              </form>\n            </div>\n          </div>\n\n          {/* Right Panel - Content Editor */}\n          <div className=\"lg:col-span-2\">\n            <div className=\"bg-white rounded-2xl shadow-sm border border-gray-200 p-6\">\n              <div className=\"flex items-center justify-between mb-6\">\n                <div>\n                  <h2 className=\"text-xl font-bold text-gray-900 mb-1\">Proposal Content</h2>\n                  <p className=\"text-gray-600\">Review, edit, and refine your proposal content</p>\n                </div>\n                <div className=\"flex items-center gap-3\">\n                  <button\n                    onClick={() => setPreviewMode(!previewMode)}\n                    className=\"btn-secondary flex items-center gap-2\"\n                  >\n                    {previewMode ? <PencilIcon className=\"w-4 h-4\" /> : <EyeIcon className=\"w-4 h-4\" />}\n                    {previewMode ? 'Edit Mode' : 'Preview Mode'}\n                  </button>\n                  <button\n                    onClick={() => handleRefineEntireProposal()}\n                    disabled={generating || !proposal?.content?.fullProposal}\n                    className=\"btn-primary flex items-center gap-2\"\n                  >\n                    <SparklesIcon className=\"w-4 h-4\" />\n                    Refine with AI\n                  </button>\n                  <button \n                    onClick={() => handleFormatProposal()}\n                    disabled={!proposal?.content?.fullProposal}\n                    className=\"btn-secondary flex items-center gap-2\"\n                  >\n                    <CogIcon className=\"w-4 h-4\" />\n                    Format\n                  </button>\n                </div>\n              </div>\n\n              {/* Content Editor */}\n              <div className=\"space-y-4\">\n                <div className=\"flex items-center gap-4 text-sm text-gray-600 p-3 bg-gray-50 rounded-xl\">\n                  <div className=\"flex items-center gap-2\">\n                    <EyeIcon className=\"w-4 h-4\" />\n                    Edit the entire proposal content below\n                  </div>\n                  <div className=\"flex items-center gap-2\">\n                    <SparklesIcon className=\"w-4 h-4\" />\n                    Use \"Refine with AI\" to improve the entire document\n                  </div>\n                </div>\n\n                {previewMode ? (\n                  <div className=\"w-full px-4 py-3 border border-gray-300 rounded-xl bg-white min-h-[600px] overflow-y-auto\">\n                    <div className=\"proposal-content\">\n                      <ReactMarkdown>{proposal?.content?.fullProposal || getCombinedProposalContent()}</ReactMarkdown>\n                    </div>\n                  </div>\n                ) : (\n                  <textarea\n                    value={proposal?.content?.fullProposal || getCombinedProposalContent()}\n                    onChange={(e) => setProposal({ \n                      ...proposal, \n                      content: { \n                        ...proposal?.content, \n                        fullProposal: e.target.value \n                      } \n                    })}\n                    rows={25}\n                    className=\"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none transition-all duration-200 bg-gray-50 font-mono text-sm leading-relaxed hover:bg-white\"\n                    placeholder=\"Enter your complete proposal content here...\n\n# Executive Summary\n[Your executive summary goes here]\n\n# Project Overview\n[Detailed analysis of requirements and objectives]\n\n# Our Approach\n[Step-by-step methodology and processes]\n\n# Project Deliverables\n- **Deliverable Name**: Brief description. Timeline: X weeks/days\n\n# Project Timeline\n1. **Phase Name** (YYYY-MM-DD)\n   Description of what will be completed in this phase.\n\n# Investment\n[Pricing and payment terms]\n\n# Why Choose Us\n[Experience and competitive advantages]\n\n# Next Steps\n[Clear action items and contact info]\"\n                  />\n                )}\n                \n                <div className=\"flex items-center justify-between text-xs text-gray-500 p-3 bg-gray-50 rounded-lg\">\n                  <span>Word count: {proposal?.content?.fullProposal?.split(/\\s+/).length || 0} words</span>\n                  <span>Characters: {proposal?.content?.fullProposal?.length || 0}</span>\n                </div>\n              </div>\n\n              {/* Success Message */}\n              {proposal?.content?.fullProposal && (\n                <div className=\"mt-6 bg-green-50 border border-green-200 rounded-xl p-4\">\n                  <div className=\"flex items-center gap-2 text-green-800\">\n                    <CheckCircleIcon className=\"w-5 h-5\" />\n                    <span className=\"font-medium\">Content Ready!</span>\n                  </div>\n                  <p className=\"text-green-700 text-sm mt-1\">\n                    Review and edit the content above. Use \"Refine with AI\" to improve the entire document or \"Format\" to structure it properly.\n                  </p>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n      \n      {/* Client Selection Modal */}\n      <ClientSelectionModal\n        isOpen={showClientModal}\n        onClose={() => setShowClientModal(false)}\n        onSelectClient={handleClientSelect}\n        selectedClientId={selectedClientId}\n      />\n    </div>\n  );\n};\n\nexport default ProposalEditor; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}