{"ast":null,"code":"var _jsxFileName = \"/Users/davnishsingh/Documents/proposalai-main/proposalai/client/src/pages/ProposalEditor.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { toast } from 'react-hot-toast';\nimport { proposalsAPI, getOpenRouterChatCompletion } from '../services/api';\nimport ClientSelectionModal from '../components/ClientSelectionModal';\nimport { DocumentTextIcon, UserIcon, SparklesIcon, CogIcon, CheckCircleIcon, ClockIcon, CurrencyDollarIcon, ArrowPathIcon, EyeIcon, PencilIcon } from '@heroicons/react/24/outline';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ProposalEditor = () => {\n  _s();\n  var _proposal$content7, _proposal$content8, _proposal$content9, _proposal$content0, _proposal$content0$fu, _proposal$content1, _proposal$content1$fu, _proposal$content10;\n  const {\n    id\n  } = useParams();\n  const navigate = useNavigate();\n  const [loading, setLoading] = useState(false);\n  const [generating, setGenerating] = useState(false);\n  const [showClientModal, setShowClientModal] = useState(false);\n  const [selectedClientId, setSelectedClientId] = useState(undefined);\n  const [proposal, setProposal] = useState({\n    title: '',\n    description: '',\n    clientName: '',\n    clientEmail: '',\n    type: 'PROPOSAL',\n    content: {\n      executiveSummary: '',\n      approach: '',\n      budgetDetails: '',\n      timeline: '',\n      budget: '',\n      fullProposal: '' // Added for unified editing\n    },\n    metadata: {\n      industry: '',\n      companySize: '',\n      projectScope: ''\n    }\n  });\n  const [accessRequests, setAccessRequests] = useState([]);\n  const [grantingRequestId, setGrantingRequestId] = useState(null);\n  const isNewProposal = !id;\n\n  // Debug log to verify access requests\n  console.log('ðŸ” Access requests state:', accessRequests);\n  useEffect(() => {\n    const fetchProposal = async () => {\n      try {\n        const {\n          data\n        } = await proposalsAPI.getById(id);\n        // Ensure metadata exists with default values\n        const proposalData = {\n          ...data.data,\n          metadata: {\n            industry: '',\n            companySize: '',\n            projectScope: '',\n            ...data.data.metadata\n          },\n          content: {\n            executiveSummary: '',\n            approach: '',\n            budgetDetails: '',\n            timeline: '',\n            budget: '',\n            fullProposal: '',\n            ...data.data.content\n          }\n        };\n        setProposal(proposalData);\n        setSelectedClientId(data.data.clientId);\n      } catch (error) {\n        console.error('Failed to fetch proposal:', error);\n        toast.error('Failed to load proposal');\n      }\n    };\n    if (id) {\n      fetchProposal();\n    }\n  }, [id]);\n  useEffect(() => {\n    if (id) {\n      proposalsAPI.getAccessRequests(id).then(({\n        data\n      }) => setAccessRequests(data.data)).catch(() => setAccessRequests([]));\n    }\n  }, [id]);\n  const handleGenerateWithAI = async () => {\n    // Validate required fields\n    console.log('ðŸ” Current proposal state:', {\n      clientName: proposal.clientName,\n      description: proposal.description,\n      hasClientName: !!proposal.clientName,\n      hasDescription: !!proposal.description\n    });\n    if (!proposal.clientName || !proposal.description) {\n      const missingFields = [];\n      if (!proposal.clientName) missingFields.push('Client Name');\n      if (!proposal.description) missingFields.push('Description');\n      toast.error(`Please fill in: ${missingFields.join(' and ')} before generating content`);\n      return;\n    }\n    setGenerating(true);\n    try {\n      const messages = [{\n        role: 'system',\n        content: 'You are an expert proposal writer. Generate a detailed, professional proposal for the following client and project. Structure your response with clear sections: Executive Summary, Project Overview, Our Approach & Methodology, Detailed Scope of Work, Timeline & Milestones, Investment & Pricing, Why Choose Us, and Next Steps. Use clear, persuasive language and make each section comprehensive.'\n      }, {\n        role: 'user',\n        content: `Create a comprehensive, professional proposal for the following project:\n\nClient: ${proposal.clientName}\nProject Description: ${proposal.description}\nBudget: ${proposal.budget || 'To be determined'}\nTimeline: ${proposal.timeline || 'To be determined'}\n\nPlease structure the proposal with the following sections:\n1. Executive Summary\n2. Project Overview\n3. Our Approach & Methodology\n4. Detailed Scope of Work\n5. Timeline & Milestones\n6. Investment & Pricing\n7. Why Choose Us\n8. Next Steps\n\nMake it compelling, professional, and tailored to the client's needs. Use clear headings and bullet points where appropriate.`\n      }];\n      const response = await getOpenRouterChatCompletion(messages);\n      if (response && response.choices && response.choices[0] && response.choices[0].message) {\n        const cleanContent = content => {\n          // Remove any markdown formatting that might interfere\n          return content.replace(/```markdown/g, '').replace(/```/g, '').trim();\n        };\n        const cleanedContent = cleanContent(response.choices[0].message.content);\n        setProposal(prev => ({\n          ...prev,\n          content: {\n            ...prev.content,\n            fullProposal: cleanedContent\n          }\n        }));\n        toast.success('Proposal content generated successfully!');\n      }\n    } catch (error) {\n      console.error('Error generating content:', error);\n      toast.error('Failed to generate content. Please try again.');\n    } finally {\n      setGenerating(false);\n    }\n  };\n  const handleSave = async () => {\n    if (!proposal.title || !proposal.clientName || !proposal.description) {\n      toast.error('Please fill in all required fields');\n      return;\n    }\n    setLoading(true);\n    try {\n      if (isNewProposal) {\n        await proposalsAPI.create(proposal);\n        toast.success('Proposal saved as draft!');\n        navigate('/drafts');\n      } else {\n        await proposalsAPI.update(id, proposal);\n        toast.success('Proposal updated successfully!');\n      }\n    } catch (error) {\n      console.error('Error saving proposal:', error);\n      toast.error('Failed to save proposal');\n    } finally {\n      setLoading(false);\n    }\n  };\n  const handleSubmit = async () => {\n    if (!proposal.title || !proposal.clientName || !proposal.description) {\n      toast.error('Please fill in all required fields');\n      return;\n    }\n    setLoading(true);\n    try {\n      const updatedProposal = {\n        ...proposal,\n        status: 'SENT'\n      };\n      if (isNewProposal) {\n        await proposalsAPI.create(updatedProposal);\n      } else {\n        await proposalsAPI.update(id, updatedProposal);\n      }\n      toast.success('Proposal submitted successfully!');\n      navigate('/sent-proposals');\n    } catch (error) {\n      console.error('Error submitting proposal:', error);\n      toast.error('Failed to submit proposal');\n    } finally {\n      setLoading(false);\n    }\n  };\n  const handleClientSelect = client => {\n    setProposal(prev => ({\n      ...prev,\n      clientName: client.name,\n      clientEmail: client.email\n    }));\n    setSelectedClientId(client.id);\n    setShowClientModal(false);\n  };\n  const handleClearClient = () => {\n    setProposal(prev => ({\n      ...prev,\n      clientName: '',\n      clientEmail: ''\n    }));\n    setSelectedClientId(undefined);\n  };\n  const handleGrantAccess = async requestId => {\n    setGrantingRequestId(requestId);\n    try {\n      await proposalsAPI.grantAccessRequest(id, requestId);\n      toast.success('Access granted and email sent!');\n      // Refresh access requests\n      const {\n        data\n      } = await proposalsAPI.getAccessRequests(id);\n      setAccessRequests(data.data);\n    } catch (error) {\n      toast.error('Failed to grant access');\n    } finally {\n      setGrantingRequestId(null);\n    }\n  };\n  const handleRefineEntireProposal = async () => {\n    var _proposal$content;\n    if (!(proposal !== null && proposal !== void 0 && (_proposal$content = proposal.content) !== null && _proposal$content !== void 0 && _proposal$content.fullProposal)) {\n      toast.error('No content to refine. Please generate or add content first.');\n      return;\n    }\n    setGenerating(true);\n    try {\n      const messages = [{\n        role: 'system',\n        content: 'You are an expert proposal writer. Refine the entire proposal content. Make it more detailed, persuasive, and comprehensive while maintaining the same structure.'\n      }, {\n        role: 'user',\n        content: `Please refine and improve the following proposal content. Make it more compelling, professional, and persuasive while maintaining the same structure:\n\n${proposal.content.fullProposal}\n\nPlease enhance:\n1. Clarity and readability\n2. Professional tone\n3. Persuasive language\n4. Value proposition\n5. Call-to-action\n\nReturn the improved version with the same structure.`\n      }];\n      const response = await getOpenRouterChatCompletion(messages);\n      if (response && response.choices && response.choices[0] && response.choices[0].message) {\n        setProposal(prev => ({\n          ...prev,\n          content: {\n            ...prev.content,\n            fullProposal: response.choices[0].message.content.trim()\n          }\n        }));\n        toast.success('Proposal refined successfully!');\n      }\n    } catch (error) {\n      console.error('Error refining content:', error);\n      toast.error('Failed to refine content. Please try again.');\n    } finally {\n      setGenerating(false);\n    }\n  };\n  const handleFormatProposal = () => {\n    var _proposal$content2;\n    if (!(proposal !== null && proposal !== void 0 && (_proposal$content2 = proposal.content) !== null && _proposal$content2 !== void 0 && _proposal$content2.fullProposal)) {\n      toast.error('No content to format. Please add content first.');\n      return;\n    }\n    const content = proposal.content.fullProposal;\n    const formattedContent = content.replace(/([A-Z][a-z]+:)/g, '\\n## $1') // Add markdown headers\n    .replace(/(\\d+\\.\\s)/g, '\\n$1') // Add line breaks before numbered lists\n    .replace(/(â€¢\\s)/g, '\\n$1') // Add line breaks before bullet points\n    .trim();\n    setProposal(prev => ({\n      ...prev,\n      content: {\n        ...prev.content,\n        fullProposal: formattedContent\n      }\n    }));\n    toast.success('Proposal formatted successfully!');\n  };\n  const getCombinedProposalContent = () => {\n    var _proposal$content3, _proposal$content4, _proposal$content5, _proposal$content6;\n    const sections = [];\n    if (proposal !== null && proposal !== void 0 && (_proposal$content3 = proposal.content) !== null && _proposal$content3 !== void 0 && _proposal$content3.executiveSummary) sections.push(`# Executive Summary\\n${proposal.content.executiveSummary}`);\n    if (proposal !== null && proposal !== void 0 && (_proposal$content4 = proposal.content) !== null && _proposal$content4 !== void 0 && _proposal$content4.approach) sections.push(`# Approach\\n${proposal.content.approach}`);\n    if (proposal !== null && proposal !== void 0 && (_proposal$content5 = proposal.content) !== null && _proposal$content5 !== void 0 && _proposal$content5.budgetDetails) sections.push(`# Budget Details\\n${proposal.content.budgetDetails}`);\n    if (proposal !== null && proposal !== void 0 && (_proposal$content6 = proposal.content) !== null && _proposal$content6 !== void 0 && _proposal$content6.timeline) sections.push(`# Timeline\\n${proposal.content.timeline}`);\n    return sections.join('\\n\\n');\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-50\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white border-b border-gray-200 px-6 py-4\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"max-w-7xl mx-auto flex items-center justify-between\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center gap-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-10 h-10 bg-gradient-to-r from-primary-600 to-primary-700 rounded-xl flex items-center justify-center shadow-lg\",\n            children: /*#__PURE__*/_jsxDEV(DocumentTextIcon, {\n              className: \"w-5 h-5 text-white\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 354,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 353,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n              className: \"text-2xl font-bold text-gray-900\",\n              children: isNewProposal ? 'Create New Proposal' : 'Edit Proposal'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 357,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm text-gray-600\",\n              children: isNewProposal ? 'Build a compelling proposal from scratch' : 'Refine and perfect your proposal'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 360,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 356,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 352,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center gap-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleSave,\n            disabled: loading,\n            className: \"btn-secondary flex items-center gap-2\",\n            children: [/*#__PURE__*/_jsxDEV(PencilIcon, {\n              className: \"w-4 h-4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 371,\n              columnNumber: 15\n            }, this), \"Save Draft\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 366,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleSubmit,\n            disabled: loading,\n            className: \"btn-primary flex items-center gap-2\",\n            children: [/*#__PURE__*/_jsxDEV(CheckCircleIcon, {\n              className: \"w-4 h-4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 379,\n              columnNumber: 15\n            }, this), \"Submit Proposal\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 374,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 365,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 351,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 350,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"max-w-7xl mx-auto px-6 py-8\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-1 lg:grid-cols-3 gap-8\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lg:col-span-1\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-white rounded-2xl shadow-sm border border-gray-200 p-6 sticky top-8\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center gap-3 mb-6\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"w-8 h-8 bg-gradient-to-r from-blue-100 to-blue-200 rounded-lg flex items-center justify-center\",\n                children: /*#__PURE__*/_jsxDEV(CogIcon, {\n                  className: \"w-4 h-4 text-blue-600\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 394,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 393,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n                className: \"text-xl font-bold text-gray-900\",\n                children: \"Proposal Details\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 396,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 392,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n              className: \"space-y-6\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"space-y-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"block text-sm font-semibold text-gray-700\",\n                  children: [\"Proposal Title \", /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-red-500\",\n                    children: \"*\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 403,\n                    columnNumber: 36\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 402,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"text\",\n                  value: (proposal === null || proposal === void 0 ? void 0 : proposal.title) || '',\n                  onChange: e => setProposal({\n                    ...proposal,\n                    title: e.target.value\n                  }),\n                  className: \"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 bg-gray-50 hover:bg-white\",\n                  placeholder: \"Enter proposal title\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 405,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 401,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"space-y-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"block text-sm font-semibold text-gray-700\",\n                  children: [\"Client \", /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-red-500\",\n                    children: \"*\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 417,\n                    columnNumber: 28\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 416,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"space-y-3\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex gap-2\",\n                    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"text\",\n                      value: (proposal === null || proposal === void 0 ? void 0 : proposal.clientName) || '',\n                      onChange: e => setProposal({\n                        ...proposal,\n                        clientName: e.target.value\n                      }),\n                      className: \"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 bg-gray-50 hover:bg-white\",\n                      placeholder: \"Enter client name\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 421,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                      type: \"button\",\n                      onClick: () => setShowClientModal(true),\n                      className: `px-4 py-3 rounded-xl transition-all duration-200 flex items-center gap-2 whitespace-nowrap font-medium ${selectedClientId ? 'bg-green-600 text-white hover:bg-green-700 shadow-md' : 'bg-primary-600 text-white hover:bg-primary-700 shadow-md'}`,\n                      children: [/*#__PURE__*/_jsxDEV(UserIcon, {\n                        className: \"w-4 h-4\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 437,\n                        columnNumber: 25\n                      }, this), selectedClientId ? 'Change' : 'Select']\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 428,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 420,\n                    columnNumber: 21\n                  }, this), selectedClientId && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"p-3 bg-green-50 border border-green-200 rounded-xl\",\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"flex items-center justify-between\",\n                      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"flex items-center gap-2 text-sm text-green-800\",\n                        children: [/*#__PURE__*/_jsxDEV(CheckCircleIcon, {\n                          className: \"w-4 h-4\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 446,\n                          columnNumber: 29\n                        }, this), \"Client selected from database\"]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 445,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                        type: \"button\",\n                        onClick: handleClearClient,\n                        className: \"text-red-600 hover:text-red-800 text-sm font-medium\",\n                        children: \"Clear\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 449,\n                        columnNumber: 27\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 444,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 443,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 419,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 415,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"space-y-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"block text-sm font-semibold text-gray-700\",\n                  children: [\"Project Description \", /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-red-500\",\n                    children: \"*\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 465,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 464,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n                  value: (proposal === null || proposal === void 0 ? void 0 : proposal.description) || '',\n                  onChange: e => setProposal({\n                    ...proposal,\n                    description: e.target.value\n                  }),\n                  rows: 4,\n                  className: \"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 bg-gray-50 hover:bg-white resize-none\",\n                  placeholder: \"Describe the project, requirements, and objectives...\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 467,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 463,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"grid grid-cols-2 gap-4\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"space-y-2\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    className: \"block text-sm font-semibold text-gray-700\",\n                    children: \"Budget\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 479,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"relative\",\n                    children: [/*#__PURE__*/_jsxDEV(CurrencyDollarIcon, {\n                      className: \"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 483,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"text\",\n                      value: (proposal === null || proposal === void 0 ? void 0 : proposal.budget) || '',\n                      onChange: e => setProposal({\n                        ...proposal,\n                        budget: e.target.value\n                      }),\n                      className: \"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 bg-gray-50 hover:bg-white\",\n                      placeholder: \"e.g. $50,000\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 484,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 482,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 478,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"space-y-2\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    className: \"block text-sm font-semibold text-gray-700\",\n                    children: \"Timeline\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 495,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"relative\",\n                    children: [/*#__PURE__*/_jsxDEV(ClockIcon, {\n                      className: \"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 499,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"text\",\n                      value: (proposal === null || proposal === void 0 ? void 0 : proposal.timeline) || '',\n                      onChange: e => setProposal({\n                        ...proposal,\n                        timeline: e.target.value\n                      }),\n                      className: \"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 bg-gray-50 hover:bg-white\",\n                      placeholder: \"e.g. 2 months\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 500,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 498,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 494,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 477,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                onClick: handleGenerateWithAI,\n                disabled: generating || loading || !(proposal !== null && proposal !== void 0 && proposal.clientName) || !(proposal !== null && proposal !== void 0 && proposal.description),\n                className: `w-full py-4 px-6 rounded-xl font-semibold text-white transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-offset-2 shadow-lg ${generating || loading || !(proposal !== null && proposal !== void 0 && proposal.clientName) || !(proposal !== null && proposal !== void 0 && proposal.description) ? 'bg-gray-400 cursor-not-allowed' : 'bg-gradient-to-r from-primary-600 to-purple-600 hover:from-primary-700 hover:to-purple-700 focus:ring-primary-500'}`,\n                children: generating ? /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center justify-center\",\n                  children: [/*#__PURE__*/_jsxDEV(ArrowPathIcon, {\n                    className: \"animate-spin -ml-1 mr-3 h-5 w-5 text-white\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 524,\n                    columnNumber: 23\n                  }, this), \"Generating Content...\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 523,\n                  columnNumber: 21\n                }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center justify-center\",\n                  children: [/*#__PURE__*/_jsxDEV(SparklesIcon, {\n                    className: \"w-5 h-5 mr-2\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 529,\n                    columnNumber: 23\n                  }, this), \"Generate AI Content\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 528,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 512,\n                columnNumber: 17\n              }, this), (!(proposal !== null && proposal !== void 0 && proposal.clientName) || !(proposal !== null && proposal !== void 0 && proposal.description)) && /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-sm text-gray-500 text-center\",\n                children: \"Enter client name and description to enable AI generation\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 536,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 399,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 391,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 390,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lg:col-span-2\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-white rounded-2xl shadow-sm border border-gray-200 p-6\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center justify-between mb-6\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                  className: \"text-xl font-bold text-gray-900 mb-1\",\n                  children: \"Proposal Content\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 549,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-gray-600\",\n                  children: \"Review, edit, and refine your proposal content\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 550,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 548,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center gap-3\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => handleRefineEntireProposal(),\n                  disabled: generating || !(proposal !== null && proposal !== void 0 && (_proposal$content7 = proposal.content) !== null && _proposal$content7 !== void 0 && _proposal$content7.fullProposal),\n                  className: \"btn-primary flex items-center gap-2\",\n                  children: [/*#__PURE__*/_jsxDEV(SparklesIcon, {\n                    className: \"w-4 h-4\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 558,\n                    columnNumber: 21\n                  }, this), \"Refine with AI\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 553,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => handleFormatProposal(),\n                  disabled: !(proposal !== null && proposal !== void 0 && (_proposal$content8 = proposal.content) !== null && _proposal$content8 !== void 0 && _proposal$content8.fullProposal),\n                  className: \"btn-secondary flex items-center gap-2\",\n                  children: [/*#__PURE__*/_jsxDEV(CogIcon, {\n                    className: \"w-4 h-4\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 566,\n                    columnNumber: 21\n                  }, this), \"Format\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 561,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 552,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 547,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"space-y-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center gap-4 text-sm text-gray-600 p-3 bg-gray-50 rounded-xl\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center gap-2\",\n                  children: [/*#__PURE__*/_jsxDEV(EyeIcon, {\n                    className: \"w-4 h-4\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 576,\n                    columnNumber: 21\n                  }, this), \"Edit the entire proposal content below\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 575,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center gap-2\",\n                  children: [/*#__PURE__*/_jsxDEV(SparklesIcon, {\n                    className: \"w-4 h-4\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 580,\n                    columnNumber: 21\n                  }, this), \"Use \\\"Refine with AI\\\" to improve the entire document\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 579,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 574,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n                value: (proposal === null || proposal === void 0 ? void 0 : (_proposal$content9 = proposal.content) === null || _proposal$content9 === void 0 ? void 0 : _proposal$content9.fullProposal) || getCombinedProposalContent(),\n                onChange: e => setProposal({\n                  ...proposal,\n                  content: {\n                    ...(proposal === null || proposal === void 0 ? void 0 : proposal.content),\n                    fullProposal: e.target.value\n                  }\n                }),\n                rows: 25,\n                className: \"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none transition-all duration-200 bg-gray-50 font-mono text-sm leading-relaxed hover:bg-white\",\n                placeholder: \"Enter your complete proposal content here... # Executive Summary\\n[Your executive summary goes here] # Approach\\n[Your approach and methodology] # Budget Details\\n[Detailed budget breakdown] # Timeline\\n[Project timeline and milestones] # Additional Sections\\n[Any other relevant sections]\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 585,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center justify-between text-xs text-gray-500 p-3 bg-gray-50 rounded-lg\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  children: [\"Word count: \", (proposal === null || proposal === void 0 ? void 0 : (_proposal$content0 = proposal.content) === null || _proposal$content0 === void 0 ? void 0 : (_proposal$content0$fu = _proposal$content0.fullProposal) === null || _proposal$content0$fu === void 0 ? void 0 : _proposal$content0$fu.split(/\\s+/).length) || 0, \" words\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 615,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: [\"Characters: \", (proposal === null || proposal === void 0 ? void 0 : (_proposal$content1 = proposal.content) === null || _proposal$content1 === void 0 ? void 0 : (_proposal$content1$fu = _proposal$content1.fullProposal) === null || _proposal$content1$fu === void 0 ? void 0 : _proposal$content1$fu.length) || 0]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 616,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 614,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 573,\n              columnNumber: 15\n            }, this), (proposal === null || proposal === void 0 ? void 0 : (_proposal$content10 = proposal.content) === null || _proposal$content10 === void 0 ? void 0 : _proposal$content10.fullProposal) && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mt-6 bg-green-50 border border-green-200 rounded-xl p-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center gap-2 text-green-800\",\n                children: [/*#__PURE__*/_jsxDEV(CheckCircleIcon, {\n                  className: \"w-5 h-5\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 624,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"font-medium\",\n                  children: \"Content Ready!\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 625,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 623,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-green-700 text-sm mt-1\",\n                children: \"Review and edit the content above. Use \\\"Refine with AI\\\" to improve the entire document or \\\"Format\\\" to structure it properly.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 627,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 622,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 546,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 545,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 388,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 387,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ClientSelectionModal, {\n      isOpen: showClientModal,\n      onClose: () => setShowClientModal(false),\n      onSelectClient: handleClientSelect,\n      selectedClientId: selectedClientId\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 638,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 348,\n    columnNumber: 5\n  }, this);\n};\n_s(ProposalEditor, \"czzZHHvM9KoN3PnlMT5WFP1YHB0=\", false, function () {\n  return [useParams, useNavigate];\n});\n_c = ProposalEditor;\nexport default ProposalEditor;\nvar _c;\n$RefreshReg$(_c, \"ProposalEditor\");","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","toast","proposalsAPI","getOpenRouterChatCompletion","ClientSelectionModal","DocumentTextIcon","UserIcon","SparklesIcon","CogIcon","CheckCircleIcon","ClockIcon","CurrencyDollarIcon","ArrowPathIcon","EyeIcon","PencilIcon","jsxDEV","_jsxDEV","ProposalEditor","_s","_proposal$content7","_proposal$content8","_proposal$content9","_proposal$content0","_proposal$content0$fu","_proposal$content1","_proposal$content1$fu","_proposal$content10","id","navigate","loading","setLoading","generating","setGenerating","showClientModal","setShowClientModal","selectedClientId","setSelectedClientId","undefined","proposal","setProposal","title","description","clientName","clientEmail","type","content","executiveSummary","approach","budgetDetails","timeline","budget","fullProposal","metadata","industry","companySize","projectScope","accessRequests","setAccessRequests","grantingRequestId","setGrantingRequestId","isNewProposal","console","log","fetchProposal","data","getById","proposalData","clientId","error","getAccessRequests","then","catch","handleGenerateWithAI","hasClientName","hasDescription","missingFields","push","join","messages","role","response","choices","message","cleanContent","replace","trim","cleanedContent","prev","success","handleSave","create","update","handleSubmit","updatedProposal","status","handleClientSelect","client","name","email","handleClearClient","handleGrantAccess","requestId","grantAccessRequest","handleRefineEntireProposal","_proposal$content","handleFormatProposal","_proposal$content2","formattedContent","getCombinedProposalContent","_proposal$content3","_proposal$content4","_proposal$content5","_proposal$content6","sections","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","disabled","value","onChange","e","target","placeholder","rows","split","length","isOpen","onClose","onSelectClient","_c","$RefreshReg$"],"sources":["/Users/davnishsingh/Documents/proposalai-main/proposalai/client/src/pages/ProposalEditor.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { toast } from 'react-hot-toast';\nimport { proposalsAPI, getOpenRouterChatCompletion } from '../services/api';\nimport ClientSelectionModal from '../components/ClientSelectionModal';\nimport { \n  DocumentTextIcon, \n  UserIcon, \n  SparklesIcon, \n  CogIcon, \n  CheckCircleIcon,\n  ClockIcon,\n  CurrencyDollarIcon,\n  BuildingOfficeIcon,\n  LightBulbIcon,\n  ChartBarIcon,\n  ArrowPathIcon,\n  EyeIcon,\n  PencilIcon,\n  PlusIcon,\n  XMarkIcon\n} from '@heroicons/react/24/outline';\n\nconst ProposalEditor: React.FC = () => {\n  const { id } = useParams<{ id: string }>();\n  const navigate = useNavigate();\n  const [loading, setLoading] = useState(false);\n  const [generating, setGenerating] = useState(false);\n  const [showClientModal, setShowClientModal] = useState(false);\n  const [selectedClientId, setSelectedClientId] = useState<string | undefined>(undefined);\n  const [proposal, setProposal] = useState<any>({\n    title: '',\n    description: '',\n    clientName: '',\n    clientEmail: '',\n    type: 'PROPOSAL',\n    content: {\n      executiveSummary: '',\n      approach: '',\n      budgetDetails: '',\n      timeline: '',\n      budget: '',\n      fullProposal: '' // Added for unified editing\n    },\n    metadata: {\n      industry: '',\n      companySize: '',\n      projectScope: ''\n    }\n  });\n  const [accessRequests, setAccessRequests] = useState<any[]>([]);\n  const [grantingRequestId, setGrantingRequestId] = useState<string | null>(null);\n\n  const isNewProposal = !id;\n\n  // Debug log to verify access requests\n  console.log('ðŸ” Access requests state:', accessRequests);\n\n  useEffect(() => {\n    const fetchProposal = async () => {\n      try {\n        const { data } = await proposalsAPI.getById(id!);\n        // Ensure metadata exists with default values\n        const proposalData = {\n          ...data.data,\n          metadata: {\n            industry: '',\n            companySize: '',\n            projectScope: '',\n            ...data.data.metadata\n          },\n          content: {\n            executiveSummary: '',\n            approach: '',\n            budgetDetails: '',\n            timeline: '',\n            budget: '',\n            fullProposal: '',\n            ...data.data.content\n          }\n        };\n        setProposal(proposalData);\n        setSelectedClientId(data.data.clientId);\n      } catch (error) {\n        console.error('Failed to fetch proposal:', error);\n        toast.error('Failed to load proposal');\n      }\n    };\n\n    if (id) {\n      fetchProposal();\n    }\n  }, [id]);\n\n  useEffect(() => {\n    if (id) {\n      proposalsAPI.getAccessRequests(id)\n        .then(({ data }) => setAccessRequests(data.data))\n        .catch(() => setAccessRequests([]));\n    }\n  }, [id]);\n\n  const handleGenerateWithAI = async () => {\n    // Validate required fields\n    console.log('ðŸ” Current proposal state:', {\n      clientName: proposal.clientName,\n      description: proposal.description,\n      hasClientName: !!proposal.clientName,\n      hasDescription: !!proposal.description\n    });\n    \n    if (!proposal.clientName || !proposal.description) {\n      const missingFields = [];\n      if (!proposal.clientName) missingFields.push('Client Name');\n      if (!proposal.description) missingFields.push('Description');\n      toast.error(`Please fill in: ${missingFields.join(' and ')} before generating content`);\n      return;\n    }\n\n    setGenerating(true);\n    try {\n      const messages = [\n        {\n          role: 'system',\n          content: 'You are an expert proposal writer. Generate a detailed, professional proposal for the following client and project. Structure your response with clear sections: Executive Summary, Project Overview, Our Approach & Methodology, Detailed Scope of Work, Timeline & Milestones, Investment & Pricing, Why Choose Us, and Next Steps. Use clear, persuasive language and make each section comprehensive.'\n        },\n        {\n          role: 'user',\n          content: `Create a comprehensive, professional proposal for the following project:\n\nClient: ${proposal.clientName}\nProject Description: ${proposal.description}\nBudget: ${proposal.budget || 'To be determined'}\nTimeline: ${proposal.timeline || 'To be determined'}\n\nPlease structure the proposal with the following sections:\n1. Executive Summary\n2. Project Overview\n3. Our Approach & Methodology\n4. Detailed Scope of Work\n5. Timeline & Milestones\n6. Investment & Pricing\n7. Why Choose Us\n8. Next Steps\n\nMake it compelling, professional, and tailored to the client's needs. Use clear headings and bullet points where appropriate.`\n        }\n      ];\n\n      const response = await getOpenRouterChatCompletion(messages);\n      \n      if (response && response.choices && response.choices[0] && response.choices[0].message) {\n        const cleanContent = (content: string) => {\n          // Remove any markdown formatting that might interfere\n          return content\n            .replace(/```markdown/g, '')\n            .replace(/```/g, '')\n            .trim();\n        };\n\n        const cleanedContent = cleanContent(response.choices[0].message.content);\n        \n        setProposal((prev: any) => ({\n          ...prev,\n          content: {\n            ...prev.content,\n            fullProposal: cleanedContent\n          }\n        }));\n        \n        toast.success('Proposal content generated successfully!');\n      }\n    } catch (error) {\n      console.error('Error generating content:', error);\n      toast.error('Failed to generate content. Please try again.');\n    } finally {\n      setGenerating(false);\n    }\n  };\n\n  const handleSave = async () => {\n    if (!proposal.title || !proposal.clientName || !proposal.description) {\n      toast.error('Please fill in all required fields');\n      return;\n    }\n\n    setLoading(true);\n    try {\n      if (isNewProposal) {\n        await proposalsAPI.create(proposal);\n        toast.success('Proposal saved as draft!');\n        navigate('/drafts');\n      } else {\n        await proposalsAPI.update(id, proposal);\n        toast.success('Proposal updated successfully!');\n      }\n    } catch (error) {\n      console.error('Error saving proposal:', error);\n      toast.error('Failed to save proposal');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSubmit = async () => {\n    if (!proposal.title || !proposal.clientName || !proposal.description) {\n      toast.error('Please fill in all required fields');\n      return;\n    }\n\n    setLoading(true);\n    try {\n      const updatedProposal = { ...proposal, status: 'SENT' };\n      if (isNewProposal) {\n        await proposalsAPI.create(updatedProposal);\n      } else {\n        await proposalsAPI.update(id, updatedProposal);\n      }\n      toast.success('Proposal submitted successfully!');\n      navigate('/sent-proposals');\n    } catch (error) {\n      console.error('Error submitting proposal:', error);\n      toast.error('Failed to submit proposal');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleClientSelect = (client: any) => {\n    setProposal((prev: any) => ({\n      ...prev,\n      clientName: client.name,\n      clientEmail: client.email\n    }));\n    setSelectedClientId(client.id);\n    setShowClientModal(false);\n  };\n\n  const handleClearClient = () => {\n    setProposal((prev: any) => ({\n      ...prev,\n      clientName: '',\n      clientEmail: ''\n    }));\n    setSelectedClientId(undefined);\n  };\n\n  const handleGrantAccess = async (requestId: string) => {\n    setGrantingRequestId(requestId);\n    try {\n      await proposalsAPI.grantAccessRequest(id!, requestId);\n      toast.success('Access granted and email sent!');\n      // Refresh access requests\n      const { data } = await proposalsAPI.getAccessRequests(id!);\n      setAccessRequests(data.data);\n    } catch (error) {\n      toast.error('Failed to grant access');\n    } finally {\n      setGrantingRequestId(null);\n    }\n  };\n\n  const handleRefineEntireProposal = async () => {\n    if (!proposal?.content?.fullProposal) {\n      toast.error('No content to refine. Please generate or add content first.');\n      return;\n    }\n\n    setGenerating(true);\n    try {\n      const messages = [\n        {\n          role: 'system',\n          content: 'You are an expert proposal writer. Refine the entire proposal content. Make it more detailed, persuasive, and comprehensive while maintaining the same structure.'\n        },\n        {\n          role: 'user',\n          content: `Please refine and improve the following proposal content. Make it more compelling, professional, and persuasive while maintaining the same structure:\n\n${proposal.content.fullProposal}\n\nPlease enhance:\n1. Clarity and readability\n2. Professional tone\n3. Persuasive language\n4. Value proposition\n5. Call-to-action\n\nReturn the improved version with the same structure.`\n        }\n      ];\n\n      const response = await getOpenRouterChatCompletion(messages);\n      \n      if (response && response.choices && response.choices[0] && response.choices[0].message) {\n        setProposal((prev: any) => ({\n          ...prev,\n          content: {\n            ...prev.content,\n            fullProposal: response.choices[0].message.content.trim()\n          }\n        }));\n        \n        toast.success('Proposal refined successfully!');\n      }\n    } catch (error) {\n      console.error('Error refining content:', error);\n      toast.error('Failed to refine content. Please try again.');\n    } finally {\n      setGenerating(false);\n    }\n  };\n\n  const handleFormatProposal = () => {\n    if (!proposal?.content?.fullProposal) {\n      toast.error('No content to format. Please add content first.');\n      return;\n    }\n\n    const content = proposal.content.fullProposal;\n    const formattedContent = content\n      .replace(/([A-Z][a-z]+:)/g, '\\n## $1') // Add markdown headers\n      .replace(/(\\d+\\.\\s)/g, '\\n$1') // Add line breaks before numbered lists\n      .replace(/(â€¢\\s)/g, '\\n$1') // Add line breaks before bullet points\n      .trim();\n\n    setProposal((prev: any) => ({\n      ...prev,\n      content: {\n        ...prev.content,\n        fullProposal: formattedContent\n      }\n    }));\n\n    toast.success('Proposal formatted successfully!');\n  };\n\n  const getCombinedProposalContent = () => {\n    const sections = [];\n    if (proposal?.content?.executiveSummary) sections.push(`# Executive Summary\\n${proposal.content.executiveSummary}`);\n    if (proposal?.content?.approach) sections.push(`# Approach\\n${proposal.content.approach}`);\n    if (proposal?.content?.budgetDetails) sections.push(`# Budget Details\\n${proposal.content.budgetDetails}`);\n    if (proposal?.content?.timeline) sections.push(`# Timeline\\n${proposal.content.timeline}`);\n    return sections.join('\\n\\n');\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-50\">\n      {/* Header */}\n      <div className=\"bg-white border-b border-gray-200 px-6 py-4\">\n        <div className=\"max-w-7xl mx-auto flex items-center justify-between\">\n          <div className=\"flex items-center gap-4\">\n            <div className=\"w-10 h-10 bg-gradient-to-r from-primary-600 to-primary-700 rounded-xl flex items-center justify-center shadow-lg\">\n              <DocumentTextIcon className=\"w-5 h-5 text-white\" />\n            </div>\n            <div>\n              <h1 className=\"text-2xl font-bold text-gray-900\">\n                {isNewProposal ? 'Create New Proposal' : 'Edit Proposal'}\n              </h1>\n              <p className=\"text-sm text-gray-600\">\n                {isNewProposal ? 'Build a compelling proposal from scratch' : 'Refine and perfect your proposal'}\n              </p>\n            </div>\n          </div>\n          <div className=\"flex items-center gap-3\">\n            <button\n              onClick={handleSave}\n              disabled={loading}\n              className=\"btn-secondary flex items-center gap-2\"\n            >\n              <PencilIcon className=\"w-4 h-4\" />\n              Save Draft\n            </button>\n            <button\n              onClick={handleSubmit}\n              disabled={loading}\n              className=\"btn-primary flex items-center gap-2\"\n            >\n              <CheckCircleIcon className=\"w-4 h-4\" />\n              Submit Proposal\n            </button>\n          </div>\n        </div>\n      </div>\n\n      {/* Main Content */}\n      <div className=\"max-w-7xl mx-auto px-6 py-8\">\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n          {/* Left Panel - Form */}\n          <div className=\"lg:col-span-1\">\n            <div className=\"bg-white rounded-2xl shadow-sm border border-gray-200 p-6 sticky top-8\">\n              <div className=\"flex items-center gap-3 mb-6\">\n                <div className=\"w-8 h-8 bg-gradient-to-r from-blue-100 to-blue-200 rounded-lg flex items-center justify-center\">\n                  <CogIcon className=\"w-4 h-4 text-blue-600\" />\n                </div>\n                <h2 className=\"text-xl font-bold text-gray-900\">Proposal Details</h2>\n              </div>\n\n              <form className=\"space-y-6\">\n                {/* Proposal Title */}\n                <div className=\"space-y-2\">\n                  <label className=\"block text-sm font-semibold text-gray-700\">\n                    Proposal Title <span className=\"text-red-500\">*</span>\n                  </label>\n                  <input\n                    type=\"text\"\n                    value={proposal?.title || ''}\n                    onChange={(e) => setProposal({ ...proposal, title: e.target.value })}\n                    className=\"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 bg-gray-50 hover:bg-white\"\n                    placeholder=\"Enter proposal title\"\n                  />\n                </div>\n\n                {/* Client Selection */}\n                <div className=\"space-y-2\">\n                  <label className=\"block text-sm font-semibold text-gray-700\">\n                    Client <span className=\"text-red-500\">*</span>\n                  </label>\n                  <div className=\"space-y-3\">\n                    <div className=\"flex gap-2\">\n                      <input\n                        type=\"text\"\n                        value={proposal?.clientName || ''}\n                        onChange={(e) => setProposal({ ...proposal, clientName: e.target.value })}\n                        className=\"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 bg-gray-50 hover:bg-white\"\n                        placeholder=\"Enter client name\"\n                      />\n                      <button\n                        type=\"button\"\n                        onClick={() => setShowClientModal(true)}\n                        className={`px-4 py-3 rounded-xl transition-all duration-200 flex items-center gap-2 whitespace-nowrap font-medium ${\n                          selectedClientId \n                            ? 'bg-green-600 text-white hover:bg-green-700 shadow-md' \n                            : 'bg-primary-600 text-white hover:bg-primary-700 shadow-md'\n                        }`}\n                      >\n                        <UserIcon className=\"w-4 h-4\" />\n                        {selectedClientId ? 'Change' : 'Select'}\n                      </button>\n                    </div>\n                    \n                    {selectedClientId && (\n                      <div className=\"p-3 bg-green-50 border border-green-200 rounded-xl\">\n                        <div className=\"flex items-center justify-between\">\n                          <div className=\"flex items-center gap-2 text-sm text-green-800\">\n                            <CheckCircleIcon className=\"w-4 h-4\" />\n                            Client selected from database\n                          </div>\n                          <button\n                            type=\"button\"\n                            onClick={handleClearClient}\n                            className=\"text-red-600 hover:text-red-800 text-sm font-medium\"\n                          >\n                            Clear\n                          </button>\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                </div>\n\n                {/* Project Description */}\n                <div className=\"space-y-2\">\n                  <label className=\"block text-sm font-semibold text-gray-700\">\n                    Project Description <span className=\"text-red-500\">*</span>\n                  </label>\n                  <textarea\n                    value={proposal?.description || ''}\n                    onChange={(e) => setProposal({ ...proposal, description: e.target.value })}\n                    rows={4}\n                    className=\"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 bg-gray-50 hover:bg-white resize-none\"\n                    placeholder=\"Describe the project, requirements, and objectives...\"\n                  />\n                </div>\n\n                {/* Budget & Timeline */}\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <label className=\"block text-sm font-semibold text-gray-700\">\n                      Budget\n                    </label>\n                    <div className=\"relative\">\n                      <CurrencyDollarIcon className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\" />\n                      <input\n                        type=\"text\"\n                        value={proposal?.budget || ''}\n                        onChange={(e) => setProposal({ ...proposal, budget: e.target.value })}\n                        className=\"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 bg-gray-50 hover:bg-white\"\n                        placeholder=\"e.g. $50,000\"\n                      />\n                    </div>\n                  </div>\n                  \n                  <div className=\"space-y-2\">\n                    <label className=\"block text-sm font-semibold text-gray-700\">\n                      Timeline\n                    </label>\n                    <div className=\"relative\">\n                      <ClockIcon className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\" />\n                      <input\n                        type=\"text\"\n                        value={proposal?.timeline || ''}\n                        onChange={(e) => setProposal({ ...proposal, timeline: e.target.value })}\n                        className=\"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 bg-gray-50 hover:bg-white\"\n                        placeholder=\"e.g. 2 months\"\n                      />\n                    </div>\n                  </div>\n                </div>\n\n                {/* AI Generation Button */}\n                <button\n                  type=\"button\"\n                  onClick={handleGenerateWithAI}\n                  disabled={generating || loading || !proposal?.clientName || !proposal?.description}\n                  className={`w-full py-4 px-6 rounded-xl font-semibold text-white transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-offset-2 shadow-lg ${\n                    generating || loading || !proposal?.clientName || !proposal?.description\n                      ? 'bg-gray-400 cursor-not-allowed'\n                      : 'bg-gradient-to-r from-primary-600 to-purple-600 hover:from-primary-700 hover:to-purple-700 focus:ring-primary-500'\n                  }`}\n                >\n                  {generating ? (\n                    <div className=\"flex items-center justify-center\">\n                      <ArrowPathIcon className=\"animate-spin -ml-1 mr-3 h-5 w-5 text-white\" />\n                      Generating Content...\n                    </div>\n                  ) : (\n                    <div className=\"flex items-center justify-center\">\n                      <SparklesIcon className=\"w-5 h-5 mr-2\" />\n                      Generate AI Content\n                    </div>\n                  )}\n                </button>\n                \n                {(!proposal?.clientName || !proposal?.description) && (\n                  <p className=\"text-sm text-gray-500 text-center\">\n                    Enter client name and description to enable AI generation\n                  </p>\n                )}\n              </form>\n            </div>\n          </div>\n\n          {/* Right Panel - Content Editor */}\n          <div className=\"lg:col-span-2\">\n            <div className=\"bg-white rounded-2xl shadow-sm border border-gray-200 p-6\">\n              <div className=\"flex items-center justify-between mb-6\">\n                <div>\n                  <h2 className=\"text-xl font-bold text-gray-900 mb-1\">Proposal Content</h2>\n                  <p className=\"text-gray-600\">Review, edit, and refine your proposal content</p>\n                </div>\n                <div className=\"flex items-center gap-3\">\n                  <button\n                    onClick={() => handleRefineEntireProposal()}\n                    disabled={generating || !proposal?.content?.fullProposal}\n                    className=\"btn-primary flex items-center gap-2\"\n                  >\n                    <SparklesIcon className=\"w-4 h-4\" />\n                    Refine with AI\n                  </button>\n                  <button \n                    onClick={() => handleFormatProposal()}\n                    disabled={!proposal?.content?.fullProposal}\n                    className=\"btn-secondary flex items-center gap-2\"\n                  >\n                    <CogIcon className=\"w-4 h-4\" />\n                    Format\n                  </button>\n                </div>\n              </div>\n\n              {/* Content Editor */}\n              <div className=\"space-y-4\">\n                <div className=\"flex items-center gap-4 text-sm text-gray-600 p-3 bg-gray-50 rounded-xl\">\n                  <div className=\"flex items-center gap-2\">\n                    <EyeIcon className=\"w-4 h-4\" />\n                    Edit the entire proposal content below\n                  </div>\n                  <div className=\"flex items-center gap-2\">\n                    <SparklesIcon className=\"w-4 h-4\" />\n                    Use \"Refine with AI\" to improve the entire document\n                  </div>\n                </div>\n\n                <textarea\n                  value={proposal?.content?.fullProposal || getCombinedProposalContent()}\n                  onChange={(e) => setProposal({ \n                    ...proposal, \n                    content: { \n                      ...proposal?.content, \n                      fullProposal: e.target.value \n                    } \n                  })}\n                  rows={25}\n                  className=\"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none transition-all duration-200 bg-gray-50 font-mono text-sm leading-relaxed hover:bg-white\"\n                  placeholder=\"Enter your complete proposal content here...\n\n# Executive Summary\n[Your executive summary goes here]\n\n# Approach\n[Your approach and methodology]\n\n# Budget Details\n[Detailed budget breakdown]\n\n# Timeline\n[Project timeline and milestones]\n\n# Additional Sections\n[Any other relevant sections]\"\n                />\n                \n                <div className=\"flex items-center justify-between text-xs text-gray-500 p-3 bg-gray-50 rounded-lg\">\n                  <span>Word count: {proposal?.content?.fullProposal?.split(/\\s+/).length || 0} words</span>\n                  <span>Characters: {proposal?.content?.fullProposal?.length || 0}</span>\n                </div>\n              </div>\n\n              {/* Success Message */}\n              {proposal?.content?.fullProposal && (\n                <div className=\"mt-6 bg-green-50 border border-green-200 rounded-xl p-4\">\n                  <div className=\"flex items-center gap-2 text-green-800\">\n                    <CheckCircleIcon className=\"w-5 h-5\" />\n                    <span className=\"font-medium\">Content Ready!</span>\n                  </div>\n                  <p className=\"text-green-700 text-sm mt-1\">\n                    Review and edit the content above. Use \"Refine with AI\" to improve the entire document or \"Format\" to structure it properly.\n                  </p>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n      \n      {/* Client Selection Modal */}\n      <ClientSelectionModal\n        isOpen={showClientModal}\n        onClose={() => setShowClientModal(false)}\n        onSelectClient={handleClientSelect}\n        selectedClientId={selectedClientId}\n      />\n    </div>\n  );\n};\n\nexport default ProposalEditor; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}