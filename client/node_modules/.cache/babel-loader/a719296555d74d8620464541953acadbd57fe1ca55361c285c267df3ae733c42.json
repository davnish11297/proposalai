{"ast":null,"code":"import React,{useState,useEffect}from'react';import{toast}from'react-hot-toast';import ReactMarkdown from'react-markdown';import remarkGfm from'remark-gfm';import{getOpenRouterChatCompletion}from'../services/api';import{proposalsAPI}from'../services/api';import'../ProposalMarkdown.css';// Utility to convert HTML tags to markdown\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function htmlToMarkdown(input){return input.replace(/<strong>(.*?)<\\/strong>/gi,'**$1**').replace(/<b>(.*?)<\\/b>/gi,'**$1**').replace(/<em>(.*?)<\\/em>/gi,'*$1*').replace(/<i>(.*?)<\\/i>/gi,'*$1*').replace(/<br\\s*\\/?>(\\s*)/gi,'\\n').replace(/<[^>]+>/g,'')// Remove any other HTML tags\n.replace(/\\n{3,}/g,'\\n\\n');// Collapse excessive newlines\n}const Dashboard=()=>{const[proposalText,setProposalText]=useState('');const[generating,setGenerating]=useState(false);const[showContent,setShowContent]=useState(false);const[generatedContent,setGeneratedContent]=useState({executiveSummary:'',approach:'',budgetDetails:'',timeline:'',fullContent:''// Added for react-markdown\n});const[savingDraft,setSavingDraft]=useState(false);const[sendingEmail,setSendingEmail]=useState(false);const[downloadingPdf,setDownloadingPdf]=useState(false);const[showEmailModal,setShowEmailModal]=useState(false);const[email,setEmail]=useState('');const[proposalId,setProposalId]=useState(null);const[selectedSuggestions,setSelectedSuggestions]=useState([]);const[loadingSuggestions,setLoadingSuggestions]=useState(false);const[loadingRefinementSuggestions,setLoadingRefinementSuggestions]=useState(false);const[uploadingPdf,setUploadingPdf]=useState(false);const[uploadedPdfContent,setUploadedPdfContent]=useState('');// State for suggestions\nconst[predefinedSuggestions,setPredefinedSuggestions]=useState([]);const[refinementSuggestions,setRefinementSuggestions]=useState([]);// Generate AI-based suggestions based on existing drafts\nconst generateSuggestionsFromDrafts=async()=>{try{var _aiResponse$choices$,_aiResponse$choices$$;console.log('Starting draft-based suggestion generation...');// Fetch existing drafts to analyze\nconst response=await fetch('/api/proposals/drafts',{headers:{'Authorization':`Bearer ${localStorage.getItem('token')}`}});if(!response.ok){throw new Error('Failed to fetch drafts');}const data=await response.json();const drafts=data.data||[];if(drafts.length===0){// If no drafts exist, fall back to generic suggestions\nawait generateSuggestions();return;}// Combine content from recent drafts for analysis\nconst recentDrafts=drafts.slice(0,3);// Take last 3 drafts\nconst draftContent=recentDrafts.map(draft=>draft.content||draft.fullContent||'').filter(content=>content.trim()).join('\\n\\n');const messages=[{role:'system',content:'You are an expert proposal writer. Based on the provided existing proposal drafts, generate 8 specific, actionable suggestions for improving future proposals. Each suggestion should be concise (2-4 words) and focus on different aspects like content, structure, persuasion, and professionalism. Return only the suggestions, one per line, without numbering or bullet points.'},{role:'user',content:`Generate 8 proposal improvement suggestions based on these existing drafts:\\n\\n${draftContent}`}];console.log('Calling OpenRouter API for draft-based suggestions...');const aiResponse=await getOpenRouterChatCompletion(messages);const aiSuggestions=((_aiResponse$choices$=aiResponse.choices[0])===null||_aiResponse$choices$===void 0?void 0:(_aiResponse$choices$$=_aiResponse$choices$.message)===null||_aiResponse$choices$$===void 0?void 0:_aiResponse$choices$$.content)||'';console.log('AI Draft-Based Response:',aiSuggestions);// Parse AI suggestions and create suggestion objects\nconst suggestions=aiSuggestions.split('\\n').filter(line=>line.trim()).slice(0,8).map((suggestion,index)=>{const colors=['blue','green','purple','orange','red','yellow'];const icons=[/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"})},\"icon1\"),/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1\"})},\"icon2\"),/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\"})},\"icon3\"),/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10\"})},\"icon4\"),/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z\"})},\"icon5\"),/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\"})},\"icon6\"),/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\"})},\"icon7\"),/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M13 7l5 5m0 0l-5 5m5-5H6\"})},\"icon8\")];return{text:suggestion.trim(),icon:icons[index%icons.length],color:colors[index%colors.length]};});console.log('Parsed draft-based suggestions:',suggestions);setPredefinedSuggestions(suggestions);}catch(error){console.error('Error generating draft-based suggestions:',error);// Fall back to generic suggestions if draft-based generation fails\nawait generateSuggestions();}};// Generate AI-based suggestions (generic)\nconst generateSuggestions=async()=>{try{var _response$choices$,_response$choices$$me;console.log('Starting AI suggestion generation...');const messages=[{role:'system',content:'You are an expert proposal writer. Generate 8 specific, actionable suggestions for improving a business proposal. Each suggestion should be concise (2-4 words) and focus on different aspects like content, structure, persuasion, and professionalism. Return only the suggestions, one per line, without numbering or bullet points.'},{role:'user',content:'Generate 8 proposal improvement suggestions.'}];console.log('Calling OpenRouter API...');const response=await getOpenRouterChatCompletion(messages);const aiSuggestions=((_response$choices$=response.choices[0])===null||_response$choices$===void 0?void 0:(_response$choices$$me=_response$choices$.message)===null||_response$choices$$me===void 0?void 0:_response$choices$$me.content)||'';console.log('AI Response:',aiSuggestions);// Parse AI suggestions and create suggestion objects\nconst suggestions=aiSuggestions.split('\\n').filter(line=>line.trim()).slice(0,8).map((suggestion,index)=>{const colors=['blue','green','purple','orange','red','yellow'];const icons=[/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"})},\"icon1\"),/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1\"})},\"icon2\"),/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\"})},\"icon3\"),/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10\"})},\"icon4\"),/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z\"})},\"icon5\"),/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\"})},\"icon6\"),/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\"})},\"icon7\"),/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M13 7l5 5m0 0l-5 5m5-5H6\"})},\"icon8\")];return{text:suggestion.trim(),icon:icons[index%icons.length],color:colors[index%colors.length]};});console.log('Parsed suggestions:',suggestions);setPredefinedSuggestions(suggestions);}catch(error){console.error('Error generating suggestions:',error);// Fallback to basic suggestions if AI fails\nsetPredefinedSuggestions([{text:\"Add Executive Summary\",icon:/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"})}),color:'blue'},{text:\"Include Budget Details\",icon:/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1\"})}),color:'green'},{text:\"Add Timeline Section\",icon:/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\"})}),color:'purple'}]);}};// Generate AI-based refinement suggestions\nconst generateRefinementSuggestions=async proposalContent=>{try{var _response$choices$2,_response$choices$2$m;console.log('Starting refinement suggestion generation...');console.log('Proposal content:',proposalContent);const messages=[{role:'system',content:'You are an expert proposal writer. Based on the provided proposal content, generate 8 specific, actionable suggestions for refining and improving the proposal. Each suggestion should be concise (2-4 words) and focus on different aspects like clarity, persuasion, structure, and impact. Return only the suggestions, one per line, without numbering or bullet points.'},{role:'user',content:`Generate 8 refinement suggestions for this proposal:\\n\\n${proposalContent}`}];console.log('Calling OpenRouter API for refinement...');const response=await getOpenRouterChatCompletion(messages);const aiSuggestions=((_response$choices$2=response.choices[0])===null||_response$choices$2===void 0?void 0:(_response$choices$2$m=_response$choices$2.message)===null||_response$choices$2$m===void 0?void 0:_response$choices$2$m.content)||'';console.log('AI Refinement Response:',aiSuggestions);// Parse AI suggestions and create suggestion objects\nconst suggestions=aiSuggestions.split('\\n').filter(line=>line.trim()).slice(0,8).map((suggestion,index)=>{const colors=['blue','green','purple','orange','red','yellow'];const icons=[/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\"})},\"icon1\"),/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M12 6v6m0 0v6m0-6h6m-6 0H6\"})},\"icon2\"),/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z\"})},\"icon3\"),/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10\"})},\"icon4\"),/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M13 10V3L4 14h7v7l9-11h-7z\"})},\"icon5\"),/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M13 7l5 5m0 0l-5 5m5-5H6\"})},\"icon6\")];return{text:suggestion.trim(),icon:icons[index%icons.length],color:colors[index%colors.length]};});console.log('Parsed refinement suggestions:',suggestions);setRefinementSuggestions(suggestions);}catch(error){console.error('Error generating refinement suggestions:',error);// Fallback to basic refinement suggestions if AI fails\nsetRefinementSuggestions([{text:\"Enhance Executive Summary\",icon:/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\"})}),color:'blue'},{text:\"Add More Details\",icon:/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M12 6v6m0 0v6m0-6h6m-6 0H6\"})}),color:'green'},{text:\"Improve Clarity\",icon:/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z\"})}),color:'purple'},{text:\"Strengthen Budget\",icon:/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10\"})}),color:'orange'},{text:\"Add Timeline Details\",icon:/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M13 10V3L4 14h7v7l9-11h-7z\"})}),color:'red'},{text:\"Include Case Studies\",icon:/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M13 7l5 5m0 0l-5 5m5-5H6\"})}),color:'yellow'},{text:\"Add Testimonials\",icon:/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\"})}),color:'blue'},{text:\"Improve Structure\",icon:/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"})}),color:'green'}]);}};// Handle PDF file upload and extraction\nconst handlePdfUpload=async event=>{var _event$target$files;const file=(_event$target$files=event.target.files)===null||_event$target$files===void 0?void 0:_event$target$files[0];if(!file)return;if(file.type!=='application/pdf'){toast.error('Please upload a PDF file');return;}setUploadingPdf(true);try{const formData=new FormData();formData.append('pdf',file);// Call backend API to extract text from PDF\nconst response=await fetch('/api/proposals/extract-pdf',{method:'POST',body:formData,headers:{'Authorization':`Bearer ${localStorage.getItem('token')}`}});if(!response.ok){throw new Error('Failed to extract PDF content');}const data=await response.json();const extractedText=data.content||data.text||'';if(extractedText.trim()){setUploadedPdfContent(extractedText);toast.success('PDF uploaded successfully! You can now generate a refined proposal.');}else{toast.error('No readable text found in the PDF');}}catch(error){console.error('PDF extraction error:',error);toast.error('Failed to extract PDF content. Please try again.');}finally{setUploadingPdf(false);// Reset the file input\nevent.target.value='';}};// Handle suggestion bubble click (select/unselect up to 5)\nconst handleSuggestionClick=suggestion=>{setSelectedSuggestions(prev=>prev.includes(suggestion)?prev.filter(s=>s!==suggestion):prev.length<5?[...prev,suggestion]:prev);};// Handle regeneration of suggestions\nconst handleRegenerateSuggestions=async()=>{setLoadingSuggestions(true);setSelectedSuggestions([]);try{console.log('Regenerating draft-based suggestions...');await generateSuggestionsFromDrafts();// Use draft-based generation\ntoast.success('New AI-generated suggestions based on your drafts loaded!');}catch(error){console.error('Error regenerating draft-based suggestions:',error);toast.error('Failed to regenerate suggestions');}finally{setLoadingSuggestions(false);}};// Handle regeneration of refinement suggestions\nconst handleRegenerateRefinementSuggestions=async()=>{setLoadingRefinementSuggestions(true);setSelectedSuggestions([]);try{console.log('Regenerating refinement suggestions...');const combinedContent=uploadedPdfContent.trim()?`${proposalText.trim()?proposalText.trim()+'\\n\\n':''}PDF Content:\\n${uploadedPdfContent.trim()}`:proposalText.trim()||'business proposal';// Fallback content if nothing is provided\nawait generateRefinementSuggestions(combinedContent);// Call the AI generation function\ntoast.success('New AI-generated refinement suggestions loaded!');}catch(error){console.error('Error regenerating refinement suggestions:',error);toast.error('Failed to regenerate refinement suggestions');}finally{setLoadingRefinementSuggestions(false);}};const handleGenerateWithAI=async()=>{// Check if we have either user input or uploaded PDF content\nif(!proposalText.trim()&&!uploadedPdfContent.trim()){toast.error('Please enter a proposal description or upload a PDF before generating content');return;}try{var _response$choices$3,_response$choices$3$m,_execMatch$,_approachMatch$,_budgetMatch$,_timelineMatch$;setGenerating(true);// Combine user input and uploaded PDF content\nconst combinedContent=uploadedPdfContent.trim()?`${proposalText.trim()?proposalText.trim()+'\\n\\n':''}PDF Content:\\n${uploadedPdfContent.trim()}`:proposalText.trim();// If there are selected suggestions, use them to refine the proposal\nlet systemPrompt=`You are an expert proposal writer. Generate a professional proposal with these sections: Executive Summary, Approach, Budget Details, Timeline. Use clear, persuasive language.`;let userPrompt=`Content: ${combinedContent}\\n\\nGenerate a professional proposal with: 1. Executive Summary 2. Approach 3. Budget Details 4. Timeline`;// If there are selected suggestions, modify the prompt to include them\nif(selectedSuggestions.length>0){systemPrompt=`You are an expert proposal writer. Generate a professional proposal incorporating these refinements: ${selectedSuggestions.map(s=>`\"${s}\"`).join(', ')}. Include: Executive Summary, Approach, Budget Details, Timeline.`;userPrompt=`Content: ${combinedContent}\\n\\nRefinements: ${selectedSuggestions.join(', ')}\\n\\nGenerate proposal with: 1. Executive Summary 2. Approach 3. Budget Details 4. Timeline`;}// Compose prompt for OpenRouter\nconst messages=[{role:'system',content:systemPrompt},{role:'user',content:userPrompt}];const response=await getOpenRouterChatCompletion(messages);const aiContent=((_response$choices$3=response.choices[0])===null||_response$choices$3===void 0?void 0:(_response$choices$3$m=_response$choices$3.message)===null||_response$choices$3$m===void 0?void 0:_response$choices$3$m.content)||'';let executiveSummary='',approach='',budgetDetails='',timeline='';const execMatch=aiContent.match(/(?:Executive Summary|EXECUTIVE SUMMARY)[:\\s\\n]*([\\s\\S]*?)(?=\\n\\s*(?:Approach|APPROACH|Budget|BUDGET|Timeline|TIMELINE|Next Steps|NEXT STEPS)[:\\s\\n]|$)/i);const approachMatch=aiContent.match(/(?:Approach|APPROACH|Methodology|METHODOLOGY)[:\\s\\n]*([\\s\\S]*?)(?=\\n\\s*(?:Budget|BUDGET|Timeline|TIMELINE|Next Steps|NEXT STEPS)[:\\s\\n]|$)/i);const budgetMatch=aiContent.match(/(?:Budget Details?|BUDGET DETAILS?|Pricing|PRICING)[:\\s\\n]*([\\s\\S]*?)(?=\\n\\s*(?:Timeline|TIMELINE|Next Steps|NEXT STEPS)[:\\s\\n]|$)/i);const timelineMatch=aiContent.match(/(?:Timeline|TIMELINE|Schedule|SCHEDULE)[:\\s\\n]*([\\s\\S]*?)(?=\\n\\s*(?:Next Steps|NEXT STEPS|Conclusion|CONCLUSION)[:\\s\\n]|$)/i);executiveSummary=(execMatch===null||execMatch===void 0?void 0:(_execMatch$=execMatch[1])===null||_execMatch$===void 0?void 0:_execMatch$.trim())||'';approach=(approachMatch===null||approachMatch===void 0?void 0:(_approachMatch$=approachMatch[1])===null||_approachMatch$===void 0?void 0:_approachMatch$.trim())||'';budgetDetails=(budgetMatch===null||budgetMatch===void 0?void 0:(_budgetMatch$=budgetMatch[1])===null||_budgetMatch$===void 0?void 0:_budgetMatch$.trim())||'';timeline=(timelineMatch===null||timelineMatch===void 0?void 0:(_timelineMatch$=timelineMatch[1])===null||_timelineMatch$===void 0?void 0:_timelineMatch$.trim())||'';const cleanContent=text=>{return text.replace(/\\n{3,}/g,'\\n\\n').replace(/^\\s+|\\s+$/g,'').replace(/\\*\\*(.*?)\\*\\*/g,'<strong>$1</strong>').replace(/\\*(.*?)\\*/g,'<em>$1</em>');};setGeneratedContent({executiveSummary:htmlToMarkdown(cleanContent(executiveSummary)),approach:htmlToMarkdown(cleanContent(approach)),budgetDetails:htmlToMarkdown(cleanContent(budgetDetails)),timeline:htmlToMarkdown(cleanContent(timeline)),fullContent:[htmlToMarkdown(cleanContent(executiveSummary)),htmlToMarkdown(cleanContent(approach)),htmlToMarkdown(cleanContent(budgetDetails)),htmlToMarkdown(cleanContent(timeline))].filter(Boolean).join('\\n\\n')});setTimeout(()=>{setShowContent(true);},500);toast.success('Proposal generated successfully!');// Generate refinement suggestions for the new proposal\ngenerateRefinementSuggestions(aiContent);}catch(error){console.error('Error generating proposal:',error);// Handle specific OpenRouter credit limit error\nif(error instanceof Error&&error.message.includes('OpenRouter credits exhausted')){toast.error('AI service credits exhausted. Please visit OpenRouter to add more credits or try again later.');}else{toast.error('Failed to generate proposal content. Please try again.');}}finally{setGenerating(false);}};// Save as Draft handler\nconst handleSaveDraft=async()=>{setSavingDraft(true);try{const payload={title:proposalText.slice(0,60)||'Untitled Proposal',description:proposalText,clientName:'Client',// Optionally make this dynamic\ntype:'PROPOSAL',status:'DRAFT',content:generatedContent.fullContent};let response;if(proposalId){response=await proposalsAPI.update(proposalId,payload);}else{response=await proposalsAPI.create(payload);setProposalId(response.data.data.id);}toast.success('Proposal saved as draft!');}catch(error){toast.error('Failed to save draft.');}finally{setSavingDraft(false);}};// Send as Email handler\nconst handleSendEmail=async()=>{if(!email){toast.error('Please enter a valid email address.');return;}if(!proposalId){toast.error('Please save the proposal as draft first.');return;}setSendingEmail(true);try{await proposalsAPI.sendEmail(proposalId,{recipientEmail:email});toast.success('Proposal sent via email!');setShowEmailModal(false);setEmail('');}catch(error){toast.error('Failed to send email.');}finally{setSendingEmail(false);}};// Download as PDF handler\nconst handleDownloadPdf=async()=>{if(!proposalId){toast.error('Please save the proposal as draft first.');return;}setDownloadingPdf(true);try{var _link$parentNode;const response=await proposalsAPI.downloadPDF(proposalId);const url=window.URL.createObjectURL(new Blob([response.data],{type:'application/pdf'}));const link=document.createElement('a');link.href=url;link.setAttribute('download','proposal.pdf');document.body.appendChild(link);link.click();(_link$parentNode=link.parentNode)===null||_link$parentNode===void 0?void 0:_link$parentNode.removeChild(link);window.URL.revokeObjectURL(url);toast.success('PDF downloaded!');}catch(error){toast.error('Failed to download PDF.');}finally{setDownloadingPdf(false);}};const handleLogout=()=>{localStorage.removeItem('token');localStorage.removeItem('user');window.location.href='/login';};// After proposal is generated, generate suggestions\nuseEffect(()=>{// Initialize suggestions on component load\nconst initializeSuggestions=async()=>{try{console.log('Initializing suggestions...');setLoadingSuggestions(true);await generateSuggestionsFromDrafts();// Call the new draft-based generation function\nconsole.log('Suggestions initialized successfully');}catch(error){console.error('Error initializing suggestions:',error);}finally{setLoadingSuggestions(false);}};initializeSuggestions();},[]);// REMOVED: Auto-generation useEffect that was causing unwanted generation when typing\n// Now generation only happens when user explicitly clicks Generate/Refine button\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gray-50 flex flex-col\",children:[/*#__PURE__*/_jsx(\"nav\",{className:\"bg-gradient-to-r from-blue-600 to-blue-400 shadow-lg w-full z-10\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center h-16\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center\",children:/*#__PURE__*/_jsx(\"h1\",{className:\"text-xl font-extrabold text-white tracking-wider drop-shadow\",children:\"ProposalAI\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-8\",children:[/*#__PURE__*/_jsx(\"a\",{href:\"/dashboard\",className:\"text-white font-semibold border-b-2 border-white/80 pb-1 transition-colors\",children:\"Dashboard\"}),/*#__PURE__*/_jsx(\"a\",{href:\"/drafts\",className:\"text-white/80 hover:text-white transition-colors\",children:\"Drafts\"}),/*#__PURE__*/_jsx(\"a\",{href:\"/sent-proposals\",className:\"text-white/80 hover:text-white transition-colors\",children:\"Sent Proposals\"}),/*#__PURE__*/_jsx(\"a\",{href:\"/profile\",className:\"text-white/80 hover:text-white transition-colors\",children:\"Profile\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,className:\"text-white/80 hover:text-white transition-colors\",children:\"Logout\"})]})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-full max-w-[1400px] mx-auto py-8 px-4 sm:px-8\",children:[!showContent?/*#__PURE__*/// Single centered card when no content is generated\n_jsx(\"div\",{className:\"flex flex-col items-center justify-center min-h-[80vh]\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-full max-w-6xl bg-white/90 rounded-2xl shadow-xl border border-gray-100 p-10 flex flex-col items-center justify-center min-h-[480px] mx-auto\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-extrabold text-gray-900 mb-6 text-center tracking-tight\",children:\"What can I help with?\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-full relative mb-4\",children:[uploadedPdfContent&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 text-sm text-green-600 bg-green-50 px-3 py-2 rounded-lg mb-2\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"})}),\"PDF uploaded successfully\"]}),/*#__PURE__*/_jsx(\"textarea\",{className:\"w-full h-[180px] rounded-lg border border-gray-200 px-4 py-3 text-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition bg-gray-50 resize-none font-normal\",placeholder:\"Ask ProposalAI or type / to see prompts...\",value:proposalText,onChange:e=>setProposalText(e.target.value),disabled:generating}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-3 right-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\".pdf\",onChange:handlePdfUpload,className:\"hidden\",id:\"pdf-upload\",disabled:uploadingPdf}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"pdf-upload\",className:`inline-flex items-center justify-center w-8 h-8 rounded-full transition cursor-pointer ${uploadingPdf?'bg-gray-100 opacity-50 cursor-not-allowed':uploadedPdfContent?'bg-green-100 hover:bg-green-200':'bg-gray-100 hover:bg-gray-200'}`,title:uploadedPdfContent?\"PDF uploaded - Click to replace\":\"Upload PDF\",children:uploadingPdf?/*#__PURE__*/_jsx(\"div\",{className:\"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin\"}):uploadedPdfContent?/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4 text-green-600\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"})}):/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4 text-gray-600\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12\"})})})]})]}),!showContent&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-6\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-2\",children:loadingSuggestions?// Loading placeholders\nArray.from({length:8}).map((_,i)=>/*#__PURE__*/_jsx(\"div\",{className:\"px-3 py-1.5 rounded-full border border-gray-200 bg-gray-100 animate-pulse inline-flex items-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"h-3 bg-gray-200 rounded animate-pulse\",style:{width:`${60+i*10}px`}})},i)):predefinedSuggestions.length>0?predefinedSuggestions.map((suggestion,i)=>{const isSelected=selectedSuggestions.includes(suggestion.text);const isDisabled=!isSelected&&selectedSuggestions.length>=5;// Small, transparent styling for initial suggestions\nconst baseClasses=\"px-3 py-1.5 rounded-full text-xs font-medium transition-all duration-200 cursor-pointer border\";const selectedClasses=isSelected?\"bg-blue-100 text-blue-700 border-blue-300 shadow-sm\":\"bg-gray-50 text-gray-600 border-gray-200 hover:bg-gray-100 hover:border-gray-300\";const disabledClasses=isDisabled?\"opacity-40 cursor-not-allowed bg-gray-50 text-gray-400 border-gray-200\":\"\";return/*#__PURE__*/_jsx(\"button\",{onClick:()=>!isDisabled&&handleSuggestionClick(suggestion.text),disabled:isDisabled,className:`${baseClasses} ${isDisabled?disabledClasses:selectedClasses}`,children:suggestion.text},`initial-${i}-${suggestion.text}`);}):/*#__PURE__*/// Empty state\n_jsx(\"div\",{className:\"text-center text-gray-500 py-4 font-normal\",children:\"No suggestions available. Click \\\"New Suggestions\\\" to generate some.\"})})}),showContent&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-6\",children:/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3\",children:loadingRefinementSuggestions?/*#__PURE__*/// Loading placeholders\n_jsx(\"div\",{className:\"col-span-full flex flex-wrap gap-2\",children:Array.from({length:8}).map((_,i)=>/*#__PURE__*/_jsx(\"div\",{className:\"px-3 py-1.5 rounded-full border border-gray-200 bg-gray-100 animate-pulse inline-flex items-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"h-3 bg-gray-200 rounded animate-pulse\",style:{width:`${60+i*10}px`}})},i))}):refinementSuggestions.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"col-span-full flex flex-wrap gap-2\",children:refinementSuggestions.map((suggestion,i)=>{const isSelected=selectedSuggestions.includes(suggestion.text);const isDisabled=!isSelected&&selectedSuggestions.length>=5;// Small, transparent styling for refinement suggestions\nconst baseClasses=\"px-3 py-1.5 rounded-full text-xs font-medium transition-all duration-200 cursor-pointer border\";const selectedClasses=isSelected?\"bg-blue-100 text-blue-700 border-blue-300 shadow-sm\":\"bg-gray-50 text-gray-600 border-gray-200 hover:bg-gray-100 hover:border-gray-300\";const disabledClasses=isDisabled?\"opacity-40 cursor-not-allowed bg-gray-50 text-gray-400 border-gray-200\":\"\";return/*#__PURE__*/_jsx(\"button\",{onClick:()=>!isDisabled&&handleSuggestionClick(suggestion.text),disabled:isDisabled,className:`${baseClasses} ${isDisabled?disabledClasses:selectedClasses}`,children:suggestion.text},`refinement-${i}-${suggestion.text}`);})}):/*#__PURE__*/// Empty state\n_jsx(\"div\",{className:\"col-span-full text-center text-gray-500 py-4 font-normal\",children:\"No refinement suggestions available. Generate a proposal first or click \\\"New Suggestions\\\".\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full flex justify-center mb-6\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:showContent?handleRegenerateRefinementSuggestions:handleRegenerateSuggestions,disabled:showContent?loadingRefinementSuggestions:loadingSuggestions,className:\"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed\",title:\"Generate new suggestions\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"})}),showContent?loadingRefinementSuggestions?'Generating...':'New Suggestions':loadingSuggestions?'Generating...':'New Suggestions']})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-4 mt-2 w-full justify-center\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"px-6 py-2 rounded-lg bg-blue-600 text-white font-bold shadow-md hover:bg-blue-700 transition disabled:opacity-60\",onClick:handleGenerateWithAI,disabled:generating||!proposalText.trim(),children:generating?'Generating...':'Generate'}),/*#__PURE__*/_jsx(\"button\",{className:\"px-6 py-2 rounded-lg bg-gray-200 text-gray-700 font-bold shadow-md hover:bg-gray-300 transition\",onClick:()=>{setProposalText('');setSelectedSuggestions([]);setUploadedPdfContent('');// Clear PDF content\n},disabled:generating,children:\"Clear\"})]})]})}):/*#__PURE__*/// Side-by-side layout when content is generated\n_jsxs(\"div\",{className:\"grid grid-cols-1 xl:grid-cols-2 gap-8 max-w-7xl mx-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white/90 rounded-2xl shadow-xl border border-gray-100 p-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-extrabold text-gray-900 mb-4\",children:\"Refine Proposal\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-full relative mb-4\",children:[uploadedPdfContent&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 text-sm text-green-600 bg-green-50 px-3 py-2 rounded-lg mb-2\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"})}),\"PDF uploaded successfully\"]}),/*#__PURE__*/_jsx(\"textarea\",{className:\"w-full h-[180px] rounded-lg border border-gray-200 px-4 py-3 text-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition bg-gray-50 resize-none\",placeholder:uploadedPdfContent?\"Add additional context or requirements (optional)...\":\"Describe your client or project...\",value:proposalText,onChange:e=>setProposalText(e.target.value),disabled:generating}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-3 right-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\".pdf\",onChange:handlePdfUpload,className:\"hidden\",id:\"pdf-upload-refine\",disabled:uploadingPdf}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"pdf-upload-refine\",className:`inline-flex items-center justify-center w-8 h-8 rounded-full transition cursor-pointer ${uploadingPdf?'bg-gray-100 opacity-50 cursor-not-allowed':uploadedPdfContent?'bg-green-100 hover:bg-green-200':'bg-gray-100 hover:bg-gray-200'}`,title:uploadedPdfContent?\"PDF uploaded - Click to replace\":\"Upload PDF\",children:uploadingPdf?/*#__PURE__*/_jsx(\"div\",{className:\"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin\"}):uploadedPdfContent?/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4 text-green-600\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"})}):/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4 text-gray-600\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12\"})})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full flex flex-wrap gap-2 mb-4 min-h-[40px]\",children:loadingRefinementSuggestions?// Show placeholder suggestion bubbles during loading to maintain layout\nArray.from({length:8}).map((_,i)=>/*#__PURE__*/_jsx(\"div\",{className:\"px-3 py-1.5 rounded-full border border-gray-200 bg-gray-100 animate-pulse inline-flex items-center\",style:{minWidth:'80px',minHeight:'28px'},children:/*#__PURE__*/_jsx(\"div\",{className:\"h-3 bg-gray-200 rounded animate-pulse\",style:{width:`${60+i*10}px`}})},i)):refinementSuggestions.map((s,i)=>{const isSelected=selectedSuggestions.includes(s.text);const isDisabled=!isSelected&&selectedSuggestions.length>=5;// Small, transparent styling for refinement suggestions\nconst baseClasses=\"px-3 py-1.5 rounded-full text-xs font-medium transition-all duration-200 cursor-pointer border\";const selectedClasses=isSelected?\"bg-blue-100 text-blue-700 border-blue-300 shadow-sm\":\"bg-gray-50 text-gray-600 border-gray-200 hover:bg-gray-100 hover:border-gray-300\";const disabledClasses=isDisabled?\"opacity-40 cursor-not-allowed bg-gray-50 text-gray-400 border-gray-200\":\"\";return/*#__PURE__*/_jsx(\"button\",{onClick:()=>!isDisabled&&handleSuggestionClick(s.text),disabled:isDisabled,className:`${baseClasses} ${isDisabled?disabledClasses:selectedClasses}`,children:s.text},`refinement-${i}-${s.text}`);})}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full flex justify-center mb-4\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:handleRegenerateRefinementSuggestions,disabled:loadingRefinementSuggestions,className:\"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed\",title:\"Generate new suggestions\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"})}),loadingRefinementSuggestions?'Generating...':'New Suggestions']})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"px-4 py-2 rounded-lg bg-blue-600 text-white font-bold shadow-md hover:bg-blue-700 transition disabled:opacity-60 flex-1\",onClick:async()=>{setGenerating(true);// Regenerate proposal with selected suggestions\nawait handleGenerateWithAI();},disabled:generating,children:generating?'Generating...':'Refine'}),/*#__PURE__*/_jsx(\"button\",{className:\"px-4 py-2 rounded-lg bg-gray-200 text-gray-700 font-bold shadow-md hover:bg-gray-300 transition\",onClick:()=>{setProposalText('');setSelectedSuggestions([]);setUploadedPdfContent('');setShowContent(false);setGeneratedContent({executiveSummary:'',approach:'',budgetDetails:'',timeline:'',fullContent:''});},disabled:generating,children:\"New\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-xl border border-gray-100 p-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-extrabold text-gray-900\",children:\"Generated Proposal\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-3 h-3 bg-green-500 rounded-full animate-pulse\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-green-600 font-medium\",children:\"Ready\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-50 rounded-xl p-6 max-h-[500px] overflow-y-auto custom-scrollbar\",children:/*#__PURE__*/_jsx(\"div\",{className:\"prose prose-gray max-w-none\",children:/*#__PURE__*/_jsx(ReactMarkdown,{remarkPlugins:[remarkGfm],components:{h1:_ref=>{let{children}=_ref;return/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900 mb-4 mt-0\",children:children});},h2:_ref2=>{let{children}=_ref2;return/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-900 mb-3 mt-6\",children:children});},h3:_ref3=>{let{children}=_ref3;return/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-2 mt-4\",children:children});},p:_ref4=>{let{children}=_ref4;return/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-700 leading-7 mb-3\",children:children});},ul:_ref5=>{let{children}=_ref5;return/*#__PURE__*/_jsx(\"ul\",{className:\"list-disc list-inside text-gray-700 leading-7 mb-3 space-y-1\",children:children});},ol:_ref6=>{let{children}=_ref6;return/*#__PURE__*/_jsx(\"ol\",{className:\"list-decimal list-inside text-gray-700 leading-7 mb-3 space-y-1\",children:children});},li:_ref7=>{let{children}=_ref7;return/*#__PURE__*/_jsx(\"li\",{className:\"text-gray-700\",children:children});},strong:_ref8=>{let{children}=_ref8;return/*#__PURE__*/_jsx(\"strong\",{className:\"font-semibold text-gray-900\",children:children});},em:_ref9=>{let{children}=_ref9;return/*#__PURE__*/_jsx(\"em\",{className:\"italic text-gray-700\",children:children});}},children:generatedContent.fullContent})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 mt-6\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleSaveDraft,disabled:savingDraft,className:\"px-4 py-2 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700 transition disabled:opacity-60 flex-1\",children:savingDraft?'Saving...':'Save Draft'}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowEmailModal(true),className:\"px-4 py-2 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition\",children:\"Send Email\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleDownloadPdf,disabled:downloadingPdf,className:\"px-4 py-2 bg-purple-600 text-white rounded-lg font-semibold hover:bg-purple-700 transition disabled:opacity-60\",children:downloadingPdf?'Downloading...':'Download PDF'})]})]})]}),generating&&!showContent&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center justify-center py-12 w-full\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 animate-ping\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 bg-gradient-to-r from-blue-400 to-purple-500 rounded-full opacity-20\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 animate-ping\",style:{animationDelay:'0.5s'},children:/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 bg-gradient-to-r from-purple-400 to-pink-500 rounded-full opacity-20\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 bg-white rounded-full\"})})]}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-900 mt-6 mb-2\",children:\"Generating Your Proposal\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 text-center max-w-md\",children:\"Our AI is crafting a professional proposal tailored to your requirements. This may take a few moments...\"})]}),generating&&showContent&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl p-8 max-w-md mx-4 text-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative mb-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 animate-ping\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 bg-gradient-to-r from-blue-400 to-purple-500 rounded-full opacity-20\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 animate-ping\",style:{animationDelay:'0.5s'},children:/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 bg-gradient-to-r from-purple-400 to-pink-500 rounded-full opacity-20\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center mx-auto\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 bg-white rounded-full\"})})]}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-900 mb-2\",children:\"Refining Your Proposal\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Our AI is refining your proposal with the selected improvements. This may take a few moments...\"})]})}),showEmailModal&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl shadow-lg p-8 w-full max-w-md\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold mb-4\",children:\"Send Proposal via Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",className:\"w-full border border-gray-300 rounded-lg px-3 py-2 mb-4 focus:outline-none focus:ring-2 focus:ring-blue-400\",placeholder:\"Recipient's email address\",value:email,onChange:e=>setEmail(e.target.value),disabled:sendingEmail}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 justify-end\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowEmailModal(false),className:\"px-4 py-2 rounded-lg bg-gray-200 text-gray-700 font-semibold hover:bg-gray-300 transition\",disabled:sendingEmail,children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSendEmail,className:\"px-4 py-2 rounded-lg bg-blue-600 text-white font-semibold shadow hover:bg-blue-700 transition disabled:opacity-60\",disabled:sendingEmail,children:sendingEmail?'Sending...':'Send'})]})]})})]}),/*#__PURE__*/_jsx(\"style\",{children:`\n        .custom-scrollbar::-webkit-scrollbar {\n          width: 6px;\n        }\n        .custom-scrollbar::-webkit-scrollbar-track {\n          background: #f1f5f9;\n          border-radius: 3px;\n        }\n        .custom-scrollbar::-webkit-scrollbar-thumb {\n          background: #cbd5e1;\n          border-radius: 3px;\n        }\n        .custom-scrollbar::-webkit-scrollbar-thumb:hover {\n          background: #94a3b8;\n        }\n      `})]});};export default Dashboard;","map":{"version":3,"names":["React","useState","useEffect","toast","ReactMarkdown","remarkGfm","getOpenRouterChatCompletion","proposalsAPI","jsx","_jsx","jsxs","_jsxs","htmlToMarkdown","input","replace","Dashboard","proposalText","setProposalText","generating","setGenerating","showContent","setShowContent","generatedContent","setGeneratedContent","executiveSummary","approach","budgetDetails","timeline","fullContent","savingDraft","setSavingDraft","sendingEmail","setSendingEmail","downloadingPdf","setDownloadingPdf","showEmailModal","setShowEmailModal","email","setEmail","proposalId","setProposalId","selectedSuggestions","setSelectedSuggestions","loadingSuggestions","setLoadingSuggestions","loadingRefinementSuggestions","setLoadingRefinementSuggestions","uploadingPdf","setUploadingPdf","uploadedPdfContent","setUploadedPdfContent","predefinedSuggestions","setPredefinedSuggestions","refinementSuggestions","setRefinementSuggestions","generateSuggestionsFromDrafts","_aiResponse$choices$","_aiResponse$choices$$","console","log","response","fetch","headers","localStorage","getItem","ok","Error","data","json","drafts","length","generateSuggestions","recentDrafts","slice","draftContent","map","draft","content","filter","trim","join","messages","role","aiResponse","aiSuggestions","choices","message","suggestions","split","line","suggestion","index","colors","icons","className","fill","stroke","viewBox","children","strokeLinecap","strokeLinejoin","strokeWidth","d","text","icon","color","error","_response$choices$","_response$choices$$me","generateRefinementSuggestions","proposalContent","_response$choices$2","_response$choices$2$m","handlePdfUpload","event","_event$target$files","file","target","files","type","formData","FormData","append","method","body","extractedText","success","value","handleSuggestionClick","prev","includes","s","handleRegenerateSuggestions","handleRegenerateRefinementSuggestions","combinedContent","handleGenerateWithAI","_response$choices$3","_response$choices$3$m","_execMatch$","_approachMatch$","_budgetMatch$","_timelineMatch$","systemPrompt","userPrompt","aiContent","execMatch","match","approachMatch","budgetMatch","timelineMatch","cleanContent","Boolean","setTimeout","handleSaveDraft","payload","title","description","clientName","status","update","create","id","handleSendEmail","sendEmail","recipientEmail","handleDownloadPdf","_link$parentNode","downloadPDF","url","window","URL","createObjectURL","Blob","link","document","createElement","href","setAttribute","appendChild","click","parentNode","removeChild","revokeObjectURL","handleLogout","removeItem","location","initializeSuggestions","onClick","placeholder","onChange","e","disabled","accept","htmlFor","Array","from","_","i","style","width","isSelected","isDisabled","baseClasses","selectedClasses","disabledClasses","minWidth","minHeight","remarkPlugins","components","h1","_ref","h2","_ref2","h3","_ref3","p","_ref4","ul","_ref5","ol","_ref6","li","_ref7","strong","_ref8","em","_ref9","animationDelay"],"sources":["/Users/davnishsingh/Documents/proposalai-main/client/src/pages/Dashboard.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { toast } from 'react-hot-toast';\nimport ReactMarkdown from 'react-markdown';\nimport remarkGfm from 'remark-gfm';\nimport { getOpenRouterChatCompletion } from '../services/api';\nimport { proposalsAPI } from '../services/api';\nimport '../ProposalMarkdown.css';\n\n// Utility to convert HTML tags to markdown\nfunction htmlToMarkdown(input: string): string {\n  return input\n    .replace(/<strong>(.*?)<\\/strong>/gi, '**$1**')\n    .replace(/<b>(.*?)<\\/b>/gi, '**$1**')\n    .replace(/<em>(.*?)<\\/em>/gi, '*$1*')\n    .replace(/<i>(.*?)<\\/i>/gi, '*$1*')\n    .replace(/<br\\s*\\/?>(\\s*)/gi, '\\n')\n    .replace(/<[^>]+>/g, '') // Remove any other HTML tags\n    .replace(/\\n{3,}/g, '\\n\\n'); // Collapse excessive newlines\n}\n\nconst Dashboard: React.FC = () => {\n  const [proposalText, setProposalText] = useState('');\n  const [generating, setGenerating] = useState(false);\n  const [showContent, setShowContent] = useState(false);\n  const [generatedContent, setGeneratedContent] = useState({\n    executiveSummary: '',\n    approach: '',\n    budgetDetails: '',\n    timeline: '',\n    fullContent: '' // Added for react-markdown\n  });\n  const [savingDraft, setSavingDraft] = useState(false);\n  const [sendingEmail, setSendingEmail] = useState(false);\n  const [downloadingPdf, setDownloadingPdf] = useState(false);\n  const [showEmailModal, setShowEmailModal] = useState(false);\n  const [email, setEmail] = useState('');\n  const [proposalId, setProposalId] = useState<string | null>(null);\n  const [selectedSuggestions, setSelectedSuggestions] = useState<string[]>([]);\n  const [loadingSuggestions, setLoadingSuggestions] = useState(false);\n  const [loadingRefinementSuggestions, setLoadingRefinementSuggestions] = useState(false);\n  const [uploadingPdf, setUploadingPdf] = useState(false);\n  const [uploadedPdfContent, setUploadedPdfContent] = useState<string>('');\n\n  // State for suggestions\n  const [predefinedSuggestions, setPredefinedSuggestions] = useState<Array<{\n    text: string;\n    icon: React.ReactNode;\n    color: 'blue' | 'green' | 'purple' | 'orange' | 'red' | 'yellow';\n  }>>([]);\n  \n  const [refinementSuggestions, setRefinementSuggestions] = useState<Array<{\n    text: string;\n    icon: React.ReactNode;\n    color: 'blue' | 'green' | 'purple' | 'orange' | 'red' | 'yellow';\n  }>>([]);\n\n  // Generate AI-based suggestions based on existing drafts\n  const generateSuggestionsFromDrafts = async () => {\n    try {\n      console.log('Starting draft-based suggestion generation...');\n      \n      // Fetch existing drafts to analyze\n      const response = await fetch('/api/proposals/drafts', {\n        headers: {\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\n        }\n      });\n      \n      if (!response.ok) {\n        throw new Error('Failed to fetch drafts');\n      }\n      \n      const data = await response.json();\n      const drafts = data.data || [];\n      \n      if (drafts.length === 0) {\n        // If no drafts exist, fall back to generic suggestions\n        await generateSuggestions();\n        return;\n      }\n      \n      // Combine content from recent drafts for analysis\n      const recentDrafts = drafts.slice(0, 3); // Take last 3 drafts\n      const draftContent = recentDrafts\n        .map((draft: any) => draft.content || draft.fullContent || '')\n        .filter((content: string) => content.trim())\n        .join('\\n\\n');\n      \n      const messages = [\n        {\n          role: 'system',\n          content: 'You are an expert proposal writer. Based on the provided existing proposal drafts, generate 8 specific, actionable suggestions for improving future proposals. Each suggestion should be concise (2-4 words) and focus on different aspects like content, structure, persuasion, and professionalism. Return only the suggestions, one per line, without numbering or bullet points.'\n        },\n        {\n          role: 'user',\n          content: `Generate 8 proposal improvement suggestions based on these existing drafts:\\n\\n${draftContent}`\n        }\n      ];\n      \n      console.log('Calling OpenRouter API for draft-based suggestions...');\n      const aiResponse = await getOpenRouterChatCompletion(messages);\n      const aiSuggestions = aiResponse.choices[0]?.message?.content || '';\n      console.log('AI Draft-Based Response:', aiSuggestions);\n      \n      // Parse AI suggestions and create suggestion objects\n      const suggestions = aiSuggestions\n        .split('\\n')\n        .filter((line: string) => line.trim())\n        .slice(0, 8)\n        .map((suggestion: string, index: number) => {\n          const colors: Array<'blue' | 'green' | 'purple' | 'orange' | 'red' | 'yellow'> = ['blue', 'green', 'purple', 'orange', 'red', 'yellow'];\n          const icons = [\n            <svg key=\"icon1\" className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n            </svg>,\n            <svg key=\"icon2\" className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1\" />\n            </svg>,\n            <svg key=\"icon3\" className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\" />\n            </svg>,\n            <svg key=\"icon4\" className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10\" />\n            </svg>,\n            <svg key=\"icon5\" className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z\" />\n            </svg>,\n            <svg key=\"icon6\" className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\" />\n            </svg>,\n            <svg key=\"icon7\" className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\" />\n            </svg>,\n            <svg key=\"icon8\" className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 7l5 5m0 0l-5 5m5-5H6\" />\n            </svg>\n          ];\n          \n          return {\n            text: suggestion.trim(),\n            icon: icons[index % icons.length],\n            color: colors[index % colors.length]\n          };\n        });\n      \n      console.log('Parsed draft-based suggestions:', suggestions);\n      setPredefinedSuggestions(suggestions);\n    } catch (error) {\n      console.error('Error generating draft-based suggestions:', error);\n      // Fall back to generic suggestions if draft-based generation fails\n      await generateSuggestions();\n    }\n  };\n\n  // Generate AI-based suggestions (generic)\n  const generateSuggestions = async () => {\n    try {\n      console.log('Starting AI suggestion generation...');\n      const messages = [\n        {\n          role: 'system',\n          content: 'You are an expert proposal writer. Generate 8 specific, actionable suggestions for improving a business proposal. Each suggestion should be concise (2-4 words) and focus on different aspects like content, structure, persuasion, and professionalism. Return only the suggestions, one per line, without numbering or bullet points.'\n        },\n        {\n          role: 'user',\n          content: 'Generate 8 proposal improvement suggestions.'\n        }\n      ];\n      \n      console.log('Calling OpenRouter API...');\n      const response = await getOpenRouterChatCompletion(messages);\n      const aiSuggestions = response.choices[0]?.message?.content || '';\n      console.log('AI Response:', aiSuggestions);\n      \n      // Parse AI suggestions and create suggestion objects\n      const suggestions = aiSuggestions\n        .split('\\n')\n        .filter((line: string) => line.trim())\n        .slice(0, 8)\n        .map((suggestion: string, index: number) => {\n          const colors: Array<'blue' | 'green' | 'purple' | 'orange' | 'red' | 'yellow'> = ['blue', 'green', 'purple', 'orange', 'red', 'yellow'];\n          const icons = [\n            <svg key=\"icon1\" className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n            </svg>,\n            <svg key=\"icon2\" className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1\" />\n            </svg>,\n            <svg key=\"icon3\" className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\" />\n            </svg>,\n            <svg key=\"icon4\" className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10\" />\n            </svg>,\n            <svg key=\"icon5\" className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z\" />\n            </svg>,\n            <svg key=\"icon6\" className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\" />\n            </svg>,\n            <svg key=\"icon7\" className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\" />\n            </svg>,\n            <svg key=\"icon8\" className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 7l5 5m0 0l-5 5m5-5H6\" />\n            </svg>\n          ];\n          \n          return {\n            text: suggestion.trim(),\n            icon: icons[index % icons.length],\n            color: colors[index % colors.length]\n          };\n        });\n      \n      console.log('Parsed suggestions:', suggestions);\n      setPredefinedSuggestions(suggestions);\n    } catch (error) {\n      console.error('Error generating suggestions:', error);\n      // Fallback to basic suggestions if AI fails\n      setPredefinedSuggestions([\n        {\n          text: \"Add Executive Summary\",\n          icon: <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n          </svg>,\n          color: 'blue' as const\n        },\n        {\n          text: \"Include Budget Details\",\n          icon: <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1\" />\n          </svg>,\n          color: 'green' as const\n        },\n        {\n          text: \"Add Timeline Section\",\n          icon: <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\" />\n          </svg>,\n          color: 'purple' as const\n        }\n      ]);\n    }\n  };\n\n  // Generate AI-based refinement suggestions\n  const generateRefinementSuggestions = async (proposalContent: string) => {\n    try {\n      console.log('Starting refinement suggestion generation...');\n      console.log('Proposal content:', proposalContent);\n      const messages = [\n        {\n          role: 'system',\n          content: 'You are an expert proposal writer. Based on the provided proposal content, generate 8 specific, actionable suggestions for refining and improving the proposal. Each suggestion should be concise (2-4 words) and focus on different aspects like clarity, persuasion, structure, and impact. Return only the suggestions, one per line, without numbering or bullet points.'\n        },\n        {\n          role: 'user',\n          content: `Generate 8 refinement suggestions for this proposal:\\n\\n${proposalContent}`\n        }\n      ];\n      \n      console.log('Calling OpenRouter API for refinement...');\n      const response = await getOpenRouterChatCompletion(messages);\n      const aiSuggestions = response.choices[0]?.message?.content || '';\n      console.log('AI Refinement Response:', aiSuggestions);\n      \n      // Parse AI suggestions and create suggestion objects\n      const suggestions = aiSuggestions\n        .split('\\n')\n        .filter((line: string) => line.trim())\n        .slice(0, 8)\n        .map((suggestion: string, index: number) => {\n          const colors: Array<'blue' | 'green' | 'purple' | 'orange' | 'red' | 'yellow'> = ['blue', 'green', 'purple', 'orange', 'red', 'yellow'];\n          const icons = [\n            <svg key=\"icon1\" className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\" />\n            </svg>,\n            <svg key=\"icon2\" className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\" />\n            </svg>,\n            <svg key=\"icon3\" className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z\" />\n            </svg>,\n            <svg key=\"icon4\" className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10\" />\n            </svg>,\n            <svg key=\"icon5\" className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 10V3L4 14h7v7l9-11h-7z\" />\n            </svg>,\n            <svg key=\"icon6\" className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 7l5 5m0 0l-5 5m5-5H6\" />\n            </svg>\n          ];\n          \n          return {\n            text: suggestion.trim(),\n            icon: icons[index % icons.length],\n            color: colors[index % colors.length]\n          };\n        });\n      \n      console.log('Parsed refinement suggestions:', suggestions);\n      setRefinementSuggestions(suggestions);\n    } catch (error) {\n      console.error('Error generating refinement suggestions:', error);\n      // Fallback to basic refinement suggestions if AI fails\n      setRefinementSuggestions([\n        {\n          text: \"Enhance Executive Summary\",\n          icon: <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\" />\n          </svg>,\n          color: 'blue' as const\n        },\n        {\n          text: \"Add More Details\",\n          icon: <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\" />\n          </svg>,\n          color: 'green' as const\n        },\n        {\n          text: \"Improve Clarity\",\n          icon: <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z\" />\n          </svg>,\n          color: 'purple' as const\n        },\n        {\n          text: \"Strengthen Budget\",\n          icon: <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10\" />\n          </svg>,\n          color: 'orange' as const\n        },\n        {\n          text: \"Add Timeline Details\",\n          icon: <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 10V3L4 14h7v7l9-11h-7z\" />\n          </svg>,\n          color: 'red' as const\n        },\n        {\n          text: \"Include Case Studies\",\n          icon: <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 7l5 5m0 0l-5 5m5-5H6\" />\n          </svg>,\n          color: 'yellow' as const\n        },\n        {\n          text: \"Add Testimonials\",\n          icon: <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\" />\n          </svg>,\n          color: 'blue' as const\n        },\n        {\n          text: \"Improve Structure\",\n          icon: <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n          </svg>,\n          color: 'green' as const\n        }\n      ]);\n    }\n  };\n\n  // Handle PDF file upload and extraction\n  const handlePdfUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file) return;\n\n    if (file.type !== 'application/pdf') {\n      toast.error('Please upload a PDF file');\n      return;\n    }\n\n    setUploadingPdf(true);\n    try {\n      const formData = new FormData();\n      formData.append('pdf', file);\n\n      // Call backend API to extract text from PDF\n      const response = await fetch('/api/proposals/extract-pdf', {\n        method: 'POST',\n        body: formData,\n        headers: {\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\n        }\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to extract PDF content');\n      }\n\n      const data = await response.json();\n      const extractedText = data.content || data.text || '';\n      \n      if (extractedText.trim()) {\n        setUploadedPdfContent(extractedText);\n        toast.success('PDF uploaded successfully! You can now generate a refined proposal.');\n      } else {\n        toast.error('No readable text found in the PDF');\n      }\n    } catch (error) {\n      console.error('PDF extraction error:', error);\n      toast.error('Failed to extract PDF content. Please try again.');\n    } finally {\n      setUploadingPdf(false);\n      // Reset the file input\n      event.target.value = '';\n    }\n  };\n\n  // Handle suggestion bubble click (select/unselect up to 5)\n  const handleSuggestionClick = (suggestion: string) => {\n    setSelectedSuggestions(prev => \n      prev.includes(suggestion) \n        ? prev.filter(s => s !== suggestion)\n        : prev.length < 5 \n          ? [...prev, suggestion]\n          : prev\n    );\n  };\n\n  // Handle regeneration of suggestions\n  const handleRegenerateSuggestions = async () => {\n    setLoadingSuggestions(true);\n    setSelectedSuggestions([]);\n    \n    try {\n      console.log('Regenerating draft-based suggestions...');\n      await generateSuggestionsFromDrafts(); // Use draft-based generation\n      toast.success('New AI-generated suggestions based on your drafts loaded!');\n    } catch (error) {\n      console.error('Error regenerating draft-based suggestions:', error);\n      toast.error('Failed to regenerate suggestions');\n    } finally {\n      setLoadingSuggestions(false);\n    }\n  };\n\n  // Handle regeneration of refinement suggestions\n  const handleRegenerateRefinementSuggestions = async () => {\n    setLoadingRefinementSuggestions(true);\n    setSelectedSuggestions([]);\n    \n    try {\n      console.log('Regenerating refinement suggestions...');\n      const combinedContent = uploadedPdfContent.trim() \n        ? `${proposalText.trim() ? proposalText.trim() + '\\n\\n' : ''}PDF Content:\\n${uploadedPdfContent.trim()}`\n        : proposalText.trim() || 'business proposal'; // Fallback content if nothing is provided\n      await generateRefinementSuggestions(combinedContent); // Call the AI generation function\n      toast.success('New AI-generated refinement suggestions loaded!');\n    } catch (error) {\n      console.error('Error regenerating refinement suggestions:', error);\n      toast.error('Failed to regenerate refinement suggestions');\n    } finally {\n      setLoadingRefinementSuggestions(false);\n    }\n  };\n\n  const handleGenerateWithAI = async () => {\n    // Check if we have either user input or uploaded PDF content\n    if (!proposalText.trim() && !uploadedPdfContent.trim()) {\n      toast.error('Please enter a proposal description or upload a PDF before generating content');\n      return;\n    }\n    \n    try {\n      setGenerating(true);\n      \n      // Combine user input and uploaded PDF content\n      const combinedContent = uploadedPdfContent.trim() \n        ? `${proposalText.trim() ? proposalText.trim() + '\\n\\n' : ''}PDF Content:\\n${uploadedPdfContent.trim()}`\n        : proposalText.trim();\n      \n      // If there are selected suggestions, use them to refine the proposal\n      let systemPrompt = `You are an expert proposal writer. Generate a professional proposal with these sections: Executive Summary, Approach, Budget Details, Timeline. Use clear, persuasive language.`;\n      \n      let userPrompt = `Content: ${combinedContent}\\n\\nGenerate a professional proposal with: 1. Executive Summary 2. Approach 3. Budget Details 4. Timeline`;\n      \n      // If there are selected suggestions, modify the prompt to include them\n      if (selectedSuggestions.length > 0) {\n        systemPrompt = `You are an expert proposal writer. Generate a professional proposal incorporating these refinements: ${selectedSuggestions.map(s => `\"${s}\"`).join(', ')}. Include: Executive Summary, Approach, Budget Details, Timeline.`;\n        userPrompt = `Content: ${combinedContent}\\n\\nRefinements: ${selectedSuggestions.join(', ')}\\n\\nGenerate proposal with: 1. Executive Summary 2. Approach 3. Budget Details 4. Timeline`;\n      }\n      \n      // Compose prompt for OpenRouter\n      const messages = [\n        {\n          role: 'system',\n          content: systemPrompt,\n        },\n        {\n          role: 'user',\n          content: userPrompt,\n        },\n      ];\n      const response = await getOpenRouterChatCompletion(messages);\n      const aiContent = response.choices[0]?.message?.content || '';\n      let executiveSummary = '', approach = '', budgetDetails = '', timeline = '';\n      const execMatch = aiContent.match(/(?:Executive Summary|EXECUTIVE SUMMARY)[:\\s\\n]*([\\s\\S]*?)(?=\\n\\s*(?:Approach|APPROACH|Budget|BUDGET|Timeline|TIMELINE|Next Steps|NEXT STEPS)[:\\s\\n]|$)/i);\n      const approachMatch = aiContent.match(/(?:Approach|APPROACH|Methodology|METHODOLOGY)[:\\s\\n]*([\\s\\S]*?)(?=\\n\\s*(?:Budget|BUDGET|Timeline|TIMELINE|Next Steps|NEXT STEPS)[:\\s\\n]|$)/i);\n      const budgetMatch = aiContent.match(/(?:Budget Details?|BUDGET DETAILS?|Pricing|PRICING)[:\\s\\n]*([\\s\\S]*?)(?=\\n\\s*(?:Timeline|TIMELINE|Next Steps|NEXT STEPS)[:\\s\\n]|$)/i);\n      const timelineMatch = aiContent.match(/(?:Timeline|TIMELINE|Schedule|SCHEDULE)[:\\s\\n]*([\\s\\S]*?)(?=\\n\\s*(?:Next Steps|NEXT STEPS|Conclusion|CONCLUSION)[:\\s\\n]|$)/i);\n      executiveSummary = execMatch?.[1]?.trim() || '';\n      approach = approachMatch?.[1]?.trim() || '';\n      budgetDetails = budgetMatch?.[1]?.trim() || '';\n      timeline = timelineMatch?.[1]?.trim() || '';\n      const cleanContent = (text: string) => {\n        return text\n          .replace(/\\n{3,}/g, '\\n\\n')\n          .replace(/^\\s+|\\s+$/g, '')\n          .replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>')\n          .replace(/\\*(.*?)\\*/g, '<em>$1</em>');\n      };\n      setGeneratedContent({\n        executiveSummary: htmlToMarkdown(cleanContent(executiveSummary)),\n        approach: htmlToMarkdown(cleanContent(approach)),\n        budgetDetails: htmlToMarkdown(cleanContent(budgetDetails)),\n        timeline: htmlToMarkdown(cleanContent(timeline)),\n        fullContent: [\n          htmlToMarkdown(cleanContent(executiveSummary)),\n          htmlToMarkdown(cleanContent(approach)),\n          htmlToMarkdown(cleanContent(budgetDetails)),\n          htmlToMarkdown(cleanContent(timeline))\n        ].filter(Boolean).join('\\n\\n')\n      });\n      setTimeout(() => {\n        setShowContent(true);\n      }, 500);\n      toast.success('Proposal generated successfully!');\n      // Generate refinement suggestions for the new proposal\n      generateRefinementSuggestions(aiContent);\n    } catch (error) {\n      console.error('Error generating proposal:', error);\n      \n      // Handle specific OpenRouter credit limit error\n      if (error instanceof Error && error.message.includes('OpenRouter credits exhausted')) {\n        toast.error('AI service credits exhausted. Please visit OpenRouter to add more credits or try again later.');\n      } else {\n        toast.error('Failed to generate proposal content. Please try again.');\n      }\n    } finally {\n      setGenerating(false);\n    }\n  };\n\n  // Save as Draft handler\n  const handleSaveDraft = async () => {\n    setSavingDraft(true);\n    try {\n      const payload = {\n        title: proposalText.slice(0, 60) || 'Untitled Proposal',\n        description: proposalText,\n        clientName: 'Client', // Optionally make this dynamic\n        type: 'PROPOSAL',\n        status: 'DRAFT',\n        content: generatedContent.fullContent,\n      };\n      let response;\n      if (proposalId) {\n        response = await proposalsAPI.update(proposalId, payload);\n      } else {\n        response = await proposalsAPI.create(payload);\n        setProposalId(response.data.data.id);\n      }\n      toast.success('Proposal saved as draft!');\n    } catch (error) {\n      toast.error('Failed to save draft.');\n    } finally {\n      setSavingDraft(false);\n    }\n  };\n\n  // Send as Email handler\n  const handleSendEmail = async () => {\n    if (!email) {\n      toast.error('Please enter a valid email address.');\n      return;\n    }\n    if (!proposalId) {\n      toast.error('Please save the proposal as draft first.');\n      return;\n    }\n    setSendingEmail(true);\n    try {\n      await proposalsAPI.sendEmail(proposalId, { recipientEmail: email });\n      toast.success('Proposal sent via email!');\n      setShowEmailModal(false);\n      setEmail('');\n    } catch (error) {\n      toast.error('Failed to send email.');\n    } finally {\n      setSendingEmail(false);\n    }\n  };\n\n  // Download as PDF handler\n  const handleDownloadPdf = async () => {\n    if (!proposalId) {\n      toast.error('Please save the proposal as draft first.');\n      return;\n    }\n    setDownloadingPdf(true);\n    try {\n      const response = await proposalsAPI.downloadPDF(proposalId);\n      const url = window.URL.createObjectURL(new Blob([response.data], { type: 'application/pdf' }));\n      const link = document.createElement('a');\n      link.href = url;\n      link.setAttribute('download', 'proposal.pdf');\n      document.body.appendChild(link);\n      link.click();\n      link.parentNode?.removeChild(link);\n      window.URL.revokeObjectURL(url);\n      toast.success('PDF downloaded!');\n    } catch (error) {\n      toast.error('Failed to download PDF.');\n    } finally {\n      setDownloadingPdf(false);\n    }\n  };\n\n  const handleLogout = () => {\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n    window.location.href = '/login';\n  };\n\n  // After proposal is generated, generate suggestions\n  useEffect(() => {\n    // Initialize suggestions on component load\n    const initializeSuggestions = async () => {\n      try {\n        console.log('Initializing suggestions...');\n        setLoadingSuggestions(true);\n        \n        await generateSuggestionsFromDrafts(); // Call the new draft-based generation function\n        \n        console.log('Suggestions initialized successfully');\n      } catch (error) {\n        console.error('Error initializing suggestions:', error);\n      } finally {\n        setLoadingSuggestions(false);\n      }\n    };\n    \n    initializeSuggestions();\n  }, []);\n\n  // REMOVED: Auto-generation useEffect that was causing unwanted generation when typing\n  // Now generation only happens when user explicitly clicks Generate/Refine button\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 flex flex-col\">\n      {/* Top Navigation Bar */}\n      <nav className=\"bg-gradient-to-r from-blue-600 to-blue-400 shadow-lg w-full z-10\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"flex justify-between items-center h-16\">\n            <div className=\"flex items-center\">\n              <h1 className=\"text-xl font-extrabold text-white tracking-wider drop-shadow\">ProposalAI</h1>\n            </div>\n            <div className=\"flex items-center space-x-8\">\n              <a href=\"/dashboard\" className=\"text-white font-semibold border-b-2 border-white/80 pb-1 transition-colors\">Dashboard</a>\n              <a href=\"/drafts\" className=\"text-white/80 hover:text-white transition-colors\">Drafts</a>\n              <a href=\"/sent-proposals\" className=\"text-white/80 hover:text-white transition-colors\">Sent Proposals</a>\n              <a href=\"/profile\" className=\"text-white/80 hover:text-white transition-colors\">Profile</a>\n              <button \n                onClick={handleLogout}\n                className=\"text-white/80 hover:text-white transition-colors\"\n              >\n                Logout\n              </button>\n            </div>\n          </div>\n        </div>\n      </nav>\n      {/* Main Content */}\n      <div className=\"w-full max-w-[1400px] mx-auto py-8 px-4 sm:px-8\">\n        {!showContent ? (\n          // Single centered card when no content is generated\n          <div className=\"flex flex-col items-center justify-center min-h-[80vh]\">\n            <div className=\"w-full max-w-6xl bg-white/90 rounded-2xl shadow-xl border border-gray-100 p-10 flex flex-col items-center justify-center min-h-[480px] mx-auto\">\n              <h2 className=\"text-3xl font-extrabold text-gray-900 mb-6 text-center tracking-tight\">What can I help with?</h2>\n              \n              {/* Text box with integrated PDF upload */}\n              <div className=\"w-full relative mb-4\">\n                {/* PDF Upload Status - moved above text box */}\n                {uploadedPdfContent && (\n                  <div className=\"flex items-center gap-2 text-sm text-green-600 bg-green-50 px-3 py-2 rounded-lg mb-2\">\n                    <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                    </svg>\n                    PDF uploaded successfully\n                  </div>\n                )}\n                \n                <textarea\n                  className=\"w-full h-[180px] rounded-lg border border-gray-200 px-4 py-3 text-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition bg-gray-50 resize-none font-normal\"\n                  placeholder=\"Ask ProposalAI or type / to see prompts...\"\n                  value={proposalText}\n                  onChange={e => setProposalText(e.target.value)}\n                  disabled={generating}\n                />\n                \n                {/* PDF Upload Button inside text box */}\n                <div className=\"absolute bottom-3 right-3\">\n                  <input\n                    type=\"file\"\n                    accept=\".pdf\"\n                    onChange={handlePdfUpload}\n                    className=\"hidden\"\n                    id=\"pdf-upload\"\n                    disabled={uploadingPdf}\n                  />\n                  <label\n                    htmlFor=\"pdf-upload\"\n                    className={`inline-flex items-center justify-center w-8 h-8 rounded-full transition cursor-pointer ${\n                      uploadingPdf \n                        ? 'bg-gray-100 opacity-50 cursor-not-allowed' \n                        : uploadedPdfContent \n                        ? 'bg-green-100 hover:bg-green-200' \n                        : 'bg-gray-100 hover:bg-gray-200'\n                    }`}\n                    title={uploadedPdfContent ? \"PDF uploaded - Click to replace\" : \"Upload PDF\"}\n                  >\n                    {uploadingPdf ? (\n                      <div className=\"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin\"></div>\n                    ) : uploadedPdfContent ? (\n                      <svg className=\"w-4 h-4 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                      </svg>\n                    ) : (\n                      <svg className=\"w-4 h-4 text-gray-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12\" />\n                      </svg>\n                    )}\n                  </label>\n                </div>\n              </div>\n\n              {/* Initial Suggestions - SMALL TAGS STYLING */}\n              {!showContent && (\n                <div className=\"mb-6\">\n                  <div className=\"flex flex-wrap gap-2\">\n                    {loadingSuggestions ? (\n                      // Loading placeholders\n                      Array.from({ length: 8 }).map((_, i) => (\n                        <div key={i} className=\"px-3 py-1.5 rounded-full border border-gray-200 bg-gray-100 animate-pulse inline-flex items-center\">\n                          <div className=\"h-3 bg-gray-200 rounded animate-pulse\" style={{ width: `${60 + (i * 10)}px` }}></div>\n                        </div>\n                      ))\n                    ) : predefinedSuggestions.length > 0 ? (\n                      predefinedSuggestions.map((suggestion, i) => {\n                        const isSelected = selectedSuggestions.includes(suggestion.text);\n                        const isDisabled = !isSelected && selectedSuggestions.length >= 5;\n                        \n                        // Small, transparent styling for initial suggestions\n                        const baseClasses = \"px-3 py-1.5 rounded-full text-xs font-medium transition-all duration-200 cursor-pointer border\";\n                        const selectedClasses = isSelected \n                          ? \"bg-blue-100 text-blue-700 border-blue-300 shadow-sm\" \n                          : \"bg-gray-50 text-gray-600 border-gray-200 hover:bg-gray-100 hover:border-gray-300\";\n                        const disabledClasses = isDisabled \n                          ? \"opacity-40 cursor-not-allowed bg-gray-50 text-gray-400 border-gray-200\" \n                          : \"\";\n                        \n                        return (\n                          <button\n                            key={`initial-${i}-${suggestion.text}`}\n                            onClick={() => !isDisabled && handleSuggestionClick(suggestion.text)}\n                            disabled={isDisabled}\n                            className={`${baseClasses} ${isDisabled ? disabledClasses : selectedClasses}`}\n                          >\n                            {suggestion.text}\n                          </button>\n                        );\n                      })\n                    ) : (\n                      // Empty state\n                      <div className=\"text-center text-gray-500 py-4 font-normal\">\n                        No suggestions available. Click \"New Suggestions\" to generate some.\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n\n              {/* Refinement Suggestions - SMALL TAGS STYLING */}\n              {showContent && (\n                <div className=\"mb-6\">\n                  <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3\">\n                    {loadingRefinementSuggestions ? (\n                      // Loading placeholders\n                      <div className=\"col-span-full flex flex-wrap gap-2\">\n                        {Array.from({ length: 8 }).map((_, i) => (\n                          <div key={i} className=\"px-3 py-1.5 rounded-full border border-gray-200 bg-gray-100 animate-pulse inline-flex items-center\">\n                            <div className=\"h-3 bg-gray-200 rounded animate-pulse\" style={{ width: `${60 + (i * 10)}px` }}></div>\n                          </div>\n                        ))}\n                      </div>\n                    ) : refinementSuggestions.length > 0 ? (\n                      <div className=\"col-span-full flex flex-wrap gap-2\">\n                        {refinementSuggestions.map((suggestion, i) => {\n                          const isSelected = selectedSuggestions.includes(suggestion.text);\n                          const isDisabled = !isSelected && selectedSuggestions.length >= 5;\n                          \n                          // Small, transparent styling for refinement suggestions\n                          const baseClasses = \"px-3 py-1.5 rounded-full text-xs font-medium transition-all duration-200 cursor-pointer border\";\n                          const selectedClasses = isSelected \n                            ? \"bg-blue-100 text-blue-700 border-blue-300 shadow-sm\" \n                            : \"bg-gray-50 text-gray-600 border-gray-200 hover:bg-gray-100 hover:border-gray-300\";\n                          const disabledClasses = isDisabled \n                            ? \"opacity-40 cursor-not-allowed bg-gray-50 text-gray-400 border-gray-200\" \n                            : \"\";\n                          \n                          return (\n                            <button\n                              key={`refinement-${i}-${suggestion.text}`}\n                              onClick={() => !isDisabled && handleSuggestionClick(suggestion.text)}\n                              disabled={isDisabled}\n                              className={`${baseClasses} ${isDisabled ? disabledClasses : selectedClasses}`}\n                            >\n                              {suggestion.text}\n                            </button>\n                          );\n                        })}\n                      </div>\n                    ) : (\n                      // Empty state\n                      <div className=\"col-span-full text-center text-gray-500 py-4 font-normal\">\n                        No refinement suggestions available. Generate a proposal first or click \"New Suggestions\".\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n              \n              {/* Unified Regenerate Suggestions button */}\n              <div className=\"w-full flex justify-center mb-6\">\n                <button\n                  onClick={showContent ? handleRegenerateRefinementSuggestions : handleRegenerateSuggestions}\n                  disabled={showContent ? loadingRefinementSuggestions : loadingSuggestions}\n                  className=\"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title=\"Generate new suggestions\"\n                >\n                  <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\" />\n                  </svg>\n                  {showContent \n                    ? (loadingRefinementSuggestions ? 'Generating...' : 'New Suggestions')\n                    : (loadingSuggestions ? 'Generating...' : 'New Suggestions')\n                  }\n                </button>\n              </div>\n              {/* Generate and Clear buttons */}\n              <div className=\"flex gap-4 mt-2 w-full justify-center\">\n                <button\n                  className=\"px-6 py-2 rounded-lg bg-blue-600 text-white font-bold shadow-md hover:bg-blue-700 transition disabled:opacity-60\"\n                  onClick={handleGenerateWithAI}\n                  disabled={generating || !proposalText.trim()}\n                >\n                  {generating ? 'Generating...' : 'Generate'}\n                </button>\n                <button\n                  className=\"px-6 py-2 rounded-lg bg-gray-200 text-gray-700 font-bold shadow-md hover:bg-gray-300 transition\"\n                  onClick={() => {\n                    setProposalText('');\n                    setSelectedSuggestions([]);\n                    setUploadedPdfContent(''); // Clear PDF content\n                  }}\n                  disabled={generating}\n                >\n                  Clear\n                </button>\n              </div>\n            </div>\n          </div>\n        ) : (\n          // Side-by-side layout when content is generated\n          <div className=\"grid grid-cols-1 xl:grid-cols-2 gap-8 max-w-7xl mx-auto\">\n            {/* Left side - Input and Refinement */}\n            <div className=\"bg-white/90 rounded-2xl shadow-xl border border-gray-100 p-8\">\n              <h2 className=\"text-xl font-extrabold text-gray-900 mb-4\">Refine Proposal</h2>\n              \n              {/* Text box with integrated PDF upload */}\n              <div className=\"w-full relative mb-4\">\n                {/* PDF Upload Status - moved above text box */}\n                {uploadedPdfContent && (\n                  <div className=\"flex items-center gap-2 text-sm text-green-600 bg-green-50 px-3 py-2 rounded-lg mb-2\">\n                    <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                    </svg>\n                    PDF uploaded successfully\n                  </div>\n                )}\n                \n                <textarea\n                  className=\"w-full h-[180px] rounded-lg border border-gray-200 px-4 py-3 text-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition bg-gray-50 resize-none\"\n                  placeholder={uploadedPdfContent ? \"Add additional context or requirements (optional)...\" : \"Describe your client or project...\"}\n                  value={proposalText}\n                  onChange={e => setProposalText(e.target.value)}\n                  disabled={generating}\n                />\n                \n                {/* PDF Upload Button inside text box */}\n                <div className=\"absolute bottom-3 right-3\">\n                  <input\n                    type=\"file\"\n                    accept=\".pdf\"\n                    onChange={handlePdfUpload}\n                    className=\"hidden\"\n                    id=\"pdf-upload-refine\"\n                    disabled={uploadingPdf}\n                  />\n                  <label\n                    htmlFor=\"pdf-upload-refine\"\n                    className={`inline-flex items-center justify-center w-8 h-8 rounded-full transition cursor-pointer ${\n                      uploadingPdf \n                        ? 'bg-gray-100 opacity-50 cursor-not-allowed' \n                        : uploadedPdfContent \n                        ? 'bg-green-100 hover:bg-green-200' \n                        : 'bg-gray-100 hover:bg-gray-200'\n                    }`}\n                    title={uploadedPdfContent ? \"PDF uploaded - Click to replace\" : \"Upload PDF\"}\n                  >\n                    {uploadingPdf ? (\n                      <div className=\"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin\"></div>\n                    ) : uploadedPdfContent ? (\n                      <svg className=\"w-4 h-4 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                      </svg>\n                    ) : (\n                      <svg className=\"w-4 h-4 text-gray-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12\" />\n                      </svg>\n                    )}\n                  </label>\n                </div>\n              </div>\n\n              {/* Suggestions - SMALL TAGS STYLING */}\n              <div className=\"w-full flex flex-wrap gap-2 mb-4 min-h-[40px]\">\n                {loadingRefinementSuggestions ? (\n                  // Show placeholder suggestion bubbles during loading to maintain layout\n                  Array.from({ length: 8 }).map((_, i) => (\n                    <div\n                      key={i}\n                      className=\"px-3 py-1.5 rounded-full border border-gray-200 bg-gray-100 animate-pulse inline-flex items-center\"\n                      style={{ minWidth: '80px', minHeight: '28px' }}\n                    >\n                      <div className=\"h-3 bg-gray-200 rounded animate-pulse\" style={{ width: `${60 + (i * 10)}px` }}></div>\n                    </div>\n                  ))\n                ) : (\n                  refinementSuggestions.map((s, i) => {\n                    const isSelected = selectedSuggestions.includes(s.text);\n                    const isDisabled = !isSelected && selectedSuggestions.length >= 5;\n                    \n                    // Small, transparent styling for refinement suggestions\n                    const baseClasses = \"px-3 py-1.5 rounded-full text-xs font-medium transition-all duration-200 cursor-pointer border\";\n                    const selectedClasses = isSelected \n                      ? \"bg-blue-100 text-blue-700 border-blue-300 shadow-sm\" \n                      : \"bg-gray-50 text-gray-600 border-gray-200 hover:bg-gray-100 hover:border-gray-300\";\n                    const disabledClasses = isDisabled \n                      ? \"opacity-40 cursor-not-allowed bg-gray-50 text-gray-400 border-gray-200\" \n                      : \"\";\n                    \n                    return (\n                      <button\n                        key={`refinement-${i}-${s.text}`}\n                        onClick={() => !isDisabled && handleSuggestionClick(s.text)}\n                        disabled={isDisabled}\n                        className={`${baseClasses} ${isDisabled ? disabledClasses : selectedClasses}`}\n                      >\n                        {s.text}\n                      </button>\n                    );\n                  })\n                )}\n              </div>\n              \n              {/* New Suggestions button */}\n              <div className=\"w-full flex justify-center mb-4\">\n                <button\n                  onClick={handleRegenerateRefinementSuggestions}\n                  disabled={loadingRefinementSuggestions}\n                  className=\"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title=\"Generate new suggestions\"\n                >\n                  <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\" />\n                  </svg>\n                  {loadingRefinementSuggestions ? 'Generating...' : 'New Suggestions'}\n                </button>\n              </div>\n              \n              {/* Refine and Clear buttons */}\n              <div className=\"flex gap-3\">\n                <button\n                  className=\"px-4 py-2 rounded-lg bg-blue-600 text-white font-bold shadow-md hover:bg-blue-700 transition disabled:opacity-60 flex-1\"\n                  onClick={async () => {\n                    setGenerating(true);\n                    // Regenerate proposal with selected suggestions\n                    await handleGenerateWithAI();\n                  }}\n                  disabled={generating}\n                >\n                  {generating ? 'Generating...' : 'Refine'}\n                </button>\n                <button\n                  className=\"px-4 py-2 rounded-lg bg-gray-200 text-gray-700 font-bold shadow-md hover:bg-gray-300 transition\"\n                  onClick={() => {\n                    setProposalText('');\n                    setSelectedSuggestions([]);\n                    setUploadedPdfContent('');\n                    setShowContent(false);\n                    setGeneratedContent({\n                      executiveSummary: '',\n                      approach: '',\n                      budgetDetails: '',\n                      timeline: '',\n                      fullContent: ''\n                    });\n                  }}\n                  disabled={generating}\n                >\n                  New\n                </button>\n              </div>\n            </div>\n\n            {/* Right side - Generated Proposal */}\n            <div className=\"bg-white rounded-2xl shadow-xl border border-gray-100 p-8\">\n              <div className=\"flex items-center justify-between mb-6\">\n                <h2 className=\"text-xl font-extrabold text-gray-900\">Generated Proposal</h2>\n                <div className=\"flex items-center gap-2\">\n                  <div className=\"w-3 h-3 bg-green-500 rounded-full animate-pulse\"></div>\n                  <span className=\"text-sm text-green-600 font-medium\">Ready</span>\n                </div>\n              </div>\n              \n              <div className=\"bg-gray-50 rounded-xl p-6 max-h-[500px] overflow-y-auto custom-scrollbar\">\n                <div className=\"prose prose-gray max-w-none\">\n                  <ReactMarkdown\n                    remarkPlugins={[remarkGfm]}\n                    components={{\n                      h1: ({ children }) => <h1 className=\"text-2xl font-bold text-gray-900 mb-4 mt-0\">{children}</h1>,\n                      h2: ({ children }) => <h2 className=\"text-xl font-bold text-gray-900 mb-3 mt-6\">{children}</h2>,\n                      h3: ({ children }) => <h3 className=\"text-lg font-semibold text-gray-900 mb-2 mt-4\">{children}</h3>,\n                      p: ({ children }) => <p className=\"text-gray-700 leading-7 mb-3\">{children}</p>,\n                      ul: ({ children }) => <ul className=\"list-disc list-inside text-gray-700 leading-7 mb-3 space-y-1\">{children}</ul>,\n                      ol: ({ children }) => <ol className=\"list-decimal list-inside text-gray-700 leading-7 mb-3 space-y-1\">{children}</ol>,\n                      li: ({ children }) => <li className=\"text-gray-700\">{children}</li>,\n                      strong: ({ children }) => <strong className=\"font-semibold text-gray-900\">{children}</strong>,\n                      em: ({ children }) => <em className=\"italic text-gray-700\">{children}</em>,\n                    }}\n                  >\n                    {generatedContent.fullContent}\n                  </ReactMarkdown>\n                </div>\n              </div>\n\n              {/* Action buttons */}\n              <div className=\"flex gap-3 mt-6\">\n                <button\n                  onClick={handleSaveDraft}\n                  disabled={savingDraft}\n                  className=\"px-4 py-2 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700 transition disabled:opacity-60 flex-1\"\n                >\n                  {savingDraft ? 'Saving...' : 'Save Draft'}\n                </button>\n                <button\n                  onClick={() => setShowEmailModal(true)}\n                  className=\"px-4 py-2 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition\"\n                >\n                  Send Email\n                </button>\n                <button\n                  onClick={handleDownloadPdf}\n                  disabled={downloadingPdf}\n                  className=\"px-4 py-2 bg-purple-600 text-white rounded-lg font-semibold hover:bg-purple-700 transition disabled:opacity-60\"\n                >\n                  {downloadingPdf ? 'Downloading...' : 'Download PDF'}\n                </button>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Loading screen below the box when generating */}\n        {generating && !showContent && (\n          <div className=\"flex flex-col items-center justify-center py-12 w-full\">\n            <div className=\"relative\">\n              {/* Animated circles */}\n              <div className=\"absolute inset-0 animate-ping\">\n                <div className=\"w-16 h-16 bg-gradient-to-r from-blue-400 to-purple-500 rounded-full opacity-20\"></div>\n              </div>\n              <div className=\"absolute inset-0 animate-ping\" style={{ animationDelay: '0.5s' }}>\n                <div className=\"w-16 h-16 bg-gradient-to-r from-purple-400 to-pink-500 rounded-full opacity-20\"></div>\n              </div>\n              <div className=\"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center\">\n                <div className=\"w-8 h-8 bg-white rounded-full\"></div>\n              </div>\n            </div>\n            <h3 className=\"text-xl font-bold text-gray-900 mt-6 mb-2\">Generating Your Proposal</h3>\n            <p className=\"text-gray-600 text-center max-w-md\">\n              Our AI is crafting a professional proposal tailored to your requirements. This may take a few moments...\n            </p>\n          </div>\n        )}\n\n        {/* Loading screen for refinement state */}\n        {generating && showContent && (\n          <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n            <div className=\"bg-white rounded-2xl p-8 max-w-md mx-4 text-center\">\n              <div className=\"relative mb-6\">\n                {/* Animated circles */}\n                <div className=\"absolute inset-0 animate-ping\">\n                  <div className=\"w-16 h-16 bg-gradient-to-r from-blue-400 to-purple-500 rounded-full opacity-20\"></div>\n                </div>\n                <div className=\"absolute inset-0 animate-ping\" style={{ animationDelay: '0.5s' }}>\n                  <div className=\"w-16 h-16 bg-gradient-to-r from-purple-400 to-pink-500 rounded-full opacity-20\"></div>\n                </div>\n                <div className=\"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center mx-auto\">\n                  <div className=\"w-8 h-8 bg-white rounded-full\"></div>\n                </div>\n              </div>\n              <h3 className=\"text-xl font-bold text-gray-900 mb-2\">Refining Your Proposal</h3>\n              <p className=\"text-gray-600\">\n                Our AI is refining your proposal with the selected improvements. This may take a few moments...\n              </p>\n            </div>\n          </div>\n        )}\n        {/* Email Modal (if needed) */}\n        {showEmailModal && (\n          <div className=\"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50\">\n            <div className=\"bg-white rounded-xl shadow-lg p-8 w-full max-w-md\">\n              <h2 className=\"text-lg font-semibold mb-4\">Send Proposal via Email</h2>\n              <input\n                type=\"email\"\n                className=\"w-full border border-gray-300 rounded-lg px-3 py-2 mb-4 focus:outline-none focus:ring-2 focus:ring-blue-400\"\n                placeholder=\"Recipient's email address\"\n                value={email}\n                onChange={e => setEmail(e.target.value)}\n                disabled={sendingEmail}\n              />\n              <div className=\"flex gap-3 justify-end\">\n                <button\n                  onClick={() => setShowEmailModal(false)}\n                  className=\"px-4 py-2 rounded-lg bg-gray-200 text-gray-700 font-semibold hover:bg-gray-300 transition\"\n                  disabled={sendingEmail}\n                >Cancel</button>\n                <button\n                  onClick={handleSendEmail}\n                  className=\"px-4 py-2 rounded-lg bg-blue-600 text-white font-semibold shadow hover:bg-blue-700 transition disabled:opacity-60\"\n                  disabled={sendingEmail}\n                >{sendingEmail ? 'Sending...' : 'Send'}</button>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n      <style>{`\n        .custom-scrollbar::-webkit-scrollbar {\n          width: 6px;\n        }\n        .custom-scrollbar::-webkit-scrollbar-track {\n          background: #f1f5f9;\n          border-radius: 3px;\n        }\n        .custom-scrollbar::-webkit-scrollbar-thumb {\n          background: #cbd5e1;\n          border-radius: 3px;\n        }\n        .custom-scrollbar::-webkit-scrollbar-thumb:hover {\n          background: #94a3b8;\n        }\n      `}</style>\n    </div>\n  );\n};\n\nexport default Dashboard; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}