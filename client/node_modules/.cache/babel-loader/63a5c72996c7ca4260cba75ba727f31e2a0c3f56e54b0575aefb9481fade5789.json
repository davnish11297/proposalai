{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useParams,useNavigate}from'react-router-dom';import{toast}from'react-hot-toast';import{proposalsAPI,getOpenRouterChatCompletion}from'../services/api';import ClientSelectionModal from'../components/ClientSelectionModal';import{DocumentTextIcon,UserIcon,SparklesIcon,CogIcon,CheckCircleIcon,ClockIcon,CurrencyDollarIcon,ArrowPathIcon,EyeIcon,PencilIcon}from'@heroicons/react/24/outline';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProposalEditor=()=>{var _proposal$content7,_proposal$content8,_proposal$content9,_proposal$content0,_proposal$content0$fu,_proposal$content1,_proposal$content1$fu,_proposal$content10;const{id}=useParams();const navigate=useNavigate();const[loading,setLoading]=useState(false);const[generating,setGenerating]=useState(false);const[showClientModal,setShowClientModal]=useState(false);const[selectedClientId,setSelectedClientId]=useState(undefined);const[proposal,setProposal]=useState({title:'',description:'',clientName:'',clientEmail:'',type:'PROPOSAL',content:{executiveSummary:'',approach:'',budgetDetails:'',timeline:'',budget:'',fullProposal:''// Added for unified editing\n},metadata:{industry:'',companySize:'',projectScope:''}});const[accessRequests,setAccessRequests]=useState([]);const[grantingRequestId,setGrantingRequestId]=useState(null);const isNewProposal=!id;// Debug log to verify access requests\nconsole.log('🔍 Access requests state:',accessRequests);useEffect(()=>{const fetchProposal=async()=>{try{const{data}=await proposalsAPI.getById(id);// Ensure metadata exists with default values\nconst proposalData={...data.data,metadata:{industry:'',companySize:'',projectScope:'',...data.data.metadata},content:{executiveSummary:'',approach:'',budgetDetails:'',timeline:'',budget:'',fullProposal:'',...data.data.content}};setProposal(proposalData);setSelectedClientId(data.data.clientId);}catch(error){console.error('Failed to fetch proposal:',error);toast.error('Failed to load proposal');}};if(id){fetchProposal();}},[id]);useEffect(()=>{if(id){proposalsAPI.getAccessRequests(id).then(_ref=>{let{data}=_ref;return setAccessRequests(data.data);}).catch(()=>setAccessRequests([]));}},[id]);const handleGenerateWithAI=async()=>{// Validate required fields\nconsole.log('🔍 Current proposal state:',{clientName:proposal.clientName,description:proposal.description,hasClientName:!!proposal.clientName,hasDescription:!!proposal.description});if(!proposal.clientName||!proposal.description){const missingFields=[];if(!proposal.clientName)missingFields.push('Client Name');if(!proposal.description)missingFields.push('Description');toast.error(`Please fill in: ${missingFields.join(' and ')} before generating content`);return;}setGenerating(true);try{const messages=[{role:'system',content:'You are an expert proposal writer. Generate a detailed, professional proposal for the following client and project. Structure your response with clear sections: Executive Summary, Project Overview, Our Approach & Methodology, Detailed Scope of Work, Timeline & Milestones, Investment & Pricing, Why Choose Us, and Next Steps. Use clear, persuasive language and make each section comprehensive.'},{role:'user',content:`Create a comprehensive, professional proposal for the following project:\n\nClient: ${proposal.clientName}\nProject Description: ${proposal.description}\nBudget: ${proposal.budget||'To be determined'}\nTimeline: ${proposal.timeline||'To be determined'}\n\nPlease structure the proposal with the following sections:\n1. Executive Summary\n2. Project Overview\n3. Our Approach & Methodology\n4. Detailed Scope of Work\n5. Timeline & Milestones\n6. Investment & Pricing\n7. Why Choose Us\n8. Next Steps\n\nMake it compelling, professional, and tailored to the client's needs. Use clear headings and bullet points where appropriate.`}];const response=await getOpenRouterChatCompletion(messages);if(response&&response.choices&&response.choices[0]&&response.choices[0].message){const cleanContent=content=>{// Remove any markdown formatting that might interfere\nreturn content.replace(/```markdown/g,'').replace(/```/g,'').trim();};const cleanedContent=cleanContent(response.choices[0].message.content);setProposal(prev=>({...prev,content:{...prev.content,fullProposal:cleanedContent}}));toast.success('Proposal content generated successfully!');}}catch(error){console.error('Error generating content:',error);toast.error('Failed to generate content. Please try again.');}finally{setGenerating(false);}};const handleSave=async()=>{if(!proposal.title||!proposal.clientName||!proposal.description){toast.error('Please fill in all required fields');return;}setLoading(true);try{if(isNewProposal){await proposalsAPI.create(proposal);toast.success('Proposal saved as draft!');navigate('/drafts');}else{await proposalsAPI.update(id,proposal);toast.success('Proposal updated successfully!');}}catch(error){console.error('Error saving proposal:',error);toast.error('Failed to save proposal');}finally{setLoading(false);}};const handleSubmit=async()=>{if(!proposal.title||!proposal.clientName||!proposal.description){toast.error('Please fill in all required fields');return;}setLoading(true);try{const updatedProposal={...proposal,status:'SENT'};if(isNewProposal){await proposalsAPI.create(updatedProposal);}else{await proposalsAPI.update(id,updatedProposal);}toast.success('Proposal submitted successfully!');navigate('/sent-proposals');}catch(error){console.error('Error submitting proposal:',error);toast.error('Failed to submit proposal');}finally{setLoading(false);}};const handleClientSelect=client=>{setProposal(prev=>({...prev,clientName:client.name,clientEmail:client.email}));setSelectedClientId(client.id);setShowClientModal(false);};const handleClearClient=()=>{setProposal(prev=>({...prev,clientName:'',clientEmail:''}));setSelectedClientId(undefined);};const handleGrantAccess=async requestId=>{setGrantingRequestId(requestId);try{await proposalsAPI.grantAccessRequest(id,requestId);toast.success('Access granted and email sent!');// Refresh access requests\nconst{data}=await proposalsAPI.getAccessRequests(id);setAccessRequests(data.data);}catch(error){toast.error('Failed to grant access');}finally{setGrantingRequestId(null);}};const handleRefineEntireProposal=async()=>{var _proposal$content;if(!(proposal!==null&&proposal!==void 0&&(_proposal$content=proposal.content)!==null&&_proposal$content!==void 0&&_proposal$content.fullProposal)){toast.error('No content to refine. Please generate or add content first.');return;}setGenerating(true);try{const messages=[{role:'system',content:'You are an expert proposal writer. Refine the entire proposal content. Make it more detailed, persuasive, and comprehensive while maintaining the same structure.'},{role:'user',content:`Please refine and improve the following proposal content. Make it more compelling, professional, and persuasive while maintaining the same structure:\n\n${proposal.content.fullProposal}\n\nPlease enhance:\n1. Clarity and readability\n2. Professional tone\n3. Persuasive language\n4. Value proposition\n5. Call-to-action\n\nReturn the improved version with the same structure.`}];const response=await getOpenRouterChatCompletion(messages);if(response&&response.choices&&response.choices[0]&&response.choices[0].message){setProposal(prev=>({...prev,content:{...prev.content,fullProposal:response.choices[0].message.content.trim()}}));toast.success('Proposal refined successfully!');}}catch(error){console.error('Error refining content:',error);toast.error('Failed to refine content. Please try again.');}finally{setGenerating(false);}};const handleFormatProposal=()=>{var _proposal$content2;if(!(proposal!==null&&proposal!==void 0&&(_proposal$content2=proposal.content)!==null&&_proposal$content2!==void 0&&_proposal$content2.fullProposal)){toast.error('No content to format. Please add content first.');return;}const content=proposal.content.fullProposal;const formattedContent=content.replace(/([A-Z][a-z]+:)/g,'\\n## $1')// Add markdown headers\n.replace(/(\\d+\\.\\s)/g,'\\n$1')// Add line breaks before numbered lists\n.replace(/(•\\s)/g,'\\n$1')// Add line breaks before bullet points\n.trim();setProposal(prev=>({...prev,content:{...prev.content,fullProposal:formattedContent}}));toast.success('Proposal formatted successfully!');};const getCombinedProposalContent=()=>{var _proposal$content3,_proposal$content4,_proposal$content5,_proposal$content6;const sections=[];if(proposal!==null&&proposal!==void 0&&(_proposal$content3=proposal.content)!==null&&_proposal$content3!==void 0&&_proposal$content3.executiveSummary)sections.push(`# Executive Summary\\n${proposal.content.executiveSummary}`);if(proposal!==null&&proposal!==void 0&&(_proposal$content4=proposal.content)!==null&&_proposal$content4!==void 0&&_proposal$content4.approach)sections.push(`# Approach\\n${proposal.content.approach}`);if(proposal!==null&&proposal!==void 0&&(_proposal$content5=proposal.content)!==null&&_proposal$content5!==void 0&&_proposal$content5.budgetDetails)sections.push(`# Budget Details\\n${proposal.content.budgetDetails}`);if(proposal!==null&&proposal!==void 0&&(_proposal$content6=proposal.content)!==null&&_proposal$content6!==void 0&&_proposal$content6.timeline)sections.push(`# Timeline\\n${proposal.content.timeline}`);return sections.join('\\n\\n');};return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-50\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white border-b border-gray-200 px-6 py-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 bg-gradient-to-r from-primary-600 to-primary-700 rounded-xl flex items-center justify-center shadow-lg\",children:/*#__PURE__*/_jsx(DocumentTextIcon,{className:\"w-5 h-5 text-white\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900\",children:isNewProposal?'Create New Proposal':'Edit Proposal'}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:isNewProposal?'Build a compelling proposal from scratch':'Refine and perfect your proposal'})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:handleSave,disabled:loading,className:\"btn-secondary flex items-center gap-2\",children:[/*#__PURE__*/_jsx(PencilIcon,{className:\"w-4 h-4\"}),\"Save Draft\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:handleSubmit,disabled:loading,className:\"btn-primary flex items-center gap-2\",children:[/*#__PURE__*/_jsx(CheckCircleIcon,{className:\"w-4 h-4\"}),\"Submit Proposal\"]})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"max-w-7xl mx-auto px-6 py-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-3 gap-8\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"lg:col-span-1\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-sm border border-gray-200 p-6 sticky top-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 mb-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 bg-gradient-to-r from-blue-100 to-blue-200 rounded-lg flex items-center justify-center\",children:/*#__PURE__*/_jsx(CogIcon,{className:\"w-4 h-4 text-blue-600\"})}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-900\",children:\"Proposal Details\"})]}),/*#__PURE__*/_jsxs(\"form\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-semibold text-gray-700\",children:[\"Proposal Title \",/*#__PURE__*/_jsx(\"span\",{className:\"text-red-500\",children:\"*\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:(proposal===null||proposal===void 0?void 0:proposal.title)||'',onChange:e=>setProposal({...proposal,title:e.target.value}),className:\"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 bg-gray-50 hover:bg-white\",placeholder:\"Enter proposal title\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-semibold text-gray-700\",children:[\"Client \",/*#__PURE__*/_jsx(\"span\",{className:\"text-red-500\",children:\"*\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:(proposal===null||proposal===void 0?void 0:proposal.clientName)||'',onChange:e=>setProposal({...proposal,clientName:e.target.value}),className:\"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 bg-gray-50 hover:bg-white\",placeholder:\"Enter client name\"}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>setShowClientModal(true),className:`px-4 py-3 rounded-xl transition-all duration-200 flex items-center gap-2 whitespace-nowrap font-medium ${selectedClientId?'bg-green-600 text-white hover:bg-green-700 shadow-md':'bg-primary-600 text-white hover:bg-primary-700 shadow-md'}`,children:[/*#__PURE__*/_jsx(UserIcon,{className:\"w-4 h-4\"}),selectedClientId?'Change':'Select']})]}),selectedClientId&&/*#__PURE__*/_jsx(\"div\",{className:\"p-3 bg-green-50 border border-green-200 rounded-xl\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 text-sm text-green-800\",children:[/*#__PURE__*/_jsx(CheckCircleIcon,{className:\"w-4 h-4\"}),\"Client selected from database\"]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleClearClient,className:\"text-red-600 hover:text-red-800 text-sm font-medium\",children:\"Clear\"})]})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-semibold text-gray-700\",children:[\"Project Description \",/*#__PURE__*/_jsx(\"span\",{className:\"text-red-500\",children:\"*\"})]}),/*#__PURE__*/_jsx(\"textarea\",{value:(proposal===null||proposal===void 0?void 0:proposal.description)||'',onChange:e=>setProposal({...proposal,description:e.target.value}),rows:4,className:\"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 bg-gray-50 hover:bg-white resize-none\",placeholder:\"Describe the project, requirements, and objectives...\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700\",children:\"Budget\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(CurrencyDollarIcon,{className:\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:(proposal===null||proposal===void 0?void 0:proposal.budget)||'',onChange:e=>setProposal({...proposal,budget:e.target.value}),className:\"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 bg-gray-50 hover:bg-white\",placeholder:\"e.g. $50,000\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-700\",children:\"Timeline\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(ClockIcon,{className:\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:(proposal===null||proposal===void 0?void 0:proposal.timeline)||'',onChange:e=>setProposal({...proposal,timeline:e.target.value}),className:\"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 bg-gray-50 hover:bg-white\",placeholder:\"e.g. 2 months\"})]})]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleGenerateWithAI,disabled:generating||loading||!(proposal!==null&&proposal!==void 0&&proposal.clientName)||!(proposal!==null&&proposal!==void 0&&proposal.description),className:`w-full py-4 px-6 rounded-xl font-semibold text-white transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-offset-2 shadow-lg ${generating||loading||!(proposal!==null&&proposal!==void 0&&proposal.clientName)||!(proposal!==null&&proposal!==void 0&&proposal.description)?'bg-gray-400 cursor-not-allowed':'bg-gradient-to-r from-primary-600 to-purple-600 hover:from-primary-700 hover:to-purple-700 focus:ring-primary-500'}`,children:generating?/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center\",children:[/*#__PURE__*/_jsx(ArrowPathIcon,{className:\"animate-spin -ml-1 mr-3 h-5 w-5 text-white\"}),\"Generating Content...\"]}):/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center\",children:[/*#__PURE__*/_jsx(SparklesIcon,{className:\"w-5 h-5 mr-2\"}),\"Generate AI Content\"]})}),(!(proposal!==null&&proposal!==void 0&&proposal.clientName)||!(proposal!==null&&proposal!==void 0&&proposal.description))&&/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 text-center\",children:\"Enter client name and description to enable AI generation\"})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"lg:col-span-2\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-sm border border-gray-200 p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-900 mb-1\",children:\"Proposal Content\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Review, edit, and refine your proposal content\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleRefineEntireProposal(),disabled:generating||!(proposal!==null&&proposal!==void 0&&(_proposal$content7=proposal.content)!==null&&_proposal$content7!==void 0&&_proposal$content7.fullProposal),className:\"btn-primary flex items-center gap-2\",children:[/*#__PURE__*/_jsx(SparklesIcon,{className:\"w-4 h-4\"}),\"Refine with AI\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleFormatProposal(),disabled:!(proposal!==null&&proposal!==void 0&&(_proposal$content8=proposal.content)!==null&&_proposal$content8!==void 0&&_proposal$content8.fullProposal),className:\"btn-secondary flex items-center gap-2\",children:[/*#__PURE__*/_jsx(CogIcon,{className:\"w-4 h-4\"}),\"Format\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4 text-sm text-gray-600 p-3 bg-gray-50 rounded-xl\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(EyeIcon,{className:\"w-4 h-4\"}),\"Edit the entire proposal content below\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(SparklesIcon,{className:\"w-4 h-4\"}),\"Use \\\"Refine with AI\\\" to improve the entire document\"]})]}),/*#__PURE__*/_jsx(\"textarea\",{value:(proposal===null||proposal===void 0?void 0:(_proposal$content9=proposal.content)===null||_proposal$content9===void 0?void 0:_proposal$content9.fullProposal)||getCombinedProposalContent(),onChange:e=>setProposal({...proposal,content:{...(proposal===null||proposal===void 0?void 0:proposal.content),fullProposal:e.target.value}}),rows:25,className:\"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none transition-all duration-200 bg-gray-50 font-mono text-sm leading-relaxed hover:bg-white\",placeholder:\"Enter your complete proposal content here... # Executive Summary\\n[Your executive summary goes here] # Approach\\n[Your approach and methodology] # Budget Details\\n[Detailed budget breakdown] # Timeline\\n[Project timeline and milestones] # Additional Sections\\n[Any other relevant sections]\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between text-xs text-gray-500 p-3 bg-gray-50 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"Word count: \",(proposal===null||proposal===void 0?void 0:(_proposal$content0=proposal.content)===null||_proposal$content0===void 0?void 0:(_proposal$content0$fu=_proposal$content0.fullProposal)===null||_proposal$content0$fu===void 0?void 0:_proposal$content0$fu.split(/\\s+/).length)||0,\" words\"]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Characters: \",(proposal===null||proposal===void 0?void 0:(_proposal$content1=proposal.content)===null||_proposal$content1===void 0?void 0:(_proposal$content1$fu=_proposal$content1.fullProposal)===null||_proposal$content1$fu===void 0?void 0:_proposal$content1$fu.length)||0]})]})]}),(proposal===null||proposal===void 0?void 0:(_proposal$content10=proposal.content)===null||_proposal$content10===void 0?void 0:_proposal$content10.fullProposal)&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 bg-green-50 border border-green-200 rounded-xl p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 text-green-800\",children:[/*#__PURE__*/_jsx(CheckCircleIcon,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Content Ready!\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-green-700 text-sm mt-1\",children:\"Review and edit the content above. Use \\\"Refine with AI\\\" to improve the entire document or \\\"Format\\\" to structure it properly.\"})]})]})})]})}),/*#__PURE__*/_jsx(ClientSelectionModal,{isOpen:showClientModal,onClose:()=>setShowClientModal(false),onSelectClient:handleClientSelect,selectedClientId:selectedClientId})]});};export default ProposalEditor;","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","toast","proposalsAPI","getOpenRouterChatCompletion","ClientSelectionModal","DocumentTextIcon","UserIcon","SparklesIcon","CogIcon","CheckCircleIcon","ClockIcon","CurrencyDollarIcon","ArrowPathIcon","EyeIcon","PencilIcon","jsx","_jsx","jsxs","_jsxs","ProposalEditor","_proposal$content7","_proposal$content8","_proposal$content9","_proposal$content0","_proposal$content0$fu","_proposal$content1","_proposal$content1$fu","_proposal$content10","id","navigate","loading","setLoading","generating","setGenerating","showClientModal","setShowClientModal","selectedClientId","setSelectedClientId","undefined","proposal","setProposal","title","description","clientName","clientEmail","type","content","executiveSummary","approach","budgetDetails","timeline","budget","fullProposal","metadata","industry","companySize","projectScope","accessRequests","setAccessRequests","grantingRequestId","setGrantingRequestId","isNewProposal","console","log","fetchProposal","data","getById","proposalData","clientId","error","getAccessRequests","then","_ref","catch","handleGenerateWithAI","hasClientName","hasDescription","missingFields","push","join","messages","role","response","choices","message","cleanContent","replace","trim","cleanedContent","prev","success","handleSave","create","update","handleSubmit","updatedProposal","status","handleClientSelect","client","name","email","handleClearClient","handleGrantAccess","requestId","grantAccessRequest","handleRefineEntireProposal","_proposal$content","handleFormatProposal","_proposal$content2","formattedContent","getCombinedProposalContent","_proposal$content3","_proposal$content4","_proposal$content5","_proposal$content6","sections","className","children","onClick","disabled","value","onChange","e","target","placeholder","rows","split","length","isOpen","onClose","onSelectClient"],"sources":["/Users/davnishsingh/Documents/proposalai-main/proposalai/client/src/pages/ProposalEditor.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { toast } from 'react-hot-toast';\nimport { proposalsAPI, getOpenRouterChatCompletion } from '../services/api';\nimport ClientSelectionModal from '../components/ClientSelectionModal';\nimport { \n  DocumentTextIcon, \n  UserIcon, \n  SparklesIcon, \n  CogIcon, \n  CheckCircleIcon,\n  ClockIcon,\n  CurrencyDollarIcon,\n  BuildingOfficeIcon,\n  LightBulbIcon,\n  ChartBarIcon,\n  ArrowPathIcon,\n  EyeIcon,\n  PencilIcon,\n  PlusIcon,\n  XMarkIcon\n} from '@heroicons/react/24/outline';\n\nconst ProposalEditor: React.FC = () => {\n  const { id } = useParams<{ id: string }>();\n  const navigate = useNavigate();\n  const [loading, setLoading] = useState(false);\n  const [generating, setGenerating] = useState(false);\n  const [showClientModal, setShowClientModal] = useState(false);\n  const [selectedClientId, setSelectedClientId] = useState<string | undefined>(undefined);\n  const [proposal, setProposal] = useState<any>({\n    title: '',\n    description: '',\n    clientName: '',\n    clientEmail: '',\n    type: 'PROPOSAL',\n    content: {\n      executiveSummary: '',\n      approach: '',\n      budgetDetails: '',\n      timeline: '',\n      budget: '',\n      fullProposal: '' // Added for unified editing\n    },\n    metadata: {\n      industry: '',\n      companySize: '',\n      projectScope: ''\n    }\n  });\n  const [accessRequests, setAccessRequests] = useState<any[]>([]);\n  const [grantingRequestId, setGrantingRequestId] = useState<string | null>(null);\n\n  const isNewProposal = !id;\n\n  // Debug log to verify access requests\n  console.log('🔍 Access requests state:', accessRequests);\n\n  useEffect(() => {\n    const fetchProposal = async () => {\n      try {\n        const { data } = await proposalsAPI.getById(id!);\n        // Ensure metadata exists with default values\n        const proposalData = {\n          ...data.data,\n          metadata: {\n            industry: '',\n            companySize: '',\n            projectScope: '',\n            ...data.data.metadata\n          },\n          content: {\n            executiveSummary: '',\n            approach: '',\n            budgetDetails: '',\n            timeline: '',\n            budget: '',\n            fullProposal: '',\n            ...data.data.content\n          }\n        };\n        setProposal(proposalData);\n        setSelectedClientId(data.data.clientId);\n      } catch (error) {\n        console.error('Failed to fetch proposal:', error);\n        toast.error('Failed to load proposal');\n      }\n    };\n\n    if (id) {\n      fetchProposal();\n    }\n  }, [id]);\n\n  useEffect(() => {\n    if (id) {\n      proposalsAPI.getAccessRequests(id)\n        .then(({ data }) => setAccessRequests(data.data))\n        .catch(() => setAccessRequests([]));\n    }\n  }, [id]);\n\n  const handleGenerateWithAI = async () => {\n    // Validate required fields\n    console.log('🔍 Current proposal state:', {\n      clientName: proposal.clientName,\n      description: proposal.description,\n      hasClientName: !!proposal.clientName,\n      hasDescription: !!proposal.description\n    });\n    \n    if (!proposal.clientName || !proposal.description) {\n      const missingFields = [];\n      if (!proposal.clientName) missingFields.push('Client Name');\n      if (!proposal.description) missingFields.push('Description');\n      toast.error(`Please fill in: ${missingFields.join(' and ')} before generating content`);\n      return;\n    }\n\n    setGenerating(true);\n    try {\n      const messages = [\n        {\n          role: 'system',\n          content: 'You are an expert proposal writer. Generate a detailed, professional proposal for the following client and project. Structure your response with clear sections: Executive Summary, Project Overview, Our Approach & Methodology, Detailed Scope of Work, Timeline & Milestones, Investment & Pricing, Why Choose Us, and Next Steps. Use clear, persuasive language and make each section comprehensive.'\n        },\n        {\n          role: 'user',\n          content: `Create a comprehensive, professional proposal for the following project:\n\nClient: ${proposal.clientName}\nProject Description: ${proposal.description}\nBudget: ${proposal.budget || 'To be determined'}\nTimeline: ${proposal.timeline || 'To be determined'}\n\nPlease structure the proposal with the following sections:\n1. Executive Summary\n2. Project Overview\n3. Our Approach & Methodology\n4. Detailed Scope of Work\n5. Timeline & Milestones\n6. Investment & Pricing\n7. Why Choose Us\n8. Next Steps\n\nMake it compelling, professional, and tailored to the client's needs. Use clear headings and bullet points where appropriate.`\n        }\n      ];\n\n      const response = await getOpenRouterChatCompletion(messages);\n      \n      if (response && response.choices && response.choices[0] && response.choices[0].message) {\n        const cleanContent = (content: string) => {\n          // Remove any markdown formatting that might interfere\n          return content\n            .replace(/```markdown/g, '')\n            .replace(/```/g, '')\n            .trim();\n        };\n\n        const cleanedContent = cleanContent(response.choices[0].message.content);\n        \n        setProposal((prev: any) => ({\n          ...prev,\n          content: {\n            ...prev.content,\n            fullProposal: cleanedContent\n          }\n        }));\n        \n        toast.success('Proposal content generated successfully!');\n      }\n    } catch (error) {\n      console.error('Error generating content:', error);\n      toast.error('Failed to generate content. Please try again.');\n    } finally {\n      setGenerating(false);\n    }\n  };\n\n  const handleSave = async () => {\n    if (!proposal.title || !proposal.clientName || !proposal.description) {\n      toast.error('Please fill in all required fields');\n      return;\n    }\n\n    setLoading(true);\n    try {\n      if (isNewProposal) {\n        await proposalsAPI.create(proposal);\n        toast.success('Proposal saved as draft!');\n        navigate('/drafts');\n      } else {\n        await proposalsAPI.update(id, proposal);\n        toast.success('Proposal updated successfully!');\n      }\n    } catch (error) {\n      console.error('Error saving proposal:', error);\n      toast.error('Failed to save proposal');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSubmit = async () => {\n    if (!proposal.title || !proposal.clientName || !proposal.description) {\n      toast.error('Please fill in all required fields');\n      return;\n    }\n\n    setLoading(true);\n    try {\n      const updatedProposal = { ...proposal, status: 'SENT' };\n      if (isNewProposal) {\n        await proposalsAPI.create(updatedProposal);\n      } else {\n        await proposalsAPI.update(id, updatedProposal);\n      }\n      toast.success('Proposal submitted successfully!');\n      navigate('/sent-proposals');\n    } catch (error) {\n      console.error('Error submitting proposal:', error);\n      toast.error('Failed to submit proposal');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleClientSelect = (client: any) => {\n    setProposal((prev: any) => ({\n      ...prev,\n      clientName: client.name,\n      clientEmail: client.email\n    }));\n    setSelectedClientId(client.id);\n    setShowClientModal(false);\n  };\n\n  const handleClearClient = () => {\n    setProposal((prev: any) => ({\n      ...prev,\n      clientName: '',\n      clientEmail: ''\n    }));\n    setSelectedClientId(undefined);\n  };\n\n  const handleGrantAccess = async (requestId: string) => {\n    setGrantingRequestId(requestId);\n    try {\n      await proposalsAPI.grantAccessRequest(id!, requestId);\n      toast.success('Access granted and email sent!');\n      // Refresh access requests\n      const { data } = await proposalsAPI.getAccessRequests(id!);\n      setAccessRequests(data.data);\n    } catch (error) {\n      toast.error('Failed to grant access');\n    } finally {\n      setGrantingRequestId(null);\n    }\n  };\n\n  const handleRefineEntireProposal = async () => {\n    if (!proposal?.content?.fullProposal) {\n      toast.error('No content to refine. Please generate or add content first.');\n      return;\n    }\n\n    setGenerating(true);\n    try {\n      const messages = [\n        {\n          role: 'system',\n          content: 'You are an expert proposal writer. Refine the entire proposal content. Make it more detailed, persuasive, and comprehensive while maintaining the same structure.'\n        },\n        {\n          role: 'user',\n          content: `Please refine and improve the following proposal content. Make it more compelling, professional, and persuasive while maintaining the same structure:\n\n${proposal.content.fullProposal}\n\nPlease enhance:\n1. Clarity and readability\n2. Professional tone\n3. Persuasive language\n4. Value proposition\n5. Call-to-action\n\nReturn the improved version with the same structure.`\n        }\n      ];\n\n      const response = await getOpenRouterChatCompletion(messages);\n      \n      if (response && response.choices && response.choices[0] && response.choices[0].message) {\n        setProposal((prev: any) => ({\n          ...prev,\n          content: {\n            ...prev.content,\n            fullProposal: response.choices[0].message.content.trim()\n          }\n        }));\n        \n        toast.success('Proposal refined successfully!');\n      }\n    } catch (error) {\n      console.error('Error refining content:', error);\n      toast.error('Failed to refine content. Please try again.');\n    } finally {\n      setGenerating(false);\n    }\n  };\n\n  const handleFormatProposal = () => {\n    if (!proposal?.content?.fullProposal) {\n      toast.error('No content to format. Please add content first.');\n      return;\n    }\n\n    const content = proposal.content.fullProposal;\n    const formattedContent = content\n      .replace(/([A-Z][a-z]+:)/g, '\\n## $1') // Add markdown headers\n      .replace(/(\\d+\\.\\s)/g, '\\n$1') // Add line breaks before numbered lists\n      .replace(/(•\\s)/g, '\\n$1') // Add line breaks before bullet points\n      .trim();\n\n    setProposal((prev: any) => ({\n      ...prev,\n      content: {\n        ...prev.content,\n        fullProposal: formattedContent\n      }\n    }));\n\n    toast.success('Proposal formatted successfully!');\n  };\n\n  const getCombinedProposalContent = () => {\n    const sections = [];\n    if (proposal?.content?.executiveSummary) sections.push(`# Executive Summary\\n${proposal.content.executiveSummary}`);\n    if (proposal?.content?.approach) sections.push(`# Approach\\n${proposal.content.approach}`);\n    if (proposal?.content?.budgetDetails) sections.push(`# Budget Details\\n${proposal.content.budgetDetails}`);\n    if (proposal?.content?.timeline) sections.push(`# Timeline\\n${proposal.content.timeline}`);\n    return sections.join('\\n\\n');\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-50\">\n      {/* Header */}\n      <div className=\"bg-white border-b border-gray-200 px-6 py-4\">\n        <div className=\"max-w-7xl mx-auto flex items-center justify-between\">\n          <div className=\"flex items-center gap-4\">\n            <div className=\"w-10 h-10 bg-gradient-to-r from-primary-600 to-primary-700 rounded-xl flex items-center justify-center shadow-lg\">\n              <DocumentTextIcon className=\"w-5 h-5 text-white\" />\n            </div>\n            <div>\n              <h1 className=\"text-2xl font-bold text-gray-900\">\n                {isNewProposal ? 'Create New Proposal' : 'Edit Proposal'}\n              </h1>\n              <p className=\"text-sm text-gray-600\">\n                {isNewProposal ? 'Build a compelling proposal from scratch' : 'Refine and perfect your proposal'}\n              </p>\n            </div>\n          </div>\n          <div className=\"flex items-center gap-3\">\n            <button\n              onClick={handleSave}\n              disabled={loading}\n              className=\"btn-secondary flex items-center gap-2\"\n            >\n              <PencilIcon className=\"w-4 h-4\" />\n              Save Draft\n            </button>\n            <button\n              onClick={handleSubmit}\n              disabled={loading}\n              className=\"btn-primary flex items-center gap-2\"\n            >\n              <CheckCircleIcon className=\"w-4 h-4\" />\n              Submit Proposal\n            </button>\n          </div>\n        </div>\n      </div>\n\n      {/* Main Content */}\n      <div className=\"max-w-7xl mx-auto px-6 py-8\">\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n          {/* Left Panel - Form */}\n          <div className=\"lg:col-span-1\">\n            <div className=\"bg-white rounded-2xl shadow-sm border border-gray-200 p-6 sticky top-8\">\n              <div className=\"flex items-center gap-3 mb-6\">\n                <div className=\"w-8 h-8 bg-gradient-to-r from-blue-100 to-blue-200 rounded-lg flex items-center justify-center\">\n                  <CogIcon className=\"w-4 h-4 text-blue-600\" />\n                </div>\n                <h2 className=\"text-xl font-bold text-gray-900\">Proposal Details</h2>\n              </div>\n\n              <form className=\"space-y-6\">\n                {/* Proposal Title */}\n                <div className=\"space-y-2\">\n                  <label className=\"block text-sm font-semibold text-gray-700\">\n                    Proposal Title <span className=\"text-red-500\">*</span>\n                  </label>\n                  <input\n                    type=\"text\"\n                    value={proposal?.title || ''}\n                    onChange={(e) => setProposal({ ...proposal, title: e.target.value })}\n                    className=\"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 bg-gray-50 hover:bg-white\"\n                    placeholder=\"Enter proposal title\"\n                  />\n                </div>\n\n                {/* Client Selection */}\n                <div className=\"space-y-2\">\n                  <label className=\"block text-sm font-semibold text-gray-700\">\n                    Client <span className=\"text-red-500\">*</span>\n                  </label>\n                  <div className=\"space-y-3\">\n                    <div className=\"flex gap-2\">\n                      <input\n                        type=\"text\"\n                        value={proposal?.clientName || ''}\n                        onChange={(e) => setProposal({ ...proposal, clientName: e.target.value })}\n                        className=\"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 bg-gray-50 hover:bg-white\"\n                        placeholder=\"Enter client name\"\n                      />\n                      <button\n                        type=\"button\"\n                        onClick={() => setShowClientModal(true)}\n                        className={`px-4 py-3 rounded-xl transition-all duration-200 flex items-center gap-2 whitespace-nowrap font-medium ${\n                          selectedClientId \n                            ? 'bg-green-600 text-white hover:bg-green-700 shadow-md' \n                            : 'bg-primary-600 text-white hover:bg-primary-700 shadow-md'\n                        }`}\n                      >\n                        <UserIcon className=\"w-4 h-4\" />\n                        {selectedClientId ? 'Change' : 'Select'}\n                      </button>\n                    </div>\n                    \n                    {selectedClientId && (\n                      <div className=\"p-3 bg-green-50 border border-green-200 rounded-xl\">\n                        <div className=\"flex items-center justify-between\">\n                          <div className=\"flex items-center gap-2 text-sm text-green-800\">\n                            <CheckCircleIcon className=\"w-4 h-4\" />\n                            Client selected from database\n                          </div>\n                          <button\n                            type=\"button\"\n                            onClick={handleClearClient}\n                            className=\"text-red-600 hover:text-red-800 text-sm font-medium\"\n                          >\n                            Clear\n                          </button>\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                </div>\n\n                {/* Project Description */}\n                <div className=\"space-y-2\">\n                  <label className=\"block text-sm font-semibold text-gray-700\">\n                    Project Description <span className=\"text-red-500\">*</span>\n                  </label>\n                  <textarea\n                    value={proposal?.description || ''}\n                    onChange={(e) => setProposal({ ...proposal, description: e.target.value })}\n                    rows={4}\n                    className=\"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 bg-gray-50 hover:bg-white resize-none\"\n                    placeholder=\"Describe the project, requirements, and objectives...\"\n                  />\n                </div>\n\n                {/* Budget & Timeline */}\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <label className=\"block text-sm font-semibold text-gray-700\">\n                      Budget\n                    </label>\n                    <div className=\"relative\">\n                      <CurrencyDollarIcon className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\" />\n                      <input\n                        type=\"text\"\n                        value={proposal?.budget || ''}\n                        onChange={(e) => setProposal({ ...proposal, budget: e.target.value })}\n                        className=\"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 bg-gray-50 hover:bg-white\"\n                        placeholder=\"e.g. $50,000\"\n                      />\n                    </div>\n                  </div>\n                  \n                  <div className=\"space-y-2\">\n                    <label className=\"block text-sm font-semibold text-gray-700\">\n                      Timeline\n                    </label>\n                    <div className=\"relative\">\n                      <ClockIcon className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\" />\n                      <input\n                        type=\"text\"\n                        value={proposal?.timeline || ''}\n                        onChange={(e) => setProposal({ ...proposal, timeline: e.target.value })}\n                        className=\"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 bg-gray-50 hover:bg-white\"\n                        placeholder=\"e.g. 2 months\"\n                      />\n                    </div>\n                  </div>\n                </div>\n\n                {/* AI Generation Button */}\n                <button\n                  type=\"button\"\n                  onClick={handleGenerateWithAI}\n                  disabled={generating || loading || !proposal?.clientName || !proposal?.description}\n                  className={`w-full py-4 px-6 rounded-xl font-semibold text-white transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-offset-2 shadow-lg ${\n                    generating || loading || !proposal?.clientName || !proposal?.description\n                      ? 'bg-gray-400 cursor-not-allowed'\n                      : 'bg-gradient-to-r from-primary-600 to-purple-600 hover:from-primary-700 hover:to-purple-700 focus:ring-primary-500'\n                  }`}\n                >\n                  {generating ? (\n                    <div className=\"flex items-center justify-center\">\n                      <ArrowPathIcon className=\"animate-spin -ml-1 mr-3 h-5 w-5 text-white\" />\n                      Generating Content...\n                    </div>\n                  ) : (\n                    <div className=\"flex items-center justify-center\">\n                      <SparklesIcon className=\"w-5 h-5 mr-2\" />\n                      Generate AI Content\n                    </div>\n                  )}\n                </button>\n                \n                {(!proposal?.clientName || !proposal?.description) && (\n                  <p className=\"text-sm text-gray-500 text-center\">\n                    Enter client name and description to enable AI generation\n                  </p>\n                )}\n              </form>\n            </div>\n          </div>\n\n          {/* Right Panel - Content Editor */}\n          <div className=\"lg:col-span-2\">\n            <div className=\"bg-white rounded-2xl shadow-sm border border-gray-200 p-6\">\n              <div className=\"flex items-center justify-between mb-6\">\n                <div>\n                  <h2 className=\"text-xl font-bold text-gray-900 mb-1\">Proposal Content</h2>\n                  <p className=\"text-gray-600\">Review, edit, and refine your proposal content</p>\n                </div>\n                <div className=\"flex items-center gap-3\">\n                  <button\n                    onClick={() => handleRefineEntireProposal()}\n                    disabled={generating || !proposal?.content?.fullProposal}\n                    className=\"btn-primary flex items-center gap-2\"\n                  >\n                    <SparklesIcon className=\"w-4 h-4\" />\n                    Refine with AI\n                  </button>\n                  <button \n                    onClick={() => handleFormatProposal()}\n                    disabled={!proposal?.content?.fullProposal}\n                    className=\"btn-secondary flex items-center gap-2\"\n                  >\n                    <CogIcon className=\"w-4 h-4\" />\n                    Format\n                  </button>\n                </div>\n              </div>\n\n              {/* Content Editor */}\n              <div className=\"space-y-4\">\n                <div className=\"flex items-center gap-4 text-sm text-gray-600 p-3 bg-gray-50 rounded-xl\">\n                  <div className=\"flex items-center gap-2\">\n                    <EyeIcon className=\"w-4 h-4\" />\n                    Edit the entire proposal content below\n                  </div>\n                  <div className=\"flex items-center gap-2\">\n                    <SparklesIcon className=\"w-4 h-4\" />\n                    Use \"Refine with AI\" to improve the entire document\n                  </div>\n                </div>\n\n                <textarea\n                  value={proposal?.content?.fullProposal || getCombinedProposalContent()}\n                  onChange={(e) => setProposal({ \n                    ...proposal, \n                    content: { \n                      ...proposal?.content, \n                      fullProposal: e.target.value \n                    } \n                  })}\n                  rows={25}\n                  className=\"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none transition-all duration-200 bg-gray-50 font-mono text-sm leading-relaxed hover:bg-white\"\n                  placeholder=\"Enter your complete proposal content here...\n\n# Executive Summary\n[Your executive summary goes here]\n\n# Approach\n[Your approach and methodology]\n\n# Budget Details\n[Detailed budget breakdown]\n\n# Timeline\n[Project timeline and milestones]\n\n# Additional Sections\n[Any other relevant sections]\"\n                />\n                \n                <div className=\"flex items-center justify-between text-xs text-gray-500 p-3 bg-gray-50 rounded-lg\">\n                  <span>Word count: {proposal?.content?.fullProposal?.split(/\\s+/).length || 0} words</span>\n                  <span>Characters: {proposal?.content?.fullProposal?.length || 0}</span>\n                </div>\n              </div>\n\n              {/* Success Message */}\n              {proposal?.content?.fullProposal && (\n                <div className=\"mt-6 bg-green-50 border border-green-200 rounded-xl p-4\">\n                  <div className=\"flex items-center gap-2 text-green-800\">\n                    <CheckCircleIcon className=\"w-5 h-5\" />\n                    <span className=\"font-medium\">Content Ready!</span>\n                  </div>\n                  <p className=\"text-green-700 text-sm mt-1\">\n                    Review and edit the content above. Use \"Refine with AI\" to improve the entire document or \"Format\" to structure it properly.\n                  </p>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n      \n      {/* Client Selection Modal */}\n      <ClientSelectionModal\n        isOpen={showClientModal}\n        onClose={() => setShowClientModal(false)}\n        onSelectClient={handleClientSelect}\n        selectedClientId={selectedClientId}\n      />\n    </div>\n  );\n};\n\nexport default ProposalEditor; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}